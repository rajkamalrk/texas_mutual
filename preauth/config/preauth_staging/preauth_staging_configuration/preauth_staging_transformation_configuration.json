{"order_seq_no": 1,"record_type":"preauth_staging_header","load_type":"header","table_load_type":"letters","df_table_name": "read_preauth_image_staging_header_vw","db_table_name": "txm_preauth_staging.preauth_letters_header","db_select_cols_list": "", "db_filter_id_col_name": "","transform_sql_select":"SELECT TRIM(SUBSTR(pre_auth_data_str, 1, 1)) AS record_type,TRIM(SUBSTR(pre_auth_data_str, 2, 30)) AS  claim_number,TO_DATE((TRIM(SUBSTR(pre_auth_data_str, 32, 10))),'MM/dd/yyyy') AS date_of_injury FROM read_preauth_image_staging_header_vw WHERE UPPER(TRIM(SUBSTR(pre_auth_data_str, 1, 1)))='C'","db_read_sql":"","reprocess_del_sql":"DELETE FROM txm_preauth_staging.preauth_letters_header where batch_id='<failed_batch_id>' "}
{"order_seq_no": 2,"record_type":"preauth_staging_detail","load_type":"detail","table_load_type":"letters","df_table_name": "read_preauth_image_staging_detail_vw","db_table_name": "txm_preauth_staging.preauth_letters_detail","db_select_cols_list": "", "db_filter_id_col_name": "","transform_sql_select":"SELECT TRIM(SUBSTR(pre_auth_data_str, 1, 1)) AS record_type ,TRIM(SUBSTR(pre_auth_data_str, 2, 3)) AS  image_type ,TRIM(SUBSTR(pre_auth_data_str, 5, 5)) AS document_type ,TO_TIMESTAMP(TRIM(SUBSTR(pre_auth_data_str, 10,19)), 'MM/dd/yyyy HH:mm:ss') AS datetime_received ,TO_TIMESTAMP(TRIM(SUBSTR(pre_auth_data_str, 29, 19)), 'MM/dd/yyyy HH:mm:ss') AS image_last_upload_datetime ,TRIM(SUBSTR(pre_auth_data_str, 48, 40)) AS description ,TRIM(SUBSTR(pre_auth_data_str, 88, 70)) AS image_name ,SUBSTRING_INDEX(TRIM(SUBSTR(pre_auth_data_str, 88, 70)),'_', 1)  as lookup FROM read_preauth_image_staging_header_vw WHERE UPPER(TRIM(SUBSTR(pre_auth_data_str, 1, 1)))!='C'","db_read_sql":"SELECT claim_number,header_id FROM (SELECT header_id,claim_number,update_timestamp, row_number() over(partition by claim_number order by update_timestamp desc )  as rw FROM txm_preauth_staging.preauth_letters_header)Q  WHERE Q.rw=1","reprocess_del_sql":"DELETE  t1 FROM txm_preauth_staging.preauth_letters_detail AS t1 
INNER JOIN txm_preauth_staging.preauth_letters_header AS t2 ON t2.header_id = t1.header_id WHERE t2.batch_id = '<failed_batch_id>'"}
{"order_seq_no": 1,"record_type":"preauth_notes_file_header","load_type":"notes_file_header","table_load_type":"notes","df_table_name": "read_preauth_notes_file_header_vw","db_table_name": "txm_preauth_staging.preauth_notes_file_header","db_select_cols_list": "", "db_filter_id_col_name": "","transform_sql_select":"SELECT TRIM(SUBSTR(pre_auth_data_str, 1, 1)) AS record_type ,TRIM(SUBSTR(pre_auth_data_str, 2, 1)) AS  transaction_code ,TO_TIMESTAMP(TRIM(SUBSTR(pre_auth_data_str, 3, 14)), 'yyyyMMddHHmmss') AS creation_date ,TO_TIMESTAMP(TRIM(SUBSTR(pre_auth_data_str, 19, 14)), 'yyyyMMddHHmmss') AS date_range_from ,TO_TIMESTAMP(TRIM(SUBSTR(pre_auth_data_str, 35, 14)), 'yyyyMMddHHmmss') AS date_range_thru FROM read_preauth_notes_file_header_vw WHERE UPPER(TRIM(SUBSTR(pre_auth_data_str, 1, 1)))='H'","db_read_sql":"","reprocess_del_sql":"DELETE FROM txm_preauth_staging.preauth_notes_file_header WHERE batch_id='<failed_batch_id>'"}
{"order_seq_no": 2,"record_type":"preauth_notes_header","load_type":"notes_header","table_load_type":"notes","df_table_name": "read_preauth_notes_header_vw","db_table_name": "txm_preauth_staging.preauth_notes_header","db_select_cols_list": "", "db_filter_id_col_name": "","transform_sql_select":"SELECT TRIM(SUBSTR(pre_auth_data_str, 1, 1)) AS record_type ,TRIM(SUBSTR(pre_auth_data_str, 2, 20)) AS  claim_number ,TRIM(SUBSTR(pre_auth_data_str, 22,10)) AS  reference ,TRIM(SUBSTR(pre_auth_data_str, 32,10)) AS  claim_sequence_number ,TO_DATE(TRIM(SUBSTR(pre_auth_data_str, 42, 8)), 'yyyyMMdd')  AS  date_of_injury ,TRIM(SUBSTR(pre_auth_data_str, 50, 10)) AS  claimant_first_name ,TRIM(SUBSTR(pre_auth_data_str, 60, 20)) AS  claimant_last_name ,TRIM(SUBSTR(pre_auth_data_str, 80, 22)) AS  adjuster_last_name ,TRIM(SUBSTR(pre_auth_data_str, 102, 18)) AS  adjuster_first_name ,TRIM(SUBSTR(pre_auth_data_str, 120, 10)) AS  unique_id ,TRIM(SUBSTR(pre_auth_data_str, 130, 50)) AS  activity_name ,TO_DATE(TRIM(SUBSTR(pre_auth_data_str, 180, 8)), 'yyyyMMdd') AS activity_date ,TRIM(SUBSTR(pre_auth_data_str, 188, 15)) AS  claim_id FROM read_preauth_notes_header_vw WHERE UPPER(TRIM(SUBSTR(pre_auth_data_str, 1, 1)))='I'","db_read_sql":"SELECT  MAX(notes_file_header_id) AS notes_file_header_id FROM txm_preauth_staging.preauth_notes_file_header","reprocess_del_sql":"DELETE  t1 FROM txm_preauth_staging.preauth_notes_header AS t1 INNER JOIN txm_preauth_staging.preauth_notes_file_header AS t2 ON t2.notes_file_header_id = t1.notes_file_header_id WHERE t2.batch_id = '<failed_batch_id>'"}
{"order_seq_no": 3,"record_type":"preauth_notes_detail","load_type":"notes_detail","table_load_type":"notes","df_table_name": "read_preauth_notes_detail_vw","db_table_name": "txm_preauth_staging.preauth_notes_detail","db_select_cols_list": "", "db_filter_id_col_name": "","transform_sql_select":"SELECT TRIM(REPLACE(SUBSTRING_INDEX(pre_auth_data_str,'|',1),'C','')) AS claim_number ,TRIM(SUBSTRING_INDEX(SUBSTRING_INDEX(pre_auth_data_str,'|',2),'|',-1)) AS unique_id ,TRIM(SUBSTRING_INDEX(SUBSTRING_INDEX(pre_auth_data_str,'|',3),'|',-1)) AS activity_name ,TRIM(SUBSTR(pre_auth_data_str, 1, 1)) AS record_type ,SUBSTR(TRIM(SUBSTRING_INDEX(SUBSTRING_INDEX(pre_auth_data_str,'|',4),'|',-1)),2,LENGTH(pre_auth_data_str) - 1) AS notes FROM read_preauth_notes_detail_vw WHERE UPPER(TRIM(SUBSTR(pre_auth_data_str, 1, 1)))='C' order by row_num","db_read_sql":"SELECT notes_header_id,claim_number,activity_name,unique_id FROM txm_preauth_staging.preauth_notes_header  WHERE notes_file_header_id='<notes_file_header_id>'","reprocess_del_sql":"DELETE  t1 FROM txm_preauth_staging.preauth_notes_detail AS t1 INNER JOIN txm_preauth_staging.preauth_notes_header AS t3 ON t3.notes_header_id = t1.notes_header_id INNER JOIN txm_preauth_staging.preauth_notes_file_header AS t2 ON t2.notes_file_header_id = t3.notes_file_header_id WHERE t2.batch_id = '<failed_batch_id>'"}
{"order_seq_no": 4,"record_type":"preauth_notes_file_trailer","load_type":"notes_trailer","table_load_type":"notes","df_table_name": "read_preauth_notes_trailer_vw","db_table_name": "txm_preauth_staging.preauth_notes_file_trailer","db_select_cols_list": "", "db_filter_id_col_name": "","transform_sql_select":"SELECT TRIM(SUBSTR(pre_auth_data_str, 2, 6)) AS record_count,TRIM(SUBSTR(pre_auth_data_str, 1, 1)) AS record_type FROM read_preauth_notes_trailer_vw WHERE UPPER(TRIM(SUBSTR(pre_auth_data_str, 1, 1)))='T'","db_read_sql":"","reprocess_del_sql":"DELETE  t1 FROM txm_preauth_staging.preauth_notes_file_trailer AS t1 LEFT JOIN txm_preauth_staging.preauth_notes_file_header AS t2 ON t2.notes_file_header_id = t1.notes_file_header_id WHERE t2.batch_id = '<failed_batch_id>'"}