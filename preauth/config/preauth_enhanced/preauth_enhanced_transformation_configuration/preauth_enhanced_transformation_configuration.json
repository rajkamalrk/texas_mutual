{"order_seq_no":1,"table_type":"LETTERS_DATA","df_read_table_name":"read_letters_data_vw","df_table_name":"letters_data_vw","db_table_name":"txm_preauth.preauth_letters_data","load_config_table_list":"preauth_static_config.doc_type_valid_list","db_read_sql_select":"SELECT  h.header_id, h.batch_id, h.claim_number, d.detail_id, d.image_type, d.datetime_received, d.image_name, d.document_type FROM txm_preauth_staging.preauth_letters_header h JOIN txm_preauth_staging.preauth_letters_detail d ON h.header_id = d.header_id WHERE h.batch_id = <INPUT_BATCH_ID>","transform_sql_select":"SELECT v.header_id, v.batch_id, v.claim_number, v.detail_id, '' AS claim_id, v.image_type, DATE(v.datetime_received) AS receive_date, REGEXP_REPLACE(v.image_name, '[^A-Z0-9_.-](?![^.]*$)', '_') AS document_name, REPLACE(v.s3_doc_path,v.image_name,REGEXP_REPLACE(v.image_name,'[^A-Z0-9_.-](?![^.]*$)','_')) AS document_path, CURRENT_TIMESTAMP AS file_receive_date, '0' AS number_of_pages, '0000008' AS partner_id, CONCAT('.',v.image_type) AS document_extension, dt.description AS document_type_description, COALESCE(dt.translate_to, 'AVOTR') AS txm_document_type from read_letters_data_vw v LEFT JOIN doc_type_valid_list_vw dt ON dt.code = v.document_type"}
{"order_seq_no":1,"table_type":"NOTES_DATA","df_read_table_name":"read_notes_data_vw","df_table_name":"notes_data_vw","db_table_name":"txm_preauth.preauth_notes_data","load_config_table_list":"preauth_static_config.notes_source_type","db_read_sql_select":"SELECT h.notes_file_header_id,lh.claim_number,date_of_injury,activity_name FROM txm_preauth_staging.preauth_notes_file_header h INNER JOIN txm_preauth_staging.preauth_notes_header lh ON lh.notes_file_header_id=h.notes_file_header_id WHERE h.batch_id ='<INPUT_BATCH_ID>'","transform_sql_select":"SELECT  claim_number ,IF(TRIM(activity_name)='','DEFAULT',IFNULL(activity_name,'DEFAULT')) AS source_type , STR_TO_DATE(CONCAT(DATE_FORMAT(nh.activity_date, '%Y-%m-%d'),' ',TIME_FORMAT(current_time(), '%H:%i:%s')), '%Y-%m-%d %H:%i:%s') AS note_timestamp ,GROUP_CONCAT( DISTINCT notes ORDER BY claim_number,notes_detail_id DESC SEPARATOR '') AS note_body ,'GENEX' AS note_activity_source,'N' AS process_by_cc_status,nh.claim_id,nh.exposure_public_id FROM txm_preauth_staging.preauth_notes_detail nd INNER JOIN txm_preauth_staging.preauth_notes_header nh ON nh.notes_header_id=nd.notes_header_id WHERE notes_file_header_id='<notes_file_header_id>' GROUP BY claim_number,activity_name"}