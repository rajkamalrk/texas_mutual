{"order_seq_no": 1,"record_type_code": "01","record_type":"FILE_HEADER","df_table_name": "optum_file_header_vw","db_table_name": "txm_bitx_staging.optum_file_header","db_select_cols_list": "MAX(file_header_id) AS file_header_id","db_filter_id_col_name": "file_name","transform_sql_select": "SELECT reverse(split(input_file_name(), '/'))[0] AS file_name, current_timestamp() AS file_creation_date FROM optum_file_header_vw LIMIT 1"}
{"order_seq_no": 2,"record_type_code": "01","record_type":"INVOICE_DETAILS","df_table_name": "optum_invoice_vw","db_table_name": "txm_bitx_staging.optum_invoice","db_select_cols_list": "","db_filter_id_col_name":"","transform_sql_select": "SELECT f.file_header_id,current_timestamp() AS batch_datetime,'R' As transmission_type ,TRIM(SUBSTR(bill_data_str, 1, 10)) AS pbm_rx_no, TRIM(SUBSTR(bill_data_str, 11, 15)) AS invoice_number ,TRIM(SUBSTR(bill_data_str, 26, 5)) AS sequence,TRIM(SUBSTR(bill_data_str, 31, 30)) AS claim_number,TRIM(SUBSTR(bill_data_str, 61, 20)) AS employer_code,TRIM(SUBSTR(bill_data_str, 81, 25)) AS member_last_name,TRIM(SUBSTR(bill_data_str, 106, 25)) AS member_first_name,TRIM(SUBSTR(bill_data_str, 131, 1)) AS member_middle_init,TO_DATE(NULLIF(NULLIF(TRIM(SUBSTR(bill_data_str, 132, 10)),'00000000'), ''), 'yyyyMMdd') AS date_of_injury,TRIM(SUBSTR(bill_data_str, 142, 9)) AS ssn,TRIM(SUBSTR(bill_data_str, 151, 10)) AS dea,TRIM(SUBSTR(bill_data_str, 161, 25)) AS physician_last_name,TRIM(SUBSTR(bill_data_str, 186, 25)) AS physician_first_name,TRIM(SUBSTR(bill_data_str, 211, 1)) AS physician_middle_init,TRIM(SUBSTR(bill_data_str, 212, 11)) AS ndc,TRIM(SUBSTR(bill_data_str, 223, 7)) AS rx_number,CAST(NULLIF(TRIM(SUBSTR(bill_data_str, 230, 10)),'') AS INTEGER) AS rx_quantity,TRIM(SUBSTR(bill_data_str, 240, 50)) AS drug_name,TO_DATE(NULLIF(NULLIF(TRIM(SUBSTR(bill_data_str, 290, 10)), '00000000'), ''), 'yyyyMMdd') AS date_filled,TRIM(SUBSTR(bill_data_str, 300, 1)) AS generic,CAST(IFNULL(NULLIF(LEFT(TRIM(SUBSTR(bill_data_str, 301, 10)),8) ||'.'|| RIGHT(TRIM(SUBSTR(bill_data_str, 301, 10)),2), '.'), '0') AS DECIMAL(10,2)) AS recommended_amount,CAST(IFNULL(NULLIF(LEFT(TRIM(SUBSTR(bill_data_str, 311, 10)),8) ||'.'|| RIGHT(TRIM(SUBSTR(bill_data_str, 311, 10)),2), '.'), '0') AS DECIMAL(10,2)) AS fee_schedule,CAST(IFNULL(NULLIF(LEFT(TRIM(SUBSTR(bill_data_str, 321, 10)),8) ||'.'|| RIGHT(TRIM(SUBSTR(bill_data_str, 321, 10)),2), '.'), '0') AS DECIMAL(10,2)) AS contract_amount,CAST(IFNULL(NULLIF(LEFT(TRIM(SUBSTR(bill_data_str, 331, 10)),8) ||'.'|| RIGHT(TRIM(SUBSTR(bill_data_str, 331, 10)),2), '.'), '0') AS DECIMAL(10,2)) AS cost_amount,CAST(IFNULL(NULLIF(LEFT(TRIM(SUBSTR(bill_data_str, 341, 10)),8) ||'.'|| RIGHT(TRIM(SUBSTR(bill_data_str, 341, 10)),2), '.'), '0') AS DECIMAL(10,2)) AS charged_amount,CAST(IFNULL(NULLIF(LEFT(TRIM(SUBSTR(bill_data_str, 351, 10)),8) ||'.'|| RIGHT(TRIM(SUBSTR(bill_data_str, 351, 10)),2), '.'), '0') AS DECIMAL(10,2)) AS tax_amount,TRIM(SUBSTR(bill_data_str, 361, 10)) AS nabp,TRIM(SUBSTR(bill_data_str, 371, 1)) AS error_code,TO_DATE(NULLIF(NULLIF(TRIM(SUBSTR(bill_data_str, 372, 10)), '00000000'), ''), 'yyyyMMdd') AS bill_calculation_date,TRIM(SUBSTR(bill_data_str, 382, 1)) AS network,TRIM(SUBSTR(bill_data_str, 383, 1)) AS bill_type,TRIM(SUBSTR(bill_data_str, 384, 9)) AS irs_number,TRIM(SUBSTR(bill_data_str, 393, 35)) AS sn_address1,TRIM(SUBSTR(bill_data_str, 428, 35)) AS sn_address2,TRIM(SUBSTR(bill_data_str, 463, 20)) AS sn_city,TRIM(SUBSTR(bill_data_str, 483, 2)) AS sn_state,TRIM(SUBSTR(bill_data_str, 485, 10)) AS sn_zip_code,TRIM(SUBSTR(bill_data_str, 495, 3)) AS refill,TRIM(SUBSTR(bill_data_str, 498, 3)) AS days_supply,TRIM(SUBSTR(bill_data_str, 501, 35)) AS physician_address,TRIM(SUBSTR(bill_data_str, 536, 20)) AS physician_city,TRIM(SUBSTR(bill_data_str, 556, 2)) AS physician_state,TRIM(SUBSTR(bill_data_str, 558, 10)) AS physician_zip_code,TRIM(SUBSTR(bill_data_str, 568, 35)) AS sn_name,TRIM(SUBSTR(bill_data_str, 603, 35)) AS pharmacy_name,TRIM(SUBSTR(bill_data_str, 638, 35)) AS pharmacy_address1,TRIM(SUBSTR(bill_data_str, 673, 35)) AS pharmacy_address2,TRIM(SUBSTR(bill_data_str, 708, 20)) AS pharmacy_city,TRIM(SUBSTR(bill_data_str, 728, 2)) AS pharmacy_state,TRIM(SUBSTR(bill_data_str, 730, 10)) AS pharmacy_zip,TO_DATE(NULLIF(NULLIF(TRIM(SUBSTR(bill_data_str, 740, 10)), '00000000'), ''), 'yyyyMMdd') AS date_received,TO_DATE(NULLIF(NULLIF(TRIM(SUBSTR(bill_data_str, 750, 8)), '00000000'), ''), 'yyyyMMdd') AS employee_dob,TRIM(SUBSTR(bill_data_str, 758, 1)) AS employee_gender,CAST(TRIM(SUBSTR(bill_data_str, 759, 10)) AS BIGINT) AS pharmacy_phone_number,TRIM(SUBSTR(bill_data_str, 769, 35)) AS employer_name,TRIM(SUBSTR(bill_data_str, 804, 35)) AS employer_address1,TRIM(SUBSTR(bill_data_str, 839, 20)) AS employer_city,TRIM(SUBSTR(bill_data_str, 859, 2)) AS employer_state,TRIM(SUBSTR(bill_data_str, 861, 10)) AS employer_zip_code,TRIM(SUBSTR(bill_data_str, 871, 10)) AS employer_phone_number,TO_DATE(NULLIF(NULLIF(TRIM(SUBSTR(bill_data_str, 881, 8)), '00000000'), ''), 'yyyyMMdd') AS date_written,TRIM(SUBSTR(bill_data_str, 889, 1)) AS daw_cde,TRIM(SUBSTR(bill_data_str, 890, 20)) AS pre_auth,TRIM(SUBSTR(bill_data_str, 910, 10)) AS dispensing_pharmacy_npi,TRIM(SUBSTR(bill_data_str, 920, 10)) AS prescriber_npi,TRIM(SUBSTR(bill_data_str, 930, 11)) AS generic_available_ndc,CAST(TRIM(SUBSTR(bill_data_str, 941, 10)) AS INT) AS patient_pay_amount FROM optum_invoice_vw JOIN db_optum_file_header_vw f"}