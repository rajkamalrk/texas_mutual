{"order_seq_no": 1,"record_type_code": "E","record_type":"FILE_HEADER","df_table_name": "techhealth_file_header_vw","db_table_name": "txm_bitx_staging.techhealth_file_header","db_select_cols_list": "MAX(file_header_id) AS file_header_id","db_filter_id_col_name": "file_creation_date","transform_sql_select":  "SELECT TRIM(SUBSTR(bill_data_str, 1, 1)) AS record_type_code ,TRIM(SUBSTR(bill_data_str, 2, 1)) AS system_indicator ,reverse(split(input_file_name(), '/'))[0] AS file_name,TO_DATE(NULLIF(NULLIF(TRIM(SUBSTR(bill_data_str, 3, 8)), '00000000'), ''), 'yyyyMMdd') AS file_creation_date FROM techhealth_file_header_vw"}
{"order_seq_no": 2,"record_type_code": "H","record_type":"INVOICE_HEADER","df_table_name": "techhealth_invoice_header_vw","db_table_name": "txm_bitx_staging.techhealth_invoice_header","db_select_cols_list": "invoice_header_id, invoice_id AS unique_invoice_id","db_filter_id_col_name": "file_header_id","transform_sql_select": "SELECT f.file_header_id, TRIM(SUBSTR(bill_data_str, 1, 1)) AS record_type_code ,TRIM(SUBSTR(bill_data_str, 2, 10)) AS invoice_number ,TRIM(SUBSTR(bill_data_str, 12, 10)) AS invoice_id ,TRIM(SUBSTR(bill_data_str, 22, 10)) AS referral_id ,TO_DATE(NULLIF(NULLIF(TRIM(SUBSTR(bill_data_str, 32, 8)), '00000000'), ''), 'yyyyMMdd') AS invoice_date ,TRIM(SUBSTR(bill_data_str, 40, 30)) AS claim_number ,TRIM(SUBSTR(bill_data_str, 70, 10)) AS customer_id ,TRIM(SUBSTR(bill_data_str, 80, 30)) AS authorization_code ,TRIM(SUBSTR(bill_data_str, 110, 20)) AS client_claim_id ,TRIM(SUBSTR(bill_data_str, 130, 50)) AS patient_name ,TRIM(SUBSTR(bill_data_str, 180, 9)) AS ssn ,TRIM(SUBSTR(bill_data_str, 189, 50)) AS patient_address1 ,TRIM(SUBSTR(bill_data_str, 239, 40)) AS patient_city ,TRIM(SUBSTR(bill_data_str, 279, 2)) AS patient_state ,TRIM(SUBSTR(bill_data_str, 281, 5)) AS patient_zip ,TRIM(SUBSTR(bill_data_str, 286, 10)) AS patient_phone ,TO_DATE(NULLIF(NULLIF(TRIM(SUBSTR(bill_data_str, 296, 8)),'00000000'), ''), 'yyyyMMdd') AS patient_date_of_birth ,TRIM(SUBSTR(bill_data_str, 304, 1)) AS patient_gender ,TRIM(SUBSTR(bill_data_str, 305, 2)) AS jurisdiction ,TO_DATE(NULLIF(NULLIF(TRIM(SUBSTR(bill_data_str, 307, 8)), '00000000'), ''), 'yyyyMMdd') AS date_of_injury ,TRIM(SUBSTR(bill_data_str, 315, 10)) AS diagnosis1 ,TRIM(SUBSTR(bill_data_str, 325, 50)) AS diagnosis_description1 ,TRIM(SUBSTR(bill_data_str, 375, 10)) AS diagnosis2 ,TRIM(SUBSTR(bill_data_str, 385, 50)) AS diagnosis_description2 ,TRIM(SUBSTR(bill_data_str, 435, 10)) AS diagnosis3 ,TRIM(SUBSTR(bill_data_str, 445, 50)) AS diagnosis_description3 ,TRIM(SUBSTR(bill_data_str, 495, 10)) AS diagnosis4 ,TRIM(SUBSTR(bill_data_str, 505, 50)) AS diagnosis_description4 ,TRIM(SUBSTR(bill_data_str, 555, 20)) AS pay_to_name ,TRIM(SUBSTR(bill_data_str, 575, 50)) AS pay_to_address1 ,TRIM(SUBSTR(bill_data_str, 625, 50)) AS pay_to_address2 ,TRIM(SUBSTR(bill_data_str, 675, 40)) AS pay_to_city ,TRIM(SUBSTR(bill_data_str, 715, 2)) AS pay_to_state ,TRIM(SUBSTR(bill_data_str, 717, 5)) AS pay_to_zip ,TRIM(SUBSTR(bill_data_str, 722, 9)) AS pay_to_fein ,TRIM(SUBSTR(bill_data_str, 731, 20)) AS pay_to_state_license ,TRIM(SUBSTR(bill_data_str, 751, 10)) AS pay_to_npi ,TRIM(SUBSTR(bill_data_str, 761, 40)) AS facility_name ,TRIM(SUBSTR(bill_data_str, 801, 50)) AS facility_address1 ,TRIM(SUBSTR(bill_data_str, 851, 50)) AS facility_city ,TRIM(SUBSTR(bill_data_str, 901, 2)) AS facility_state ,TRIM(SUBSTR(bill_data_str, 903, 9)) AS facility_zip_code ,TRIM(SUBSTR(bill_data_str, 912, 20)) AS facility_state_license ,TRIM(SUBSTR(bill_data_str, 932, 10)) AS facility_npi ,TRIM(SUBSTR(bill_data_str, 942, 30)) AS referring_provider_name ,TRIM(SUBSTR(bill_data_str, 972, 20)) AS referring_provider_state_license ,TRIM(SUBSTR(bill_data_str, 992, 10)) AS referring_provider_npi ,TRIM(SUBSTR(bill_data_str, 1002, 20)) AS provider_fein ,TRIM(SUBSTR(bill_data_str, 1022, 2)) AS provider_state ,TRIM(SUBSTR(bill_data_str, 1024, 20)) AS provider_unique_id ,TRIM(SUBSTR(bill_data_str, 1044, 40)) AS employer_name ,TRIM(SUBSTR(bill_data_str, 1084, 20)) AS service_description ,TRIM(SUBSTR(bill_data_str, 1104, 50)) AS adjuster_name ,CAST(NULLIF(TRIM(SUBSTR(bill_data_str, 1154,8)) ||'.'||TRIM(SUBSTR(bill_data_str,1162,2)), '.') AS DECIMAL(10,2)) AS invoice_total ,TRIM(SUBSTR(bill_data_str, 1164, 10)) AS client_total ,TRIM(SUBSTR(bill_data_str, 1174, 10)) AS diagnosis5 ,TRIM(SUBSTR(bill_data_str, 1184, 50)) AS diagnosis_description5 ,TRIM(SUBSTR(bill_data_str, 1234, 10)) AS diagnosis6 ,TRIM(SUBSTR(bill_data_str, 1244, 50)) AS diagnosis_description6 ,TRIM(SUBSTR(bill_data_str, 1294, 10)) AS diagnosis7 ,TRIM(SUBSTR(bill_data_str, 1304, 50)) AS diagnosis_description7 ,TRIM(SUBSTR(bill_data_str, 1354, 10)) AS diagnosis8 ,TRIM(SUBSTR(bill_data_str, 1364, 50)) AS diagnosis_description8 ,TRIM(SUBSTR(bill_data_str, 1414, 10)) AS diagnosis9 ,TRIM(SUBSTR(bill_data_str, 1424, 50)) AS diagnosis_description9 ,TRIM(SUBSTR(bill_data_str, 1474, 10)) AS diagnosis10 ,TRIM(SUBSTR(bill_data_str, 1484, 50)) AS diagnosis_description10 ,TRIM(SUBSTR(bill_data_str, 1534, 10)) AS diagnosis11 ,TRIM(SUBSTR(bill_data_str, 1544, 50)) AS diagnosis_description11 ,TRIM(SUBSTR(bill_data_str, 1594, 10)) AS diagnosis12 ,TRIM(SUBSTR(bill_data_str, 1604, 50)) AS diagnosis_description12 ,TRIM(SUBSTR(bill_data_str, 1654, 50)) AS pre_authorization_number ,TO_DATE(NULLIF(NULLIF(TRIM(SUBSTR(bill_data_str, 1704, 8)), '00000000'), ''), 'yyyyMMdd') AS date_of_service FROM techhealth_invoice_header_vw JOIN db_techhealth_file_header_vw f"}
{"order_seq_no": 3,"record_type_code": "D","record_type":"INVOICE_DETAIL","df_table_name": "techhealth_invoice_detail_vw","db_table_name": "txm_bitx_staging.techhealth_invoice_detail","db_select_cols_list": "","db_filter_id_col_name": "","transform_sql_select": "SELECT i.invoice_header_id, TRIM(SUBSTR(bill_data_str, 1, 1)) AS record_type_code ,TRIM(SUBSTR(bill_data_str, 2, 10)) AS line_number ,TRIM(SUBSTR(bill_data_str, 12, 10)) AS tp_invoice_detail_id ,TRIM(SUBSTR(bill_data_str, 22, 10)) AS referral_detail_id ,TRIM(SUBSTR(bill_data_str, 32, 10)) AS skuid ,TRIM(SUBSTR(bill_data_str, 42, 10)) AS parent_referral_detail_id ,TO_DATE(NULLIF(NULLIF(TRIM(SUBSTR(bill_data_str, 52, 8)), '00000000'), ''), 'yyyyMMdd') AS start_date ,TO_DATE(NULLIF(NULLIF(TRIM(SUBSTR(bill_data_str, 60, 8)), '00000000'), ''), 'yyyyMMdd') AS end_date ,TRIM(SUBSTR(bill_data_str, 68, 10)) AS quantity ,CAST(NULLIF(TRIM(SUBSTR(bill_data_str, 78, 10)), '') AS INT) AS extended_quantity ,TRIM(SUBSTR(bill_data_str, 88, 10)) AS hcpcs ,TRIM(SUBSTR(bill_data_str, 98, 10)) AS modifier ,TRIM(SUBSTR(bill_data_str, 108, 2)) AS line_item_place_of_service ,TRIM(SUBSTR(bill_data_str, 110, 1)) AS line_item_emg ,TRIM(SUBSTR(bill_data_str, 111, 4)) AS line_item_diagnosis_pointer ,TRIM(SUBSTR(bill_data_str, 115, 100)) AS item_description ,CAST(NULLIF(TRIM(SUBSTR(bill_data_str, 215,8)) ||'.'||TRIM(SUBSTR(bill_data_str, 223,2)), '.') AS DECIMAL(10,2)) AS line_item_charge_amount ,CAST(NULLIF(TRIM(SUBSTR(bill_data_str, 225,8)) ||'.'||TRIM(SUBSTR(bill_data_str, 233,2)), '.') AS DECIMAL(10,2)) AS line_item_fee_amount ,CAST(NULLIF(TRIM(SUBSTR(bill_data_str, 235,8)) ||'.'||TRIM(SUBSTR(bill_data_str, 243,2)), '.') AS DECIMAL(10,2)) AS line_item_payment_amount ,CAST(NULLIF(TRIM(SUBSTR(bill_data_str, 245,8)) ||'.'||TRIM(SUBSTR(bill_data_str, 253,2)), '.') AS DECIMAL(10,2)) AS line_item_fee_schedule ,CAST(NULLIF(TRIM(SUBSTR(bill_data_str, 255,8)) ||'.'||TRIM(SUBSTR(bill_data_str, 263,2)), '.') AS DECIMAL(10,2)) AS line_item_ucr_amount ,TRIM(SUBSTR(bill_data_str, 265, 10)) AS client_amount ,TRIM(SUBSTR(bill_data_str, 275, 50)) AS rendering_physician_name ,TRIM(SUBSTR(bill_data_str, 325, 20)) AS rendering_physician_license_number ,TRIM(SUBSTR(bill_data_str, 345, 10)) AS rendering_physician_npi FROM techhealth_invoice_detail_vw d JOIN db_techhealth_invoice_header_vw i ON d.unique_invoice_id = i.unique_invoice_id"}
{"order_seq_no": 4,"record_type_code": "F","record_type":"ATTACHMENT","df_table_name": "techhealth_attachment_vw","db_table_name": "txm_bitx_staging.techhealth_attachment","db_select_cols_list": "invoice_header_id","db_filter_id_col_name": "invoice_header_id","transform_sql_select": "SELECT i.invoice_header_id, TRIM(SUBSTR(bill_data_str, 1, 1)) AS record_type_code ,TRIM(SUBSTR(bill_data_str, 2, 70)) AS document_id ,TRIM(SUBSTR(bill_data_str, 72, 10)) AS document_type FROM techhealth_attachment_vw d JOIN db_techhealth_invoice_header_vw i ON d.unique_invoice_id = i.unique_invoice_id"}
{"order_seq_no": 5,"record_type_code": "T","record_type":"FILE_TRAILER","df_table_name": "techhealth_file_trailer_vw","db_table_name": "txm_bitx_staging.techhealth_file_trailer","db_select_cols_list": "","db_filter_id_col_name": "","transform_sql_select": "SELECT f.file_header_id, TRIM(SUBSTR(bill_data_str, 1, 1)) AS record_type_code ,TRIM(SUBSTR(bill_data_str, 2, 9)) AS header_records ,TRIM(SUBSTR(bill_data_str, 11, 9)) AS detail_records, TRIM(SUBSTR(bill_data_str, 20, 9)) AS document_records FROM techhealth_file_trailer_vw JOIN db_techhealth_file_header_vw f"}