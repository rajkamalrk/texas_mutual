{"order_seq_no":1,"form_type":"CMS1500","table_type":"BILL_HEADER","df_read_table_name":"read_bill_header_vw","df_table_name":"bill_header_vw","db_table_name":"txm_bitx.bill_header","db_select_cols_list":"bill_id,bill_header_id","load_config_table_list":"","db_filter_id_col_name":"file_header_id","db_read_sql_select":"SELECT 'techhealth' AS trading_partner, 'PROF' AS form_type, b.invoice_header_id AS bill_header_id, f.file_header_id, b.invoice_id AS invoice_id, b.invoice_number AS unique_bill_id, b.invoice_date AS invoice_date, b.customer_id AS customer_id, b.claim_number AS reported_claim_number, b.client_claim_id AS client_claim_id, f.file_creation_date AS date_bill_received_by_payer, b.jurisdiction AS jurisdiction, b.referral_id AS referral_id, b.authorization_code AS authorization_code, b.pre_authorization_number AS pre_authorization_number FROM txm_bitx_staging.techhealth_file_header f JOIN txm_bitx_staging.techhealth_invoice_header b ON f.file_header_id = b.file_header_id WHERE f.file_header_id = <INPUT_FILE_HEADER_ID>","transform_sql_select":"SELECT * from read_bill_header_vw"}
{"order_seq_no":2,"form_type":"CMS1500","table_type":"BILL_DETAIL","df_read_table_name":"read_patient_vw","df_table_name":"patient_vw","db_table_name":"txm_bitx.patient","db_select_cols_list":"bill_id","load_config_table_list":"","db_filter_id_col_name":"bill_id","db_read_sql_select":"SELECT b.invoice_header_id AS bill_header_id, CASE WHEN c.social_security_number IS NOT NULL THEN CAST(c.social_security_number AS CHAR(11)) ELSE b.ssn END AS social_security_number,CASE WHEN c.patient_last_name IS NOT NULL AND c.patient_last_name <> '' THEN CONCAT(TRIM(c.patient_last_name),CASE WHEN c.patient_first_name IS NOT NULL AND c.patient_first_name <> '' THEN CONCAT(', ', TRIM(c.patient_first_name)) ELSE '' END) WHEN c.patient_first_name IS NOT NULL AND c.patient_first_name <> '' THEN CONCAT(TRIM(c.patient_first_name))ELSE b.patient_name END AS patient_name, CASE WHEN c.date_of_birth IS NOT NULL THEN c.date_of_birth ELSE b.patient_date_of_birth END AS date_of_birth,CASE WHEN c.patient_gender IS NOT NULL AND c.patient_gender <> '' THEN c.patient_gender ELSE b.patient_gender END AS patient_gender,CASE WHEN c.patient_address_line_1 IS NOT NULL AND c.patient_address_line_1 <> '' THEN c.patient_address_line_1 ELSE b.patient_address1 END AS patient_address_line_1,c.patient_address_line_2 AS patient_address_line_2,CASE WHEN c.patient_city IS NOT NULL AND c.patient_city <> '' THEN c.patient_city ELSE REPLACE(b.patient_city, ',', ' ') END AS patient_city,CASE WHEN c.patient_state_code IS NOT NULL AND c.patient_state_code <> '' THEN c.patient_state_code ELSE b.patient_state END AS patient_state_code,CASE WHEN c.patient_zip_code IS NOT NULL AND c.patient_zip_code <> '' THEN REPLACE(c.patient_zip_code, '-', '') ELSE b.patient_zip END AS zip_code,CASE WHEN c.patient_phone_number IS NOT NULL AND c.patient_phone_number <> '' THEN c.patient_phone_number ELSE CASE WHEN b.patient_phone REGEXP '^[0-9]+$' THEN CAST(b.patient_phone AS UNSIGNED) ELSE NULL END END AS patient_phone_number, b.date_of_injury AS date_of_injury FROM txm_bitx_staging.techhealth_invoice_header b LEFT JOIN txm_bitx_staging.claim_data c ON c.trading_partner='techhealth' AND  b.file_header_id=c.file_header_id AND b.invoice_header_id=c.bill_header_id WHERE b.file_header_id = <INPUT_FILE_HEADER_ID>","transform_sql_select":"select h.bill_id AS bill_id, social_security_number,patient_name,date_of_birth,patient_gender,patient_address_line_1,patient_address_line_2,patient_city,patient_state_code,zip_code,patient_phone_number,date_of_injury FROM read_patient_vw v JOIN db_bill_header_vw h ON h.bill_header_id=v.bill_header_id"}
{"order_seq_no":3,"form_type":"CMS1500","table_type":"BILL_DETAIL","df_read_table_name":"read_subscriber_vw","df_table_name":"subscriber_vw","db_table_name":"txm_bitx.subscriber","db_select_cols_list":"bill_id","load_config_table_list":"","db_filter_id_col_name":"bill_id","db_read_sql_select":"SELECT b.invoice_header_id AS bill_header_id,CASE WHEN c.subscriber_name IS NOT NULL AND c.subscriber_name <> '' THEN c.subscriber_name ELSE b.employer_name END AS subscriber_name, b.patient_date_of_birth AS date_of_birth,c.subscriber_address_line_1 AS subscriber_address_line_1,c.subscriber_address_line_2 AS subscriber_address_line_2,c.subscriber_city AS subscriber_city,c.subscriber_state AS subscriber_state,REPLACE(c.subscriber_zip_code, '-', '') AS zip_code,c.subscriber_tax_id AS subscriber_tax_id,c.subscriber_telephone_number AS subscriber_telephone_number,CASE WHEN LEFT(c.insured_policy_number, 1) = 'Q' THEN 0 WHEN c.insured_policy_number REGEXP '^[0-9]+$' THEN LEFT(c.insured_policy_number, 10) ELSE 0 END AS insured_policy_number FROM txm_bitx_staging.techhealth_invoice_header b LEFT JOIN txm_bitx_staging.claim_data c ON c.trading_partner='techhealth' AND  b.file_header_id=c.file_header_id AND b.invoice_header_id=c.bill_header_id WHERE b.file_header_id = <INPUT_FILE_HEADER_ID>","transform_sql_select":"SELECT h.bill_id AS bill_id, subscriber_name, date_of_birth,subscriber_address_line_1,subscriber_address_line_2,subscriber_city,subscriber_state,zip_code,subscriber_tax_id,subscriber_telephone_number,insured_policy_number FROM read_subscriber_vw v JOIN db_bill_header_vw h ON h.bill_header_id = v.bill_header_id"}
{"order_seq_no":4,"form_type":"CMS1500","table_type":"BILL_DETAIL","df_read_table_name":"read_provider_vw","df_table_name":"provider_vw","db_table_name":"txm_bitx.provider","db_select_cols_list":"bill_id","load_config_table_list":"bitx_static_config.common_static_configuration","db_filter_id_col_name":"bill_id","db_read_sql_select":"SELECT DISTINCT b.invoice_header_id AS bill_header_id,b.referring_provider_name AS referring_provider_name,d.rendering_physician_license_number AS rendering_provider_license,b.referring_provider_npi AS referring_provider_npi,b.facility_name AS facility_name,b.facility_address1 AS facility_address_1,b.facility_city AS facility_city,b.facility_state AS facility_state,b.facility_zip_code AS facility_zip_code,b.facility_npi AS facility_npi,b.facility_state_license AS facility_other_id,b.pay_to_name AS vendor_name,b.pay_to_address1 AS vendor_address_1,b.pay_to_address2 AS vendor_address_2,b.pay_to_city AS vendor_city,b.pay_to_state AS vendor_state,b.pay_to_zip AS vendor_zip_code,b.pay_to_npi AS vendor_npi,b.pay_to_state_license AS vendor_other_id,d.rendering_physician_name AS rendering_provider_name, b.referring_provider_state_license AS referring_provider_state_license,d.rendering_physician_npi AS rendering_provider_npi FROM txm_bitx_staging.techhealth_invoice_header b JOIN txm_bitx_staging.techhealth_invoice_detail d ON b.invoice_header_id = d.invoice_header_id WHERE b.file_header_id = <INPUT_FILE_HEADER_ID>","transform_sql_select":"SELECT h.bill_id AS bill_id,referring_provider_name,rendering_provider_license,referring_provider_npi,facility_name,facility_address_1,facility_city,facility_state,facility_zip_code,facility_npi,facility_other_id,vendor_name,vendor_address_1,vendor_address_2,vendor_city,vendor_state,vendor_zip_code,vendor_npi,vendor_other_id,rendering_provider_name,t.attribute_value AS vendor_tax_id,referring_provider_state_license,rendering_provider_npi FROM read_provider_vw v JOIN db_bill_header_vw h ON h.bill_header_id=v.bill_header_id LEFT JOIN common_static_configuration_vw t ON t.attribute_name = 'techhealth_default_tax_id'"}
{"order_seq_no":5,"form_type":"CMS1500","table_type":"BILL_DETAIL","df_read_table_name":"read_professional_treatment_vw","df_table_name":"professional_treatment_vw","db_table_name":"txm_bitx.professional_treatment","db_select_cols_list":"treatment_id,bill_id","load_config_table_list":"","db_filter_id_col_name":"file_header_id","db_read_sql_select":"SELECT b.invoice_header_id AS bill_header_id, CASE WHEN b.date_of_service = '0000-00-00' THEN NULL ELSE b.date_of_service END AS from_service_date,b.invoice_total AS total_charges, CAST(b.client_total AS DECIMAL(14,2)) AS amount_paid FROM txm_bitx_staging.techhealth_invoice_header b WHERE b.file_header_id = <INPUT_FILE_HEADER_ID>","transform_sql_select":"SELECT h.bill_id AS bill_id,from_service_date,total_charges,amount_paid FROM read_professional_treatment_vw v JOIN db_bill_header_vw h ON h.bill_header_id = v.bill_header_id"}
{"order_seq_no":6,"form_type":"CMS1500","table_type":"LINE_DETAIL","df_read_table_name":"read_professional_treatment_line_vw","df_table_name":"professional_treatment_line_vw","db_table_name":"txm_bitx.professional_treatment_line","db_select_cols_list":"","load_config_table_list":"","db_filter_id_col_name":"","db_read_sql_select":"SELECT b.invoice_header_id AS bill_header_id,CASE WHEN d.line_number = '' THEN NULL ELSE CAST(d.line_number AS UNSIGNED) END AS line_number,d.referral_detail_id AS referral_detail_id,CASE WHEN d.start_date = '0000-00-00' THEN NULL ELSE d.start_date END AS service_date_from,CASE WHEN d.end_date IS NOT NULL AND d.end_date <> '0000-00-00' THEN d.end_date ELSE d.start_date END AS service_date_to,d.line_item_place_of_service AS place_of_service_code,TRIM(d.hcpcs) AS procedure_code,SUBSTRING(d.modifier, 1, 2) AS procedure_code_modifier_1,SUBSTRING(d.modifier, 3, 2) AS procedure_code_modifier_2,SUBSTRING(d.modifier, 5, 2) AS procedure_code_modifier_3,CASE WHEN SUBSTRING(d.line_item_diagnosis_pointer, 1, 1) <> ' ' THEN SUBSTRING(d.line_item_diagnosis_pointer, 1, 1) ELSE NULL END AS diagnosis_pointer_1,CASE WHEN SUBSTRING(d.line_item_diagnosis_pointer, 2, 1) <> ' ' THEN SUBSTRING(d.line_item_diagnosis_pointer, 2, 1) ELSE NULL END AS diagnosis_pointer_2,CASE WHEN SUBSTRING(d.line_item_diagnosis_pointer, 3, 1) <> ' ' THEN SUBSTRING(d.line_item_diagnosis_pointer, 3, 1) ELSE NULL END AS diagnosis_pointer_3,CASE WHEN SUBSTRING(d.line_item_diagnosis_pointer, 4, 1) <> ' ' THEN SUBSTRING(d.line_item_diagnosis_pointer, 4, 1) ELSE NULL END AS diagnosis_pointer_4,d.line_item_charge_amount AS charges_for_services,CASE WHEN d.quantity > 9999 THEN 9999 ELSE d.quantity END AS units,d.line_item_emg AS emergency_service_indicator,d.parent_referral_detail_id AS parent_referral_detail_id,d.line_item_fee_amount,d.line_item_charge_amount - d.line_item_payment_amount AS ppo_reductions,d.skuid AS skuid FROM txm_bitx_staging.techhealth_invoice_header b JOIN txm_bitx_staging.techhealth_invoice_detail d ON b.invoice_header_id = d.invoice_header_id WHERE b.file_header_id = <INPUT_FILE_HEADER_ID>","transform_sql_select":"SELECT t.treatment_id,h.bill_id,line_number,referral_detail_id,service_date_from,service_date_to,place_of_service_code,procedure_code,procedure_code_modifier_1,procedure_code_modifier_2,procedure_code_modifier_3,diagnosis_pointer_1,diagnosis_pointer_2,diagnosis_pointer_3,diagnosis_pointer_4,charges_for_services,units,emergency_service_indicator,parent_referral_detail_id,line_item_fee_amount,ppo_reductions,skuid FROM read_professional_treatment_line_vw v JOIN db_bill_header_vw h ON h.bill_header_id = v.bill_header_id JOIN db_professional_treatment_vw t ON t.bill_id = h.bill_id"}
{"order_seq_no":7,"form_type":"CMS1500","table_type":"BILL_DETAIL","df_read_table_name":"read_billing_codes_vw","df_table_name":"billing_codes_vw","db_table_name":"txm_bitx.billing_codes","db_select_cols_list":"","load_config_table_list":"bitx_static_config.common_static_configuration","db_filter_id_col_name":"","db_read_sql_select":"SELECT invoice_header_id AS bill_header_id,NULLIF(date_of_service, '0000-00-00') AS service_date_from, 1 AS sequence_number, NULLIF(TRIM(diagnosis1), '') AS diagnosis_code FROM txm_bitx_staging.techhealth_invoice_header WHERE file_header_id = <INPUT_FILE_HEADER_ID> UNION ALL SELECT invoice_header_id AS bill_header_id, NULLIF(date_of_service, '0000-00-00') AS service_date_from,2 AS sequence_number, NULLIF(TRIM(diagnosis2), '') AS diagnosis_code FROM txm_bitx_staging.techhealth_invoice_header WHERE file_header_id = <INPUT_FILE_HEADER_ID> UNION ALL SELECT invoice_header_id AS bill_header_id,NULLIF(date_of_service, '0000-00-00') AS service_date_from, 3 AS sequence_number, NULLIF(TRIM(diagnosis3), '') AS diagnosis_code FROM txm_bitx_staging.techhealth_invoice_header WHERE file_header_id = <INPUT_FILE_HEADER_ID> UNION ALL SELECT invoice_header_id AS bill_header_id, NULLIF(date_of_service, '0000-00-00') AS service_date_from,4 AS sequence_number, NULLIF(TRIM(diagnosis4), '') AS diagnosis_code FROM txm_bitx_staging.techhealth_invoice_header WHERE file_header_id = <INPUT_FILE_HEADER_ID> UNION ALL SELECT invoice_header_id AS bill_header_id, NULLIF(date_of_service, '0000-00-00') AS service_date_from, 5 AS sequence_number, NULLIF(TRIM(diagnosis5), '') AS diagnosis_code FROM txm_bitx_staging.techhealth_invoice_header WHERE file_header_id = <INPUT_FILE_HEADER_ID> UNION ALL SELECT invoice_header_id AS bill_header_id, NULLIF(date_of_service, '0000-00-00') AS service_date_from,6 AS sequence_number, NULLIF(TRIM(diagnosis6), '') AS diagnosis_code FROM txm_bitx_staging.techhealth_invoice_header WHERE file_header_id = <INPUT_FILE_HEADER_ID> UNION ALL SELECT invoice_header_id AS bill_header_id, NULLIF(date_of_service, '0000-00-00') AS service_date_from,7 AS sequence_number, NULLIF(TRIM(diagnosis7), '') AS diagnosis_code FROM txm_bitx_staging.techhealth_invoice_header WHERE file_header_id = <INPUT_FILE_HEADER_ID> UNION ALL SELECT invoice_header_id AS bill_header_id, NULLIF(date_of_service, '0000-00-00') AS service_date_from,8 AS sequence_number, NULLIF(TRIM(diagnosis8), '') AS diagnosis_code FROM txm_bitx_staging.techhealth_invoice_header WHERE file_header_id = <INPUT_FILE_HEADER_ID> UNION ALL SELECT invoice_header_id AS bill_header_id, NULLIF(date_of_service, '0000-00-00') AS service_date_from,9 AS sequence_number, NULLIF(TRIM(diagnosis9), '') AS diagnosis_code FROM txm_bitx_staging.techhealth_invoice_header WHERE file_header_id = <INPUT_FILE_HEADER_ID> UNION ALL SELECT invoice_header_id AS bill_header_id, NULLIF(date_of_service, '0000-00-00') AS service_date_from,10 AS sequence_number, NULLIF(TRIM(diagnosis10), '') AS diagnosis_code FROM txm_bitx_staging.techhealth_invoice_header WHERE file_header_id = <INPUT_FILE_HEADER_ID> UNION ALL SELECT invoice_header_id AS bill_header_id, NULLIF(date_of_service, '0000-00-00') AS service_date_from,11 AS sequence_number, NULLIF(TRIM(diagnosis11), '') AS diagnosis_code FROM txm_bitx_staging.techhealth_invoice_header WHERE file_header_id = <INPUT_FILE_HEADER_ID> UNION ALL SELECT invoice_header_id AS bill_header_id, NULLIF(date_of_service, '0000-00-00') AS service_date_from,12 AS sequence_number, NULLIF(TRIM(diagnosis12), '') AS diagnosis_code FROM txm_bitx_staging.techhealth_invoice_header WHERE file_header_id = <INPUT_FILE_HEADER_ID>","transform_sql_select":"SELECT h.bill_id AS bill_id,'DIAGNOSTIC' AS code_type,v.sequence_number,v.diagnosis_code,CASE WHEN v.service_date_from < t.attribute_value THEN 'ICD9' ELSE 'ICD10' END AS diagnosis_code_qualifier_icd FROM read_billing_codes_vw v LEFT JOIN db_bill_header_vw h ON h.bill_header_id = v.bill_header_id LEFT JOIN common_static_configuration_vw t ON t.attribute_name = 'icd_release_date'"}
{"order_seq_no":8,"form_type":"CMS1500","table_type":"BILL_DETAIL","df_read_table_name":"read_billing_documents_vw","df_table_name":"billing_documents_vw","db_table_name":"txm_bitx.billing_documents","db_select_cols_list":"","load_config_table_list":"","db_filter_id_col_name":"","db_read_sql_select":"SELECT b.invoice_header_id AS bill_header_id,a.document_id AS attachment_control_number,a.document_type AS document_type_code FROM txm_bitx_staging.techhealth_invoice_header b JOIN txm_bitx_staging.techhealth_attachment a ON b.invoice_header_id = a.invoice_header_id WHERE b.file_header_id = <INPUT_FILE_HEADER_ID>","transform_sql_select":"SELECT h.bill_id AS bill_id,attachment_control_number,document_type_code FROM read_billing_documents_vw v JOIN db_bill_header_vw h ON h.bill_header_id = v.bill_header_id"}