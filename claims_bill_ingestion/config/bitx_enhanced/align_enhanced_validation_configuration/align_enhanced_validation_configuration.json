{"order_seq_no": 1, "validation_type": "primary", "error_desc": "Invoice data processed previously. This data has been bypassed.", "df_table_name": "align_validation_1_vw", "db_validate_sql_select": "SELECT f.file_header_id, sb.invoice_header_id as bill_header_id,sb.invoice_number as unique_bill_id, MIN(CASE WHEN s.txm_invoice_number IS NULL THEN 'PASS' WHEN s.status IN ('FAILED', 'MARKED_FOR_DELETION', 'DELETED') THEN 'PASS' ELSE 'FAIL' END) AS validation_result,'txm_invoice_number'  AS field_name_1, CAST(MIN(eb.txm_invoice_number) AS CHAR(255)) AS field_value_1, 'invoice_header_id' AS field_name_2, CAST(sb.invoice_header_id AS CHAR(255)) AS field_value_2 FROM txm_bitx_staging.align_file_header f JOIN txm_bitx_staging.align_invoice_header sb ON f.file_header_id = sb.file_header_id LEFT JOIN txm_bitx.bill_header eb ON eb.source = 'ebill' AND eb.trading_partner = 'align' AND sb.invoice_number = eb.unique_bill_id LEFT JOIN txm_bitx.invoice_status s ON eb.txm_invoice_number = s.txm_invoice_number WHERE f.file_header_id = <INPUT_FILE_HEADER_ID> GROUP BY f.file_header_id, sb.invoice_header_id, sb.invoice_number"}
{"order_seq_no": 2, "validation_type": "secondary", "error_desc": "SSN Number missing or invalid.", "df_table_name": "align_validation_2_vw", "db_validate_sql_select": "SELECT f.file_header_id, sb.invoice_header_id as bill_header_id,sb.invoice_number as unique_bill_id, CASE WHEN (sb.ssn IS NULL or sb.ssn = '') OR (sb.ssn REGEXP '^0+$') THEN 'FAIL' ELSE 'PASS' END AS validation_result,'ssn' AS field_name_1,sb.ssn AS field_value_1,'' AS field_name_2, '' AS field_value_2 FROM txm_bitx_staging.align_file_header f JOIN txm_bitx_staging.align_invoice_header sb ON f.file_header_id = sb.file_header_id WHERE f.file_header_id = <INPUT_FILE_HEADER_ID>"}
{"order_seq_no": 3, "validation_type": "secondary", "error_desc": "Service Facility Name, Address or Zip Code missing.", "df_table_name": "align_validation_3_vw", "db_validate_sql_select": "SELECT f.file_header_id, sb.invoice_header_id as bill_header_id,sb.invoice_number as unique_bill_id, CASE WHEN sb.facility_name IS NOT NULL AND sb.facility_name <> '' AND sb.facility_address1 IS NOT NULL AND sb.facility_address1 <> '' AND sb.facility_zip_code IS NOT NULL AND sb.facility_zip_code <> '' THEN 'PASS' ELSE 'FAIL' END AS validation_result,'facility_name' AS field_name_1,sb.facility_name AS field_value_1, 'facility_address_zip_code'  AS field_name_2, CONCAT(sb.facility_address1, ' ', sb.facility_zip_code) AS field_value_2 FROM txm_bitx_staging.align_file_header f JOIN txm_bitx_staging.align_invoice_header sb ON f.file_header_id = sb.file_header_id WHERE f.file_header_id = <INPUT_FILE_HEADER_ID>"}
{"order_seq_no": 4, "validation_type": "secondary", "error_desc": "No line items found for invoice.", "df_table_name": "align_validation_4_vw", "db_validate_sql_select": "SELECT DISTINCT f.file_header_id, sb.invoice_header_id as bill_header_id,sb.invoice_number as unique_bill_id, CASE WHEN COUNT(a.invoice_detail_id) OVER(PARTITION BY sb.invoice_header_id) > 0 THEN 'PASS' ELSE 'FAIL' END AS validation_result,' ' AS field_name_1, '' AS field_value_1, ' '  AS field_name_2, '' AS field_value_2 FROM txm_bitx_staging.align_file_header f JOIN txm_bitx_staging.align_invoice_header sb ON f.file_header_id = sb.file_header_id LEFT JOIN txm_bitx_staging.align_invoice_detail a ON sb.invoice_header_id = a.invoice_header_id WHERE f.file_header_id = <INPUT_FILE_HEADER_ID>"}
{"order_seq_no": 5, "validation_type": "secondary", "error_desc": "Charge amount found with no quantity.", "df_table_name": "align_validation_5_vw", "db_validate_sql_select": "SELECT f.file_header_id, sb.invoice_header_id as bill_header_id,sb.invoice_number as unique_bill_id, MIN(CASE WHEN (CAST(l.quantity AS SIGNED) < 1 OR l.quantity is NULL) THEN 'FAIL' ELSE 'PASS' END) AS validation_result,'quantity'  AS field_name_1, l.quantity AS field_value_1, ' '  AS field_name_2, '' AS field_value_2 FROM txm_bitx_staging.align_file_header f JOIN txm_bitx_staging.align_invoice_header sb ON f.file_header_id = sb.file_header_id LEFT JOIN txm_bitx_staging.align_invoice_detail l ON sb.invoice_header_id = l.invoice_header_id WHERE f.file_header_id = <INPUT_FILE_HEADER_ID> GROUP BY f.file_header_id, sb.invoice_header_id"}
{"order_seq_no": 6, "validation_type": "secondary", "error_desc": "Date of Service Missing or Invalid.", "df_table_name": "align_validation_7_vw", "db_validate_sql_select": "SELECT f.file_header_id, sb.invoice_header_id as bill_header_id,sb.invoice_number as unique_bill_id, CASE WHEN sb.date_of_service IS NULL OR sb.date_of_service = '0000-00-00' THEN 'FAIL' WHEN DATE_FORMAT(sb.date_of_service, '%Y%m%d') = DATE_FORMAT(sb.date_of_service, '%Y%m%d') THEN 'PASS' ELSE 'FAIL' END AS validation_result,'date_of_service'  AS field_name_1, CAST(sb.date_of_service AS CHAR(255)) AS field_value_1, ' '  AS field_name_2, '' AS field_value_2 FROM txm_bitx_staging.align_file_header f JOIN txm_bitx_staging.align_invoice_header sb ON f.file_header_id = sb.file_header_id WHERE f.file_header_id = <INPUT_FILE_HEADER_ID>"}
{"order_seq_no": 7, "validation_type": "secondary", "error_desc": "Claim number is invalid or missing.","df_table_name":"align_validation_8_vw","db_validate_sql_select":"SELECT o.file_header_id,o.invoice_header_id as bill_header_id,o.invoice_number as unique_bill_id,(CASE WHEN c.txm_claim_number = o.claim_number THEN 'PASS' ELSE 'FAIL' END) AS validation_result,'Claim Number' AS field_name_1,o.claim_number AS field_value_1,'' AS field_name_2,'' AS field_value_2 FROM txm_bitx_staging.align_invoice_header o LEFT JOIN txm_bitx_staging.claim_data c ON c.trading_partner='align' AND  o.file_header_id=c.file_header_id AND o.invoice_header_id=c.bill_header_id WHERE o.file_header_id =<INPUT_FILE_HEADER_ID>"}
{"order_seq_no": 8, "validation_type": "secondary", "error_desc": "Partial Denial/Claim Condition Detected for Subro Future Credit Medical and Indemnity or Subro Future Credit Medical Only for this claim.","df_table_name":"align_validation_9_vw","db_validate_sql_select":"SELECT o.file_header_id,o.invoice_header_id as bill_header_id,o.invoice_number as unique_bill_id,MIN(CASE WHEN c.txm_claim_number = o.claim_number AND cd.claim_denial_data_id IS NOT NULL AND cd.denial_status_code <> 'Draft' AND cd.denial_effectivefrom_date<=o.date_of_service AND (cd.denial_effectiveto_date IS NULL OR cd.denial_effectiveto_date >=o.date_of_service) AND (cd.reverse_date IS NULL OR o.date_of_service<=cd.reverse_date) AND (cd.reverse_status_code IS NULL OR cd.reverse_status_code <> 'Posted') THEN 'FAIL' ELSE 'PASS' END) AS validation_result,'Denial category' AS field_name_1,cd.denial_category_code AS field_value_1,'Claim Number' AS field_name_2,o.claim_number AS field_value_2 FROM txm_bitx_staging.align_invoice_header o LEFT JOIN txm_bitx_staging.claim_data c ON c.trading_partner='align' AND  o.file_header_id=c.file_header_id AND o.invoice_header_id=c.bill_header_id LEFT JOIN txm_bitx_staging.claim_denial_data cd ON cd.claim_data_id=c.claim_data_id AND cd.denial_type_code = 'partialclaimdenial' AND cd.denial_category_code ='subrofuturecredmedindem' WHERE o.file_header_id =<INPUT_FILE_HEADER_ID> GROUP BY o.file_header_id,o.invoice_header_id,o.invoice_number"}
{"order_seq_no": 9,"validation_type": "secondary", "error_desc": "Partial Denial/Claim Condition Detected for Subro Future Credit Medical and Indemnity or Subro Future Credit Medical Only for this claim","df_table_name":"align_validation_10_vw","db_validate_sql_select":"SELECT o.file_header_id,o.invoice_header_id as bill_header_id,o.invoice_number as unique_bill_id,MIN(CASE WHEN c.txm_claim_number = o.claim_number AND cd.claim_denial_data_id IS NOT NULL AND cd.denial_status_code <> 'Draft' AND cd.denial_effectivefrom_date<=o.date_of_service AND (cd.denial_effectiveto_date IS NULL OR cd.denial_effectiveto_date >=o.date_of_service) AND (cd.reverse_date IS NULL OR o.date_of_service<=cd.reverse_date) AND (cd.reverse_status_code IS NULL OR cd.reverse_status_code <> 'Posted') THEN 'FAIL' ELSE 'PASS' END) AS validation_result,'Denial category' AS field_name_1,cd.denial_category_code AS field_value_1,'Claim Number' AS field_name_2,o.claim_number AS field_value_2 FROM txm_bitx_staging.align_invoice_header o LEFT JOIN txm_bitx_staging.claim_data c ON c.trading_partner='align' AND  o.file_header_id=c.file_header_id AND o.invoice_header_id=c.bill_header_id LEFT JOIN txm_bitx_staging.claim_denial_data cd ON cd.claim_data_id=c.claim_data_id AND cd.denial_type_code = 'partialclaimdenial' AND cd.denial_category_code = 'subrofuturecredmed' WHERE o.file_header_id =<INPUT_FILE_HEADER_ID> GROUP BY o.file_header_id,o.invoice_header_id,o.invoice_number"}
{"order_seq_no": 10,"validation_type": "secondary", "error_desc": "Partial Denial/Claim Condition Detected for Subro Future Credit Medical and Indemnity or Subro Future Credit Medical Only for this claim","df_table_name":"align_validation_11_vw","db_validate_sql_select":"SELECT o.file_header_id,o.invoice_header_id as bill_header_id,o.invoice_number as unique_bill_id,MIN(CASE WHEN c.txm_claim_number = o.claim_number AND cc.claim_condition_data_id IS NOT NULL AND cc.conditional_effective_date<=o.date_of_service AND (cc.conditional_expiry_date IS NULL OR cc.conditional_expiry_date >= o.date_of_service) THEN 'FAIL' ELSE 'PASS' END) AS validation_result,'Condition Type' AS field_name_1,cc.conditional_type_code AS field_value_1,'Claim Number' AS field_name_2,o.claim_number AS field_value_2 FROM txm_bitx_staging.align_invoice_header o LEFT JOIN txm_bitx_staging.claim_data c ON c.trading_partner='align' AND o.file_header_id=c.file_header_id AND o.invoice_header_id=c.bill_header_id LEFT JOIN txm_bitx_staging.claim_condition_data cc ON cc.claim_data_id=c.claim_data_id AND cc.conditional_type_code ='subrofuturecredmedindem' WHERE o.file_header_id =<INPUT_FILE_HEADER_ID> GROUP BY o.file_header_id,o.invoice_header_id,o.invoice_number"}
{"order_seq_no": 11,"validation_type": "secondary", "error_desc": "Partial Denial/Claim Condition Detected for Subro Future Credit Medical and Indemnity or Subro Future Credit Medical Only for this claim","df_table_name":"align_validation_12_vw","db_validate_sql_select":"SELECT o.file_header_id,o.invoice_header_id as bill_header_id,o.invoice_number as unique_bill_id,MIN(CASE WHEN c.txm_claim_number = o.claim_number AND cc.claim_condition_data_id IS NOT NULL AND cc.conditional_effective_date<=o.date_of_service AND (cc.conditional_expiry_date IS NULL OR cc.conditional_expiry_date >= o.date_of_service) THEN 'FAIL' ELSE 'PASS' END) AS validation_result,'Condition Type' AS field_name_1,cc.conditional_type_code AS field_value_1,'Claim Number' AS field_name_2,o.claim_number AS field_value_2 FROM txm_bitx_staging.align_invoice_header o LEFT JOIN txm_bitx_staging.claim_data c ON c.trading_partner='align' AND o.file_header_id=c.file_header_id AND o.invoice_header_id=c.bill_header_id LEFT JOIN txm_bitx_staging.claim_condition_data cc ON cc.claim_data_id=c.claim_data_id AND cc.conditional_type_code ='subrofuturecredmed' WHERE o.file_header_id =<INPUT_FILE_HEADER_ID> GROUP BY o.file_header_id,o.invoice_header_id,o.invoice_number"}