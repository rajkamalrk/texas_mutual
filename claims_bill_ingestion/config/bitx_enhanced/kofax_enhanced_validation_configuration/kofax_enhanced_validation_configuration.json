{"order_seq_no": 1,"validation_type": "secondary", "error_desc": "Invoice data processed previously", "df_table_name": "kofax_validation_1_vw","db_validate_sql_select": "SELECT c.header_id, 'CMS1500' AS form_type, c.cms_id AS bill_header_id, c.invoice_number, CASE WHEN b.txm_invoice_number IS NOT NULL THEN 'FAIL' ELSE 'PASS' END AS validation_result, 'invoice_number' AS field_name_1, CAST(c.invoice_number AS CHAR(255)) AS field_value_1, ''  AS field_name_2,  '' AS field_value_2 FROM txm_bitx_kofax_staging.kofax_cms1500 c LEFT JOIN txm_bitx.bill_header b ON b.txm_invoice_number = c.invoice_number WHERE c.header_id = <INPUT_FILE_HEADER_ID> UNION ALL SELECT u.header_id, 'UB04' AS form_type, u.ub_id AS bill_header_id, u.invoice_number, CASE WHEN b.txm_invoice_number IS NOT NULL THEN 'FAIL' ELSE 'PASS' END AS validation_result, 'invoice_number' AS field_name_1, CAST(u.invoice_number AS CHAR(255)) AS field_value_1, ''  AS field_name_2,  '' AS field_value_2 FROM txm_bitx_kofax_staging.kofax_ub04 u LEFT JOIN txm_bitx.bill_header b ON b.txm_invoice_number = u.invoice_number WHERE u.header_id = <INPUT_FILE_HEADER_ID> UNION ALL SELECT d.header_id, 'DWC066' AS form_type, d.dwc_id AS bill_header_id, d.invoice_number, CASE WHEN b.txm_invoice_number IS NOT NULL THEN 'FAIL' ELSE 'PASS' END AS validation_result, 'invoice_number' AS field_name_1, CAST(d.invoice_number AS CHAR(255)) AS field_value_1, ''  AS field_name_2, '' AS field_value_2 FROM txm_bitx_kofax_staging.kofax_dwc066 d LEFT JOIN txm_bitx.bill_header b ON b.txm_invoice_number = d.invoice_number WHERE d.header_id = <INPUT_FILE_HEADER_ID>"}
{"order_seq_no": 2,"validation_type": "secondary", "error_desc": "Invoice data processed previously", "df_table_name": "kofax_validation_2_vw","db_validate_sql_select": "WITH batch_ranked_data AS ( SELECT t.header_id, t.form_type, t.bill_header_id, t.invoice_number ,ROW_NUMBER() OVER (PARTITION BY t.invoice_number ORDER BY t.receive_date ASC, t.create_timestamp ASC) AS row_num FROM (SELECT c.header_id, 'CMS1500' AS form_type, c.cms_id AS bill_header_id, c.invoice_number, c.receive_date, c.create_timestamp FROM txm_bitx_kofax_staging.kofax_cms1500 c WHERE c.header_id = <INPUT_FILE_HEADER_ID> UNION ALL SELECT u.header_id, 'UB04' AS form_type, u.ub_id AS bill_header_id, u.invoice_number, u.receive_date, u.create_timestamp FROM txm_bitx_kofax_staging.kofax_ub04 u WHERE u.header_id = <INPUT_FILE_HEADER_ID> UNION ALL SELECT d.header_id, 'DWC066' AS form_type, d.dwc_id AS bill_header_id, d.invoice_number, d.receive_date, d.create_timestamp FROM txm_bitx_kofax_staging.kofax_dwc066 d WHERE d.header_id = <INPUT_FILE_HEADER_ID> ) AS t) SELECT tr.header_id, tr.form_type, tr.bill_header_id, tr.invoice_number, CASE WHEN tr.row_num = 1 THEN 'PASS' ELSE 'FAIL' END AS validation_result, 'invoice_number' AS field_name_1, CAST(tr.invoice_number AS CHAR(255)) AS field_value_1, '' AS field_name_2, '' AS field_value_2 FROM batch_ranked_data tr"}