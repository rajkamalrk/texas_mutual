{"order_seq_no": 1,"validation_type": "secondary","error_desc": "IRS missing or invalid.","df_table_name": "optum_validation_1_vw","db_validate_sql_select":"SELECT file_header_id,invoice_header_id AS bill_header_id, pbm_rx_no AS unique_bill_id,(CASE WHEN TRIM(irs_number) <> '' AND  TRIM(irs_number) IS NOT NULL THEN 'PASS' ELSE 'FAIL' END) AS validation_result ,'IRS'  AS field_name_1, irs_number AS field_value_1, ''  AS field_name_2,''AS field_value_2  FROM txm_bitx_staging.optum_invoice WHERE file_header_id= <INPUT_FILE_HEADER_ID> "}
{"order_seq_no": 2,"validation_type": "secondary","error_desc": "Charge amount found with Zero Price.","df_table_name": "optum_validation_3_vw","db_validate_sql_select":"SELECT file_header_id,invoice_header_id AS bill_header_id, pbm_rx_no AS unique_bill_id,(CASE WHEN rx_quantity >= 1 AND (charged_amount <=0000.00 OR charged_amount IS NULL) THEN 'FAIL' ELSE 'PASS' END) AS validation_result ,'Charged_amount'  AS field_name_1, CAST(charged_amount AS CHAR(255)) AS field_value_1, 'rx_quantity'  AS field_name_2, CAST(rx_quantity AS CHAR(255)) AS field_value_2 FROM txm_bitx_staging.optum_invoice WHERE file_header_id= <INPUT_FILE_HEADER_ID>"}
{"order_seq_no": 3,"validation_type": "secondary","error_desc": "Charge amount found with no quantity.","df_table_name": "optum_validation_4_vw","db_validate_sql_select":"SELECT file_header_id,invoice_header_id AS bill_header_id, pbm_rx_no AS unique_bill_id,CASE WHEN (charged_amount > 0000.00 AND (rx_quantity <=0 OR rx_quantity IS NULL))  THEN 'FAIL' ELSE 'PASS' END AS validation_result,'Charged_amount'  AS field_name_1, CAST(charged_amount AS CHAR(255)) AS field_value_1, 'rx_quantity'  AS field_name_2, CAST(rx_quantity AS CHAR(255)) AS field_value_2 FROM txm_bitx_staging.optum_invoice WHERE file_header_id= <INPUT_FILE_HEADER_ID>"}
{"order_seq_no": 4,"validation_type": "secondary","error_desc": "Service Facility Name, Address or Zip Code missing.","df_table_name": "optum_validation_5_vw","db_validate_sql_select":"SELECT file_header_id,invoice_header_id AS bill_header_id, pbm_rx_no AS unique_bill_id,(CASE WHEN (TRIM(pharmacy_name) IS NOT NULL AND TRIM(pharmacy_name) <> '') AND (TRIM(pharmacy_address1) IS NOT NULL AND TRIM(pharmacy_address1) <> '') AND (TRIM(pharmacy_zip) IS NOT NULL AND TRIM(pharmacy_zip) <> '') THEN 'PASS' ELSE 'FAIL' END) AS validation_result,'Facility Name'  AS field_name_1, pharmacy_name AS field_value_1, 'Facility Address'  AS field_name_2,concat(pharmacy_address1,',',pharmacy_zip)AS field_value_2 FROM txm_bitx_staging.optum_invoice WHERE file_header_id= <INPUT_FILE_HEADER_ID>"}
{"order_seq_no": 5,"validation_type": "secondary","error_desc": "Duplicate Rx Detected .","df_table_name": "optum_validation_6_vw","db_validate_sql_select":"SELECT oi.file_header_id, oi.invoice_header_id AS bill_header_id, oi.pbm_rx_no AS unique_bill_id, MIN(CASE WHEN s.txm_invoice_number IS NOT NULL AND s.status NOT IN ('FAILED', 'MARKED_FOR_DELETION', 'DELETED') AND bh.reported_claim_number = oi.claim_number AND pl.ndc_code = oi.ndc AND pl.prescription_number = oi.rx_number AND pl.prescription_date = oi.date_filled AND p.rendering_provider_dea_number = oi.dea THEN 'FAIL' ELSE 'PASS' END) AS validation_result, 'reported_claim_number' AS field_name_1, bh.reported_claim_number AS field_value_1, 'rx_number'  AS field_name_2, oi.rx_number AS field_value_2 FROM txm_bitx_staging.optum_invoice oi LEFT JOIN txm_bitx.bill_header bh ON bh.source = 'ebill' AND bh.trading_partner = 'optum' AND bh.reported_claim_number = oi.claim_number LEFT JOIN txm_bitx.invoice_status s ON bh.txm_invoice_number = s.txm_invoice_number LEFT JOIN txm_bitx.pharmacy_line pl ON pl.bill_id = bh.bill_id LEFT JOIN txm_bitx.provider p ON p.bill_id = bh.bill_id WHERE oi.file_header_id = <INPUT_FILE_HEADER_ID> GROUP BY oi.file_header_id, oi.invoice_header_id, oi.pbm_rx_no"}
{"order_seq_no": 6,"validation_type": "secondary","error_desc": "Partial Denial/Claim Condition Detected for Subro Future Credit Medical and Indemnity or Subro Future Credit Medical Only on this Claim","df_table_name": "optum_validation_7_vw","db_validate_sql_select":"SELECT o.file_header_id,o.invoice_header_id as bill_header_id,o.pbm_rx_no AS unique_bill_id,MIN(CASE WHEN c.txm_claim_number = o.claim_number AND cc.claim_condition_data_id IS NOT NULL AND cc.conditional_effective_date<=o.date_filled AND (cc.conditional_expiry_date IS NULL OR cc.conditional_expiry_date >= o.date_filled) THEN 'FAIL' ELSE 'PASS' END ) AS validation_result ,'Condition Type' AS field_name_1, cc.conditional_type_code AS field_value_1, 'Claim Number' AS field_name_2,o.claim_number AS field_value_2 FROM txm_bitx_staging.optum_invoice o LEFT JOIN txm_bitx_staging.claim_data c ON c.trading_partner='optum' AND o.file_header_id=c.file_header_id AND o.invoice_header_id=c.bill_header_id LEFT JOIN txm_bitx_staging.claim_condition_data cc ON cc.claim_data_id=c.claim_data_id AND cc.conditional_type_code ='subrofuturecredmedindem' WHERE o.file_header_id = <INPUT_FILE_HEADER_ID> GROUP BY o.file_header_id,o.invoice_header_id,o.pbm_rx_no"}
{"order_seq_no": 7,"validation_type": "secondary","error_desc": "Partial Denial/Claim Condition Detected for Subro Future Credit Medical and Indemnity or Subro Future Credit Medical Only on this Claim","df_table_name": "optum_validation_8_vw","db_validate_sql_select":"SELECT o.file_header_id,o.invoice_header_id as bill_header_id,o.pbm_rx_no AS unique_bill_id,MIN(CASE WHEN c.txm_claim_number = o.claim_number AND cc.claim_condition_data_id IS NOT NULL  AND cc.conditional_effective_date<=o.date_filled AND (cc.conditional_expiry_date IS NULL OR cc.conditional_expiry_date >= o.date_filled) THEN 'FAIL' ELSE 'PASS' END ) AS validation_result ,'Condition Type' AS field_name_1, cc.conditional_type_code AS field_value_1, 'Claim Number' AS field_name_2,o.claim_number AS field_value_2 FROM txm_bitx_staging.optum_invoice o LEFT JOIN txm_bitx_staging.claim_data c ON c.trading_partner='optum' AND o.file_header_id=c.file_header_id AND o.invoice_header_id=c.bill_header_id LEFT JOIN txm_bitx_staging.claim_condition_data cc ON cc.claim_data_id=c.claim_data_id AND cc.conditional_type_code ='subrofuturecredmed' WHERE o.file_header_id = <INPUT_FILE_HEADER_ID> GROUP BY o.file_header_id,o.invoice_header_id,o.pbm_rx_no"}
{"order_seq_no": 8,"validation_type": "secondary","error_desc": "Missing or Invalid Claim Number","df_table_name": "optum_validation_9_vw","db_validate_sql_select":"SELECT o.file_header_id,o.invoice_header_id as bill_header_id,o.pbm_rx_no AS unique_bill_id,(CASE WHEN c.txm_claim_number = o.claim_number  THEN 'PASS' ELSE 'FAIL' END ) AS validation_result ,'Claim Number'  AS field_name_1, o.claim_number AS field_value_1, ''  AS field_name_2,''AS field_value_2  FROM txm_bitx_staging.optum_invoice o LEFT JOIN  txm_bitx_staging.claim_data c ON c.trading_partner='optum' AND  o.file_header_id=c.file_header_id AND o.invoice_header_id=c.bill_header_id WHERE o.file_header_id = <INPUT_FILE_HEADER_ID>"}
{"order_seq_no": 9, "validation_type": "secondary", "error_desc": "Partial Denial/Claim Condition Detected for Subro Future Credit Medical and Indemnity or Subro Future Credit Medical Only on this claim.","df_table_name":"optum_validation_10_vw","db_validate_sql_select":"SELECT o.file_header_id,o.invoice_header_id as bill_header_id,o.pbm_rx_no AS unique_bill_id,MIN(CASE WHEN c.txm_claim_number = o.claim_number AND cd.claim_denial_data_id IS NOT NULL AND cd.denial_status_code <> 'Draft' AND cd.denial_effectivefrom_date<=o.date_filled AND (cd.denial_effectiveto_date IS NULL OR cd.denial_effectiveto_date >=o.date_filled) AND (cd.reverse_date IS NULL OR o.date_filled<=cd.reverse_date)  AND (cd.reverse_status_code IS NULL OR cd.reverse_status_code <> 'Posted') THEN 'FAIL' ELSE 'PASS' END) AS validation_result,'Denial category' AS field_name_1,cd.denial_category_code AS field_value_1,'Claim Number' AS field_name_2,o.claim_number AS field_value_2 FROM txm_bitx_staging.optum_invoice o LEFT JOIN txm_bitx_staging.claim_data c ON c.trading_partner='optum' AND  o.file_header_id=c.file_header_id AND o.invoice_header_id=c.bill_header_id LEFT JOIN txm_bitx_staging.claim_denial_data cd ON cd.claim_data_id=c.claim_data_id AND cd.denial_type_code = 'partialclaimdenial' AND cd.denial_category_code ='subrofuturecredmedindem' WHERE o.file_header_id =<INPUT_FILE_HEADER_ID> GROUP BY o.file_header_id,o.invoice_header_id,o.pbm_rx_no"}
{"order_seq_no": 10,"validation_type": "secondary", "error_desc": "Partial Denial/Claim Condition Detected for Subro Future Credit Medical and Indemnity or Subro Future Credit Medical Only on this claim","df_table_name":"optum_validation_11_vw","db_validate_sql_select":"SELECT o.file_header_id,o.invoice_header_id as bill_header_id,o.pbm_rx_no AS unique_bill_id,MIN(CASE WHEN c.txm_claim_number = o.claim_number AND cd.claim_denial_data_id IS NOT NULL AND cd.denial_status_code <> 'Draft' AND cd.denial_effectivefrom_date<=o.date_filled AND (cd.denial_effectiveto_date IS NULL OR cd.denial_effectiveto_date >=o.date_filled) AND (cd.reverse_date IS NULL OR o.date_filled<=cd.reverse_date) AND (cd.reverse_status_code IS NULL OR cd.reverse_status_code <> 'Posted') THEN 'FAIL' ELSE 'PASS' END) AS validation_result,'Denial category' AS field_name_1,cd.denial_category_code AS field_value_1,'Claim Number' AS field_name_2,o.claim_number AS field_value_2 FROM txm_bitx_staging.optum_invoice o LEFT JOIN txm_bitx_staging.claim_data c ON c.trading_partner='optum' AND o.file_header_id=c.file_header_id AND o.invoice_header_id=c.bill_header_id LEFT JOIN txm_bitx_staging.claim_denial_data cd ON cd.claim_data_id=c.claim_data_id AND cd.denial_type_code = 'partialclaimdenial' AND cd.denial_category_code ='subrofuturecredmed' WHERE o.file_header_id = <INPUT_FILE_HEADER_ID> GROUP BY o.file_header_id,o.invoice_header_id,o.pbm_rx_no"}