{"order_seq_no": 1,"validation_type": "primary","error_desc": "Invoice data processed previously. This data has been bypassed.","df_table_name": "jopari_validation_1_vw","db_validate_sql_select":  "SELECT f.file_header_id, sb.bill_header_id, sb.unique_bill_id, MIN(CASE WHEN s.txm_invoice_number IS NULL THEN 'PASS' WHEN s.status IN ('FAILED', 'MARKED_FOR_DELETION' , 'DELETED', 'NOTIFIED_REJECTED') THEN 'PASS' ELSE 'FAIL' END) AS validation_result,'txm_invoice_number' AS field_name_1, CAST(MIN(s.txm_invoice_number) AS CHAR(255)) AS field_value_1, ''  AS field_name_2,''AS field_value_2 FROM txm_bitx_staging.jopari_file_header_record_01 f JOIN txm_bitx_staging.jopari_bill_header_record_10 sb ON f.file_header_id = sb.file_header_id LEFT JOIN txm_bitx.bill_header eb ON eb.source = 'ebill' AND eb.trading_partner = 'jopari' AND sb.unique_bill_id = eb.unique_bill_id LEFT JOIN txm_bitx.invoice_status s ON eb.txm_invoice_number = s.txm_invoice_number WHERE f.file_header_id = <INPUT_FILE_HEADER_ID> GROUP BY f.file_header_id, sb.bill_header_id, sb.unique_bill_id"}
{"order_seq_no": 2,"validation_type": "secondary","error_desc": "No line items found for invoice.","df_table_name": "jopari_validation_2_vw","db_validate_sql_select": "SELECT DISTINCT f.file_header_id, sb.bill_header_id, sb.unique_bill_id,CASE WHEN COUNT(l.bill_detail_record_id) OVER(PARTITION BY sb.bill_header_id) > 0 THEN 'PASS' ELSE 'FAIL' END AS validation_result,''  AS field_name_1, '' AS field_value_1, ''  AS field_name_2,  '' AS field_value_2 FROM txm_bitx_staging.jopari_file_header_record_01 f JOIN txm_bitx_staging.jopari_bill_header_record_10 sb ON f.file_header_id = sb.file_header_id LEFT JOIN txm_bitx_staging.jopari_bill_detail_record_50 l ON sb.bill_header_id = l.bill_header_id WHERE f.file_header_id = <INPUT_FILE_HEADER_ID>"}
{"order_seq_no": 3,"validation_type": "secondary","error_desc": "Service Facility Name, Address or Zip Code missing.","df_table_name": "jopari_validation_3_vw","db_validate_sql_select": "SELECT DISTINCT f.file_header_id, sb.bill_header_id,sb.unique_bill_id, CASE WHEN bp.service_facility_name IS NOT NULL AND bp.service_facility_name <> '' AND bp.service_facility_address1 IS NOT NULL AND bp.service_facility_address1 <> '' AND bp.service_facility_zip_code IS NOT NULL AND bp.service_facility_zip_code <> '' THEN 'PASS' ELSE 'FAIL' END AS validation_result,'Facility Name' AS field_name_1, bp.service_facility_name AS field_value_1, 'Facility Address' AS field_name_2, concat(bp.service_facility_address1,',',bp.service_facility_zip_code) AS field_value_2 FROM txm_bitx_staging.jopari_file_header_record_01 f JOIN txm_bitx_staging.jopari_bill_header_record_10 sb ON f.file_header_id = sb.file_header_id LEFT JOIN txm_bitx_staging.jopari_bill_provider_record_12 bp ON sb.bill_header_id = bp.bill_header_id WHERE f.file_header_id = <INPUT_FILE_HEADER_ID>"}