{"order_seq_no":1,"form_type":"CMS1500","table_type":"BILL_HEADER","df_read_table_name":"read_bill_header_vw","df_table_name":"bill_header_vw","db_table_name":"txm_bitx.bill_header","db_select_cols_list":"bill_id,bill_header_id,form_type","load_config_table_list":"","db_filter_id_col_name":"file_header_id","db_read_sql_select":"SELECT 'kofax' AS source, 'PROF' AS form_type,b.header_id AS file_header_id, b.cms_id AS bill_header_id, CASE WHEN b.invoice_number REGEXP '^[0-9]+$' THEN CAST(b.invoice_number AS UNSIGNED) ELSE NULL END AS txm_invoice_number, b.claim_number AS txm_claim_number, b.claim_number AS reported_claim_number, b.receive_date AS date_bill_received_by_payer, b.special_handling, b.signing_provider_date AS date_of_bill FROM txm_bitx_kofax_staging.kofax_cms1500 b WHERE b.header_id = <INPUT_FILE_HEADER_ID>","transform_sql_select":"SELECT * from read_bill_header_vw"}
{"order_seq_no":2,"form_type":"CMS1500","table_type":"BILL_DETAIL","df_read_table_name":"read_patient_vw","df_table_name":"patient_vw","db_table_name":"txm_bitx.patient","db_select_cols_list":"","load_config_table_list":"","db_filter_id_col_name":"","db_read_sql_select":"SELECT b.cms_id AS bill_header_id, (CONCAT_WS(', ', NULLIF(TRIM(COALESCE(b.patient_last_name, '')), ''), CASE WHEN TRIM(COALESCE(b.patient_middle_name, '')) <> '' THEN CONCAT(TRIM(COALESCE(b.patient_first_name, '')), ' ', TRIM(COALESCE(b.patient_middle_name, ''))) ELSE TRIM(COALESCE(b.patient_first_name, '')) END)) AS patient_name, b.patient_dob AS date_of_birth, b.patient_date_of_injury AS date_of_injury, b.patient_account_number FROM txm_bitx_kofax_staging.kofax_cms1500 b WHERE b.header_id = <INPUT_FILE_HEADER_ID>","transform_sql_select":"select h.bill_id, v.patient_name, v.date_of_birth, v.date_of_injury, v.patient_account_number FROM read_patient_vw v JOIN db_bill_header_vw h ON h.bill_header_id=v.bill_header_id AND h.form_type = 'PROF'"}
{"order_seq_no":3,"form_type":"CMS1500","table_type":"BILL_DETAIL","df_read_table_name":"read_provider_vw","df_table_name":"provider_vw","db_table_name":"txm_bitx.provider","db_select_cols_list":"","load_config_table_list":"","db_filter_id_col_name":"","db_read_sql_select":"SELECT DISTINCT k.cms_id AS bill_header_id, k.referring_provider_fullname AS referring_provider_name, k.referring_provider_other_id AS referring_provider_state_license,CAST(k.referrring_provider_npi AS CHAR) AS referring_provider_npi,CASE WHEN k.signing_provider_date = '0000-00-00' THEN NULL ELSE k.signing_provider_date END AS rendering_provider_date,CAST(k.vendor_npi AS CHAR) AS vendor_npi,k.vendor_other_id,CASE WHEN pp.provider_number IS NOT NULL THEN pp.provider_number ELSE CAST(k.provider_id AS CHAR) END AS provider_number,CASE WHEN pp.provider_number IS NOT NULL THEN pp.rendering_provider_name ELSE k.signing_provider_full_name  END AS rendering_provider_name,CASE WHEN pp.provider_number IS NOT NULL THEN pp.rendering_provider_npi ELSE CAST(l.national_provider_id AS CHAR) END AS rendering_provider_npi,CASE WHEN pp.provider_number IS NOT NULL THEN pp.rendering_provider_license ELSE l.other_id END AS rendering_provider_license,CASE WHEN pp.provider_number IS NOT NULL THEN pp.vendor_tax_id ELSE k.vendor_federal_employer_id_number END AS vendor_tax_id,CASE WHEN pp.provider_number IS NOT NULL THEN pp.vendor_number ELSE NULL END AS vendor_number,CASE WHEN pp.provider_number IS NOT NULL THEN pp.vendor_phone ELSE NULL END AS vendor_phone_number,CASE WHEN pp.provider_number IS NOT NULL THEN pp.vendor_name ELSE k.vendor_name END AS vendor_name,CASE WHEN pp.provider_number IS NOT NULL THEN pp.vendor_address1 ELSE k.vendor_address_1 END AS vendor_address_1,CASE WHEN pp.provider_number IS NOT NULL THEN pp.vendor_address2 ELSE k.vendor_address_2 END AS vendor_address_2,CASE WHEN pp.provider_number IS NOT NULL THEN pp.vendor_city ELSE k.vendor_city END AS vendor_city,CASE WHEN pp.provider_number IS NOT NULL THEN pp.vendor_state ELSE k.vendor_state END AS vendor_state,CASE WHEN pp.provider_number IS NOT NULL THEN pp.vendor_zip_code ELSE k.vendor_zip_code END AS vendor_zip_code,CASE WHEN pp.provider_number IS NOT NULL THEN pp.facility_name ELSE k.facility_name END AS facility_name,CASE WHEN pp.provider_number IS NOT NULL THEN pp.facility_npi ELSE CAST(k.facility_npi AS CHAR) END AS facility_npi,CASE WHEN pp.provider_number IS NOT NULL THEN pp.facility_address_1 ELSE k.facility_address_1 END AS facility_address_1,CASE WHEN pp.provider_number IS NOT NULL THEN pp.facility_address_2 ELSE k.facility_address_2 END AS facility_address_2,CASE WHEN pp.provider_number IS NOT NULL THEN pp.facility_city ELSE k.facility_city END AS facility_city,CASE WHEN pp.provider_number IS NOT NULL THEN pp.facility_state ELSE k.facility_state END AS facility_state,CASE WHEN pp.provider_number IS NOT NULL THEN pp.facility_zip_code ELSE k.facility_zip_code END AS facility_zip_code, k.facility_other_id,k.signing_provider_full_name,k.signing_provider_date,l.other_id AS rendering_provider_other_id FROM txm_bitx_kofax_staging.kofax_cms1500 k JOIN txm_bitx_kofax_staging.kofax_cms1500_line l ON k.cms_id = l.cms_id LEFT JOIN txm_bitx_provider.provider pp ON k.provider_id = pp.provider_number WHERE k.header_id = <INPUT_FILE_HEADER_ID>","transform_sql_select":"SELECT h.bill_id, v.referring_provider_name, v.referring_provider_state_license, v.referring_provider_npi, v.rendering_provider_license, v.rendering_provider_npi, v.rendering_provider_name, v.rendering_provider_date, v.facility_address_1, v.facility_address_2, v.facility_city, v.facility_state, v.facility_zip_code, v.facility_npi, v.vendor_name, v.vendor_address_1, v.vendor_address_2, v.vendor_city, v.vendor_state, v.vendor_zip_code,v.vendor_phone_number,v.vendor_number, v.vendor_tax_id, v.vendor_npi, v.vendor_other_id, v.facility_name, v.provider_number, v.facility_other_id, v.signing_provider_full_name, v.signing_provider_date, v.rendering_provider_other_id FROM read_provider_vw v JOIN db_bill_header_vw h ON h.bill_header_id=v.bill_header_id AND h.form_type = 'PROF'"}
{"order_seq_no":4,"form_type":"CMS1500","table_type":"BILL_DETAIL","df_read_table_name":"read_professional_treatment_vw","df_table_name":"professional_treatment_vw","db_table_name":"txm_bitx.professional_treatment","db_select_cols_list":"treatment_id,bill_id","load_config_table_list":"","db_filter_id_col_name":"file_header_id","db_read_sql_select":"SELECT b.cms_id AS bill_header_id, b.total_charge AS total_charges FROM txm_bitx_kofax_staging.kofax_cms1500 b WHERE b.header_id = <INPUT_FILE_HEADER_ID>","transform_sql_select":"SELECT h.bill_id AS bill_id, v.total_charges FROM read_professional_treatment_vw v JOIN db_bill_header_vw h ON h.bill_header_id = v.bill_header_id AND h.form_type = 'PROF'"}
{"order_seq_no":5,"form_type":"CMS1500","table_type":"LINE_DETAIL","df_read_table_name":"read_professional_treatment_line_vw","df_table_name":"professional_treatment_line_vw","db_table_name":"txm_bitx.professional_treatment_line","db_select_cols_list":"","load_config_table_list":"bitx_static_config.common_static_configuration,bitx_static_config.line_item_breakdown","db_filter_id_col_name":"","db_read_sql_select":"SELECT l.cms_id AS bill_header_id,l.cms_line_id as bill_detail_record_id, l.date_from AS service_date_from, l.date_to AS service_date_to, l.place_of_service_code AS place_of_service_code, l.cptor_hcpcs AS procedure_code, l.modifier_1 AS procedure_code_modifier_1, l.modifier_2 AS procedure_code_modifier_2, l.modifier_3 AS procedure_code_modifier_3, l.modifier_4 AS procedure_code_modifier_4, l.diagnosis_pointer_1 AS diagnosis_pointer_1, l.diagnosis_pointer_2 AS diagnosis_pointer_2, l.diagnosis_pointer_3 AS diagnosis_pointer_3, l.diagnosis_pointer_4 AS diagnosis_pointer_4, l.charges AS charges_for_services, CAST(l.days_or_units AS DECIMAL(6, 1)) AS units,l.sequence_number AS line_number FROM txm_bitx_kofax_staging.kofax_cms1500 b JOIN txm_bitx_kofax_staging.kofax_cms1500_line l ON b.cms_id = l.cms_id WHERE b.header_id = <INPUT_FILE_HEADER_ID>","transform_sql_select":"SELECT t.treatment_id, h.bill_id, v.service_date_from, v.service_date_to, v.place_of_service_code, v.procedure_code, v.procedure_code_modifier_1, v.procedure_code_modifier_2, v.procedure_code_modifier_3, v.procedure_code_modifier_4, v.diagnosis_pointer_1, v.diagnosis_pointer_2, v.diagnosis_pointer_3, v.diagnosis_pointer_4, v.charges_for_services, CASE WHEN li.anesthesia_code <> '' THEN v.units * CAST(af.attribute_value AS INT) * CAST(li.anesthesia_code AS INT) ELSE v.units END AS units, v.line_number FROM read_professional_treatment_line_vw v JOIN db_bill_header_vw h ON h.bill_header_id = v.bill_header_id AND h.form_type = 'PROF' JOIN db_professional_treatment_vw t ON t.bill_id = h.bill_id LEFT JOIN line_item_breakdown_vw li ON li.procedure_code <= v.procedure_code AND li.end_procedure_code >= v.procedure_code AND li.procedure_code_modifier <= IFNULL(v.procedure_code_modifier_1, '') AND li.end_procedure_code_modifier >= IFNULL(v.procedure_code_modifier_1, '') AND li.record_type = 'P' LEFT JOIN common_static_configuration_vw af ON af.attribute_name = 'Anesfac'"}
{"order_seq_no":6,"form_type":"CMS1500","table_type":"BILL_DETAIL","df_read_table_name":"read_billing_codes_vw","df_table_name":"billing_codes_vw","db_table_name":"txm_bitx.billing_codes","db_select_cols_list":"","load_config_table_list":"","db_filter_id_col_name":"","db_read_sql_select":"SELECT b.cms_id AS bill_header_id, CASE WHEN b.diagnosis_icd_indicator = '0' or b.diagnosis_icd_indicator = '' THEN 'ICD10' WHEN b.diagnosis_icd_indicator = '9' THEN 'ICD9' END AS diagnosis_code_qualifier_icd, 1 AS sequence_number, NULLIF(TRIM(diagnosis_code_A), '') AS diagnosis_code FROM txm_bitx_kofax_staging.kofax_cms1500 b WHERE b.header_id = <INPUT_FILE_HEADER_ID> UNION ALL SELECT b.cms_id AS bill_header_id, CASE WHEN b.diagnosis_icd_indicator = '0' or b.diagnosis_icd_indicator = '' THEN 'ICD10' WHEN b.diagnosis_icd_indicator = '9' THEN 'ICD9' END AS diagnosis_code_qualifier_icd, 2 AS sequence_number, NULLIF(TRIM(diagnosis_code_B), '') AS diagnosis_code FROM txm_bitx_kofax_staging.kofax_cms1500 b WHERE b.header_id = <INPUT_FILE_HEADER_ID> UNION ALL SELECT b.cms_id AS bill_header_id, CASE WHEN b.diagnosis_icd_indicator = '0' or b.diagnosis_icd_indicator = '' THEN 'ICD10' WHEN b.diagnosis_icd_indicator = '9' THEN 'ICD9' END AS diagnosis_code_qualifier_icd, 3 AS sequence_number, NULLIF(TRIM(diagnosis_code_C), '') AS diagnosis_code FROM txm_bitx_kofax_staging.kofax_cms1500 b WHERE b.header_id = <INPUT_FILE_HEADER_ID> UNION ALL SELECT b.cms_id AS bill_header_id, CASE WHEN b.diagnosis_icd_indicator = '0' or b.diagnosis_icd_indicator = '' THEN 'ICD10' WHEN b.diagnosis_icd_indicator = '9' THEN 'ICD9' END AS diagnosis_code_qualifier_icd, 4 AS sequence_number, NULLIF(TRIM(diagnosis_code_D), '') AS diagnosis_code FROM txm_bitx_kofax_staging.kofax_cms1500 b WHERE b.header_id = <INPUT_FILE_HEADER_ID> UNION ALL SELECT b.cms_id AS bill_header_id, CASE WHEN b.diagnosis_icd_indicator = '0' or b.diagnosis_icd_indicator = '' THEN 'ICD10' WHEN b.diagnosis_icd_indicator = '9' THEN 'ICD9' END AS diagnosis_code_qualifier_icd, 5 AS sequence_number, NULLIF(TRIM(diagnosis_code_E), '') AS diagnosis_code FROM txm_bitx_kofax_staging.kofax_cms1500 b WHERE b.header_id = <INPUT_FILE_HEADER_ID> UNION ALL SELECT b.cms_id AS bill_header_id, CASE WHEN b.diagnosis_icd_indicator = '0' or b.diagnosis_icd_indicator = '' THEN 'ICD10' WHEN b.diagnosis_icd_indicator = '9' THEN 'ICD9' END AS diagnosis_code_qualifier_icd, 6 AS sequence_number, NULLIF(TRIM(diagnosis_code_F), '') AS diagnosis_code FROM txm_bitx_kofax_staging.kofax_cms1500 b WHERE b.header_id = <INPUT_FILE_HEADER_ID> UNION ALL SELECT b.cms_id AS bill_header_id, CASE WHEN b.diagnosis_icd_indicator = '0' or b.diagnosis_icd_indicator = '' THEN 'ICD10' WHEN b.diagnosis_icd_indicator = '9' THEN 'ICD9' END AS diagnosis_code_qualifier_icd, 7 AS sequence_number, NULLIF(TRIM(diagnosis_code_G), '') AS diagnosis_code FROM txm_bitx_kofax_staging.kofax_cms1500 b WHERE b.header_id = <INPUT_FILE_HEADER_ID> UNION ALL SELECT b.cms_id AS bill_header_id, CASE WHEN b.diagnosis_icd_indicator = '0' or b.diagnosis_icd_indicator = '' THEN 'ICD10' WHEN b.diagnosis_icd_indicator = '9' THEN 'ICD9' END AS diagnosis_code_qualifier_icd, 8 AS sequence_number, NULLIF(TRIM(diagnosis_code_H), '') AS diagnosis_code FROM txm_bitx_kofax_staging.kofax_cms1500 b WHERE b.header_id = <INPUT_FILE_HEADER_ID> UNION ALL SELECT b.cms_id AS bill_header_id, CASE WHEN b.diagnosis_icd_indicator = '0' or b.diagnosis_icd_indicator = '' THEN 'ICD10' WHEN b.diagnosis_icd_indicator = '9' THEN 'ICD9' END AS diagnosis_code_qualifier_icd, 9 AS sequence_number, NULLIF(TRIM(diagnosis_code_I), '') AS diagnosis_code FROM txm_bitx_kofax_staging.kofax_cms1500 b WHERE b.header_id = <INPUT_FILE_HEADER_ID> UNION ALL SELECT b.cms_id AS bill_header_id, CASE WHEN b.diagnosis_icd_indicator = '0' or b.diagnosis_icd_indicator = '' THEN 'ICD10' WHEN b.diagnosis_icd_indicator = '9' THEN 'ICD9' END AS diagnosis_code_qualifier_icd, 10 AS sequence_number, NULLIF(TRIM(diagnosis_code_J), '') AS diagnosis_code FROM txm_bitx_kofax_staging.kofax_cms1500 b WHERE b.header_id = <INPUT_FILE_HEADER_ID> UNION ALL SELECT b.cms_id AS bill_header_id, CASE WHEN b.diagnosis_icd_indicator = '0' or b.diagnosis_icd_indicator = '' THEN 'ICD10' WHEN b.diagnosis_icd_indicator = '9' THEN 'ICD9' END AS diagnosis_code_qualifier_icd, 11 AS sequence_number, NULLIF(TRIM(diagnosis_code_K), '') AS diagnosis_code FROM txm_bitx_kofax_staging.kofax_cms1500 b WHERE b.header_id = <INPUT_FILE_HEADER_ID> UNION ALL SELECT b.cms_id AS bill_header_id, CASE WHEN b.diagnosis_icd_indicator = '0' or b.diagnosis_icd_indicator = '' THEN 'ICD10' WHEN b.diagnosis_icd_indicator = '9' THEN 'ICD9' END AS diagnosis_code_qualifier_icd, 12 AS sequence_number, NULLIF(TRIM(diagnosis_code_L), '') AS diagnosis_code FROM txm_bitx_kofax_staging.kofax_cms1500 b WHERE b.header_id = <INPUT_FILE_HEADER_ID>","transform_sql_select":"SELECT h.bill_id, 'DIAGNOSTIC' AS code_type, v.sequence_number, v.diagnosis_code_qualifier_icd, v.diagnosis_code FROM read_billing_codes_vw v JOIN db_bill_header_vw h ON h.bill_header_id = v.bill_header_id AND h.form_type = 'PROF'"}
{"order_seq_no":7,"form_type":"CMS1500","table_type":"BILL_DETAIL","df_read_table_name":"read_billing_documents_vw","df_table_name":"billing_documents_vw","db_table_name":"txm_bitx.billing_documents","db_select_cols_list":"","load_config_table_list":"","load_config_table_list":"","db_filter_id_col_name":"","db_read_sql_select":"SELECT b.cms_id AS bill_header_id, a.document_item_type AS txm_doc_type, a.serial_number AS document_serial_number FROM txm_bitx_kofax_staging.kofax_cms1500 b JOIN txm_bitx_kofax_staging.kofax_cms1500_attachments a ON b.cms_id = a.cms_id WHERE b.header_id = <INPUT_FILE_HEADER_ID>","transform_sql_select":"SELECT h.bill_id,d.txm_doc_type,d.document_serial_number FROM read_billing_documents_vw d JOIN db_bill_header_vw h ON h.bill_header_id=d.bill_header_id AND h.form_type = 'PROF'"}