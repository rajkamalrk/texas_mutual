{"order_seq_no":1,"form_type":"DWC066","table_type":"BILL_HEADER","df_read_table_name":"read_bill_header_vw","df_table_name":"bill_header_vw","db_table_name":"txm_bitx.bill_header","db_select_cols_list":"bill_id,bill_header_id,form_type","load_config_table_list":"","db_filter_id_col_name":"file_header_id","db_read_sql_select":"SELECT 'kofax' AS source,'RX' AS form_type,b.header_id AS file_header_id,b.dwc_id AS bill_header_id,CASE WHEN b.invoice_number REGEXP '^[0-9]+$' THEN CAST(b.invoice_number AS UNSIGNED) ELSE NULL  END AS txm_invoice_number,b.invoice_date AS date_of_bill,b.claim_number AS txm_claim_number,b.claim_number AS reported_claim_number,b.receive_date AS date_bill_received_by_payer,b.special_handling FROM txm_bitx_kofax_staging.kofax_dwc066 b WHERE b.header_id = <INPUT_FILE_HEADER_ID>","transform_sql_select":"SELECT * from read_bill_header_vw"}
{"order_seq_no":2,"form_type":"DWC066","table_type":"BILL_DETAIL","df_read_table_name":"read_patient_vw","df_table_name":"patient_vw","db_table_name":"txm_bitx.patient","db_select_cols_list":"","load_config_table_list":"","db_filter_id_col_name":"","db_read_sql_select":"SELECT b.dwc_id AS bill_header_id,(CONCAT_WS(', ',NULLIF(TRIM(COALESCE(b.patient_last_name, '')), ''),CASE WHEN TRIM(COALESCE(b.patient_middle_name, '')) <> '' THEN CONCAT(TRIM(COALESCE(b.patient_first_name, '')), ' ', TRIM(COALESCE(b.patient_middle_name, ''))) ELSE TRIM(COALESCE(b.patient_first_name, '')) END)) AS patient_name,b.patient_date_of_injury AS date_of_injury,b.patient_dob AS date_of_birth FROM txm_bitx_kofax_staging.kofax_dwc066 b WHERE b.header_id = <INPUT_FILE_HEADER_ID>","transform_sql_select":"select h.bill_id, v.patient_name,v.date_of_injury,v.date_of_birth FROM read_patient_vw v JOIN db_bill_header_vw h ON h.bill_header_id=v.bill_header_id AND h.form_type = 'RX'"}
{"order_seq_no":3,"form_type":"DWC066","table_type":"BILL_DETAIL","df_read_table_name":"read_provider_vw","df_table_name":"provider_vw","db_table_name":"txm_bitx.provider","db_select_cols_list":"","load_config_table_list":"","db_filter_id_col_name":"","db_read_sql_select":"SELECT k.dwc_id AS bill_header_id, TRIM(CONCAT(COALESCE(k.prescribingdoctor_lastname, ''),CASE WHEN k.prescribingdoctor_lastname IS NOT NULL AND k.prescribingdoctor_firstname IS NOT NULL THEN ', ' ELSE '' END, COALESCE(k.prescribingdoctor_firstname, ''))) AS referring_provider_name,CAST(k.prescribingdoctor_nationalproviderid AS CHAR) AS referring_provider_npi,CASE WHEN pp.provider_number IS NOT NULL THEN pp.provider_number ELSE CAST(k.provider_id AS CHAR) END AS provider_number,CASE WHEN pp.provider_number IS NOT NULL THEN pp.rendering_provider_name ELSE k.facility_name END AS rendering_provider_name,CASE WHEN pp.provider_number IS NOT NULL THEN pp.rendering_provider_npi ELSE CAST(k.facility_npi AS CHAR) END AS rendering_provider_npi,CASE WHEN pp.provider_number IS NOT NULL THEN pp.rendering_provider_license ELSE NULL END AS rendering_provider_license,CASE WHEN pp.provider_number IS NOT NULL THEN pp.vendor_phone ELSE NULL END AS vendor_phone_number,CASE WHEN pp.provider_number IS NOT NULL THEN pp.vendor_tax_id ELSE k.vendor_federal_employer_id_number END AS vendor_tax_id,CASE WHEN pp.provider_number IS NOT NULL THEN pp.vendor_number ELSE NULL END AS vendor_number,CASE WHEN pp.provider_number IS NOT NULL THEN pp.vendor_name ELSE k.vendor_name END AS vendor_name,CASE WHEN pp.provider_number IS NOT NULL THEN pp.vendor_address1 ELSE k.vendor_address_1 END AS vendor_address_1,CASE WHEN pp.provider_number IS NOT NULL THEN pp.vendor_address2 ELSE k.vendor_address_2 END AS vendor_address_2,CASE WHEN pp.provider_number IS NOT NULL THEN pp.vendor_city ELSE k.vendor_city END AS vendor_city,CASE WHEN pp.provider_number IS NOT NULL THEN pp.vendor_state ELSE k.vendor_state END AS vendor_state,CASE WHEN pp.provider_number IS NOT NULL THEN pp.vendor_zip_code ELSE k.vendor_zip_code END AS vendor_zip_code,CASE WHEN pp.provider_number IS NOT NULL THEN pp.facility_name ELSE k.facility_name END AS facility_name, CASE WHEN pp.provider_number IS NOT NULL THEN pp.facility_npi ELSE CAST(k.facility_npi AS CHAR) END AS facility_npi,CASE WHEN pp.provider_number IS NOT NULL THEN pp.facility_address_1 ELSE k.facility_address_1 END AS facility_address_1,CASE WHEN pp.provider_number IS NOT NULL THEN pp.facility_address_2 ELSE k.facility_address_2 END AS facility_address_2,CASE WHEN pp.provider_number IS NOT NULL THEN pp.facility_city ELSE k.facility_city END AS facility_city,CASE WHEN pp.provider_number IS NOT NULL THEN pp.facility_state ELSE k.facility_state END AS facility_state,CASE WHEN pp.provider_number IS NOT NULL THEN pp.facility_zip_code ELSE k.facility_zip_code END AS facility_zip_code FROM txm_bitx_kofax_staging.kofax_dwc066 k LEFT JOIN txm_bitx_provider.provider pp ON k.provider_id = pp.provider_number WHERE k.header_id = <INPUT_FILE_HEADER_ID>","transform_sql_select":"SELECT h.bill_id,v.rendering_provider_name,v.facility_name,v.facility_address_1,v.facility_address_2,v.facility_city,v.facility_state,v.facility_zip_code,v.rendering_provider_npi,v.vendor_name,v.vendor_address_1,v.vendor_address_2,v.vendor_city,v.vendor_state,v.vendor_zip_code,v.vendor_tax_id,v.rendering_provider_license,v.vendor_phone_number,v.vendor_number,v.referring_provider_name,v.referring_provider_npi,v.provider_number FROM read_provider_vw v JOIN db_bill_header_vw h ON h.bill_header_id=v.bill_header_id AND h.form_type = 'RX'"}
{"order_seq_no":4,"form_type":"DWC066","table_type":"PHARMACY_LINE","df_read_table_name":"read_pharmacy_line_vw","df_table_name":"pharmacy_line_vw","db_table_name":"txm_bitx.pharmacy_line","db_select_cols_list":"","load_config_table_list":"","db_filter_id_col_name":"","db_read_sql_select":"SELECT b.dwc_id AS bill_header_id,l.dispensed_aswritten_code AS dispensed_as_written_code,CASE WHEN l.date_filled = '0000-00-00' THEN NULL ELSE l.date_filled END AS prescription_date,l.generic_ndc AS ndc_code,l.name_brand_ndc,l.quantity,l.days_supply,l.drugname_and_strength AS drug_name,l.prescription_number,l.amount_billed AS total_charge_per_bill,l.sequence_number AS line_number, l.date_filled AS service_from_date, l.date_filled AS service_thru_date FROM txm_bitx_kofax_staging.kofax_dwc066 b JOIN txm_bitx_kofax_staging.kofax_dwc066_line l ON b.dwc_id=l.dwc_id WHERE b.header_id = <INPUT_FILE_HEADER_ID>","transform_sql_select":"SELECT h.bill_id,v.dispensed_as_written_code,v.prescription_date,v.ndc_code,v.name_brand_ndc,v.quantity,v.days_supply,v.drug_name,v.prescription_number,v.total_charge_per_bill,v.line_number, v.service_from_date, v.service_thru_date FROM read_pharmacy_line_vw v JOIN db_bill_header_vw h on h.bill_header_id=v.bill_header_id AND h.form_type = 'RX'"}
{"order_seq_no":5,"form_type":"DWC066","table_type":"BILL_DETAIL","df_read_table_name":"read_billing_documents_vw","df_table_name":"billing_documents_vw","db_table_name":"txm_bitx.billing_documents","db_select_cols_list":"","load_config_table_list":"","db_filter_id_col_name":"","db_read_sql_select":"SELECT b.dwc_id AS bill_header_id,a.document_item_type AS txm_doc_type,a.serial_number AS document_serial_number FROM txm_bitx_kofax_staging.kofax_dwc066 b JOIN txm_bitx_kofax_staging.kofax_dwc066_attachments a ON b.dwc_id = a.dwc_id WHERE b.header_id = <INPUT_FILE_HEADER_ID>","transform_sql_select":"SELECT h.bill_id,d.txm_doc_type,d.document_serial_number FROM read_billing_documents_vw d JOIN db_bill_header_vw h ON h.bill_header_id=d.bill_header_id AND h.form_type = 'RX'"}