{"order_seq_no":1,"form_type":"CMS1500","table_type":"BILL_HEADER","df_read_table_name": "read_bill_header_vw","df_table_name": "bill_header_vw","db_table_name": "txm_bitx.bill_header","db_select_cols_list": "bill_id,bill_header_id","load_config_table_list":"","db_filter_id_col_name": "file_header_id","db_read_sql_select": "SELECT DISTINCT 'jopari' AS trading_partner,b.bill_header_id,b.file_header_id,CASE WHEN b.indexed_claim_num <> '' AND b.indexed_claim_num IS NOT NULL THEN b.indexed_claim_num ELSE b.reported_claim_num END AS reported_claim_number,CASE WHEN s.priority='P' THEN s.treatment_authorization_num END AS authorization_code,b.bill_form_type AS form_type,b.unique_bill_id,b.facility_code,b.bill_frequency_type_code,b.contract_type_code,b.date_bill_received_by_payer,b.bill_class_code,b.bill_submission_reason_code AS resubmission_code, b.original_reference_num AS original_reference_number, b.billing_prov_unique_bill_id AS document_control_number, b.provider_signature_on_file_ind AS provider_signature_indicator,b.date_of_bill AS date_of_bill FROM txm_bitx_staging.jopari_bill_header_record_10 b LEFT JOIN txm_bitx_staging.jopari_subscriber_record_13 s ON b.bill_header_id=s.bill_header_id WHERE b.file_header_id=<INPUT_FILE_HEADER_ID> AND b.bill_form_type = 'PROF'","transform_sql_select": "SELECT * FROM read_bill_header_vw"}
{"order_seq_no":2,"form_type":"CMS1500","table_type":"BILL_DETAIL","df_read_table_name":"read_patient_vw","df_table_name":"patient_vw","db_table_name":"txm_bitx.patient","db_select_cols_list":"bill_id","load_config_table_list":"","db_filter_id_col_name":"bill_id","db_read_sql_select":"SELECT b.bill_header_id,CASE WHEN b.patient_middle_name IS NOT NULL AND b.patient_middle_name <> '' THEN CONCAT(b.patient_last_name, ',', b.patient_first_name, ' ', LEFT(b.patient_middle_name, 1)) ELSE CONCAT(b.patient_last_name, ', ', b.patient_first_name) END AS patient_name,b.patient_dob AS date_of_birth,b.patient_gender_code AS patient_gender,b.patient_address1 AS patient_address_line_1,b.patient_address2 AS patient_address_line_2,b.patient_city,b.patient_state_code,b.patient_postal_code AS zip_code,b.patient_country_code,CASE WHEN b.patient_phone_num <> '' THEN SUBSTRING(REGEXP_REPLACE(b.patient_phone_num, '[^0-9]', ''), 1, 7) END AS patient_phone_number,CASE WHEN s.priority = 'P' AND s.patient_relationship_to_subscriber = '20' THEN 'S' WHEN s.priority = 'P' AND s.patient_relationship_to_subscriber <> '20' THEN 'O' END AS patient_relationship_to_insured,b.patient_SSN AS social_security_number,b.accident_cause2 AS automobile_accident,b.accident_cause3 AS other_accident,b.accident_state,b.date_of_injury,b.provider_accepts_assignment AS accept_assignment_indicator,b.patient_account_num AS patient_account_number,CASE WHEN b.patient_marital_status_code = 'U' THEN '1' WHEN b.patient_marital_status_code = 'M' THEN '2' WHEN b.patient_marital_status_code = 'D' THEN '3' WHEN b.patient_marital_status_code = 'W' THEN '1' WHEN b.patient_marital_status_code = 'R' THEN '4' ELSE '6' END AS patient_marital_status_code,b.patient_medical_record_num AS patient_medical_record_number FROM txm_bitx_staging.jopari_bill_header_record_10 b LEFT JOIN txm_bitx_staging.jopari_subscriber_record_13 s ON b.bill_header_id = s.bill_header_id WHERE b.file_header_id = <INPUT_FILE_HEADER_ID> AND b.bill_form_type = 'PROF'","transform_sql_select":"SELECT h.bill_id,v.patient_name,v.date_of_birth,v.patient_gender,v.patient_address_line_1,v.patient_address_line_2,v.patient_city,v.patient_state_code,v.zip_code,v.patient_country_code,v.patient_phone_number,v.patient_relationship_to_insured,v.automobile_accident,v.other_accident,accident_state,v.date_of_injury,v.accept_assignment_indicator,v.patient_account_number,v.patient_marital_status_code,v.patient_medical_record_number,v.social_security_number FROM read_patient_vw v JOIN db_bill_header_vw h ON h.bill_header_id=v.bill_header_id"}
{"order_seq_no":3,"form_type":"CMS1500","table_type":"BILL_DETAIL","df_read_table_name":"read_subscriber_vw","df_table_name":"subscriber_vw","db_table_name":"txm_bitx.subscriber","db_select_cols_list":"bill_id","load_config_table_list":"","db_filter_id_col_name":"bill_id","db_read_sql_select":"SELECT b.bill_header_id, s.priority, CASE WHEN s.subscriber_middle_name IS NOT NULL AND s.subscriber_middle_name <> '' AND s.subscriber_first_name IS NOT NULL AND s.subscriber_first_name <> '' THEN CONCAT(s.subscriber_last_name, ',', s.subscriber_first_name, ' ', LEFT(s.subscriber_middle_name, 1)) WHEN s.subscriber_first_name IS NOT NULL AND s.subscriber_first_name <> '' THEN CONCAT(s.subscriber_last_name, ', ', s.subscriber_first_name) ELSE s.subscriber_last_name END AS subscriber_name, s.subscriber_address1 AS subscriber_address_line_1, s.subscriber_address2 AS subscriber_address_line_2, s.subscriber_city, s.subscriber_state_code AS subscriber_state, s.subscriber_postal_code AS zip_code, s.subscriber_country_code, CASE WHEN s.subscriber_phone_num <> '' THEN SUBSTRING(REGEXP_REPLACE(s.subscriber_phone_num, '[^0-9]', ''), 1, 7) END AS subscriber_telephone_number, s.date_of_birth, s.gender_code AS subscriber_gender, CASE WHEN s.priority = 'P' AND TRIM(NULLIF(s.tin, '')) <> '' AND s.tin IS NOT NULL THEN TRIM(s.tin) ELSE NULL END AS subscriber_tax_id, s.sender_payer_id AS sender_payer_id, s.total_estimated_amount_due, CASE WHEN CHAR_LENGTH(TRIM(s.member_id)) = 9 AND TRIM(s.member_id) REGEXP '^[0-9]+$' THEN TRIM(member_id) ELSE NULL END AS insured_id_number FROM txm_bitx_staging.jopari_bill_header_record_10 b JOIN txm_bitx_staging.jopari_subscriber_record_13 s ON b.bill_header_id = s.bill_header_id WHERE b.file_header_id = <INPUT_FILE_HEADER_ID> AND b.bill_form_type = 'PROF'","transform_sql_select":"SELECT h.bill_id,v.subscriber_name,v.subscriber_address_line_1,v.subscriber_address_line_2,v.subscriber_city,v.subscriber_state,v.zip_code,v.subscriber_country_code,v.subscriber_telephone_number,v.date_of_birth,v.subscriber_gender,v.subscriber_tax_id,v.sender_payer_id,v.total_estimated_amount_due,v.insured_id_number FROM read_subscriber_vw v JOIN db_bill_header_vw h ON h.bill_header_id=v.bill_header_id"}
{"order_seq_no":4,"form_type":"CMS1500","table_type":"BILL_DETAIL","df_read_table_name":"read_provider_vw","df_table_name":"provider_vw","db_table_name":"txm_bitx.provider","db_select_cols_list":"bill_id","load_config_table_list":"","db_filter_id_col_name":"bill_id","db_read_sql_select":"WITH provider_record_20 AS (SELECT p20.*, ROW_NUMBER() OVER(PARTITION BY tb.bill_header_id, p20.physician_code ORDER BY p20.provider_record_id) rno FROM txm_bitx_staging.jopari_bill_header_record_10 tb LEFT JOIN txm_bitx_staging.jopari_provider_record_20 p20 ON tb.bill_header_id = p20.bill_header_id WHERE tb.file_header_id = <INPUT_FILE_HEADER_ID> AND tb.bill_form_type = 'PROF'), provider_record_60 AS (SELECT p60.*, ROW_NUMBER() OVER(PARTITION BY tb.bill_header_id, p60.physician_code ORDER BY p60.line_number, p60.line_level_physician_record_id) rno FROM txm_bitx_staging.jopari_bill_header_record_10 tb LEFT JOIN txm_bitx_staging.jopari_line_level_physician_record_60 p60 ON tb.bill_header_id = p60.bill_header_id WHERE tb.file_header_id = <INPUT_FILE_HEADER_ID> AND tb.bill_form_type = 'PROF') SELECT DISTINCT b.bill_header_id, b.bill_form_type, CASE WHEN p60_ren.line_level_physician_record_id IS NOT NULL THEN '60_82' ELSE '20_82' END AS rendering_record_type_physician_code, CASE WHEN p60_ren.line_level_physician_record_id IS NOT NULL THEN p60_ren.provider_last_name ELSE p20_ren.last_name END AS rendering_provider_last_name, CASE WHEN p60_ren.line_level_physician_record_id IS NOT NULL THEN p60_ren.provider_first_name ELSE p20_ren.first_name END AS rendering_provider_first_name, CASE WHEN p60_ren.line_level_physician_record_id IS NOT NULL THEN p60_ren.provider_middle_name ELSE p20_ren.middle_name END AS rendering_provider_middle_name, CASE WHEN p60_ren.line_level_physician_record_id IS NOT NULL THEN p60_ren.provider_state_license ELSE p20_ren.state_license END AS rendering_provider_license, CASE WHEN p60_ren.line_level_physician_record_id IS NOT NULL THEN p60_ren.provider_npi ELSE p20_ren.npi END AS rendering_provider_npi, CASE WHEN p60_ren.line_level_physician_record_id IS NOT NULL THEN p60_ren.provider_nabp ELSE p20_ren.nabp END AS rendering_provider_nabp, CASE WHEN p60_ren.line_level_physician_record_id IS NOT NULL THEN p60_ren.provider_dea_number ELSE p20_ren.dea_number END AS rendering_provider_dea_number, CASE WHEN p60_ren.line_level_physician_record_id IS NOT NULL THEN p60_ren.provider_taxonomy_code ELSE p20_ren.taxonomy_code END AS rendering_provider_taxonomy_code, CASE WHEN p20_ref.provider_record_id IS NOT NULL THEN '20_DN' ELSE '60_DK' END AS referring_record_type_physician_code, CASE WHEN p20_ref.provider_record_id IS NOT NULL THEN p20_ref.last_name ELSE p60_ref.provider_last_name END AS referring_provider_last_name, CASE WHEN p20_ref.provider_record_id IS NOT NULL THEN p20_ref.first_name ELSE p60_ref.provider_first_name END AS referring_provider_first_name, CASE WHEN p20_ref.provider_record_id IS NOT NULL THEN p20_ref.middle_name ELSE p60_ref.provider_middle_name END AS referring_provider_middle_name, CASE WHEN p20_ref.provider_record_id IS NOT NULL THEN p20_ref.state_license ELSE p60_ref.provider_state_license END AS referring_provider_state_license, CASE WHEN p20_ref.provider_record_id IS NOT NULL THEN p20_ref.npi ELSE p60_ref.provider_npi END AS referring_provider_npi, CASE WHEN p20_ref.provider_record_id IS NOT NULL THEN p20_ref.nabp ELSE p60_ref.provider_nabp END AS referring_provider_nabp, CASE WHEN p20_ref.provider_record_id IS NOT NULL THEN p20_ref.dea_number ELSE p60_ref.provider_dea_number END AS referring_provider_dea_number, CASE WHEN p20_ref.provider_record_id IS NOT NULL THEN p20_ref.taxonomy_code ELSE p60_ref.provider_taxonomy_code END AS referring_provider_taxonomy_code, p.service_facility_name AS facility_name, p.service_facility_address1 AS facility_address_1, p.service_facility_address2 AS facility_address_2, p.service_facility_city AS facility_city, p.service_facility_state AS facility_state, p.service_facility_zip_code AS facility_zip_code, p.service_facility_provider_NPI AS facility_npi, p.pay_to_provider_name, p.billing_provider_name, p.billing_provider_address1, p.pay_to_provider_address1, p.pay_to_provider_address2, p.billing_provider_address2, p.pay_to_provider_city, p.billing_provider_city, p.pay_to_provider_state, p.billing_provider_state, p.billing_zip_code, p.pay_to_zip_code, p.pay_to_provider_tax_id, p.Pay_to_provider_NPI, p.billing_provider_NPI, p.pay_to_provider_state_license, p.billing_provider_state_license, p.service_facility_provider_state_license AS facility_other_id, CASE WHEN p.pay_to_provider_name IS NOT NULL AND p.pay_to_provider_name <> '' AND p.pay_to_provider_address1 IS NOT NULL AND p.pay_to_provider_address1 <> '' AND p.pay_to_provider_city IS NOT NULL AND p.pay_to_provider_city <> '' AND p.pay_to_provider_state IS NOT NULL AND p.pay_to_provider_state <> '' AND p.pay_to_zip_code IS NOT NULL AND p.pay_to_zip_code <> '' AND p.pay_to_provider_tax_id IS NOT NULL AND p.pay_to_provider_tax_id <> '' THEN p.pay_to_provider_tax_id ELSE p.billing_provider_tax_id END AS vendor_tax_id, p20_ope.first_name AS operating_provider_first_name, p20_ope.last_name AS operating_provider_last_name, p20_ope.npi AS operating_provider_national_provider_id, p20_ope.state_license AS operating_provider_other_id, p20_att.first_name AS attending_provider_first_name, p20_att.last_name AS attending_provider_last_name, p20_att.npi AS attending_provider_national_provider_id, p20_att.state_license AS attending_provider_other_id FROM txm_bitx_staging.jopari_bill_header_record_10 b JOIN txm_bitx_staging.jopari_bill_provider_record_12 p ON b.bill_header_id = p.bill_header_id LEFT JOIN provider_record_20 p20_ren ON b.bill_header_id = p20_ren.bill_header_id AND p20_ren.physician_code = '82' AND p20_ren.rno = 1 LEFT JOIN provider_record_60 p60_ren ON b.bill_header_id = p60_ren.bill_header_id AND p60_ren.physician_code = '82' AND p60_ren.rno = 1 LEFT JOIN provider_record_20 p20_ref ON b.bill_header_id = p20_ref.bill_header_id AND p20_ref.physician_code = 'DN' AND p20_ref.rno = 1 LEFT JOIN provider_record_60 p60_ref ON b.bill_header_id = p60_ref.bill_header_id AND p60_ref.physician_code = 'DK' AND p60_ref.rno = 1 LEFT JOIN provider_record_20 p20_ope ON b.bill_header_id = p20_ope.bill_header_id AND p20_ope.physician_code = '72' AND p20_ope.rno = 1 LEFT JOIN provider_record_20 p20_att ON b.bill_header_id = p20_att.bill_header_id AND p20_att.physician_code = '71' AND p20_att.rno = 1  WHERE b.file_header_id = <INPUT_FILE_HEADER_ID> AND b.bill_form_type = 'PROF'","transform_sql_select":"SELECT h.bill_id,get_provider_name_udf(v.rendering_provider_last_name, v.rendering_provider_first_name, v.rendering_provider_middle_name, '') AS rendering_provider_name,v.rendering_record_type_physician_code,v.rendering_provider_license, v.rendering_provider_npi,v.rendering_provider_dea_number,v.rendering_provider_nabp,v.rendering_provider_taxonomy_code,get_provider_name_udf(v.referring_provider_last_name, v.referring_provider_first_name, v.referring_provider_middle_name, '') AS referring_provider_name,v.referring_record_type_physician_code,v.referring_provider_state_license,v.referring_provider_npi,v.referring_provider_dea_number,v.referring_provider_nabp,v.referring_provider_taxonomy_code,v.facility_name,v.facility_address_1,v.facility_address_2,v.facility_city,v.facility_state,v.facility_zip_code,v.facility_npi,CASE WHEN notNull_notEmpty_udf(v.pay_to_provider_name,v.pay_to_provider_address1, v.pay_to_provider_city ,v.pay_to_provider_state ,v.pay_to_zip_code, v.pay_to_provider_tax_id ) THEN '12_pay_to' ELSE '12_billing_to' END AS vendor_record_type_physician_code,CASE WHEN notNull_notEmpty_udf(v.pay_to_provider_name,v.pay_to_provider_address1, v.pay_to_provider_city ,v.pay_to_provider_state ,v.pay_to_zip_code, v.pay_to_provider_tax_id ) THEN v.pay_to_provider_name ELSE v.billing_provider_name END AS vendor_name,CASE WHEN notNull_notEmpty_udf(v.pay_to_provider_name,v.pay_to_provider_address1, v.pay_to_provider_city ,v.pay_to_provider_state ,v.pay_to_zip_code, v.pay_to_provider_tax_id ) THEN v.pay_to_provider_address1 ELSE v.billing_provider_address1 END AS vendor_address_1,CASE WHEN notNull_notEmpty_udf(v.pay_to_provider_name,v.pay_to_provider_address1, v.pay_to_provider_city ,v.pay_to_provider_state ,v.pay_to_zip_code, v.pay_to_provider_tax_id ) THEN v.pay_to_provider_address2 ELSE v.billing_provider_address2 END AS vendor_address_2,CASE WHEN notNull_notEmpty_udf(v.pay_to_provider_name,v.pay_to_provider_address1, v.pay_to_provider_city ,v.pay_to_provider_state ,v.pay_to_zip_code, v.pay_to_provider_tax_id ) THEN v.pay_to_provider_city ELSE v.billing_provider_city END AS vendor_city,CASE WHEN notNull_notEmpty_udf(v.pay_to_provider_name,v.pay_to_provider_address1, v.pay_to_provider_city ,v.pay_to_provider_state ,v.pay_to_zip_code, v.pay_to_provider_tax_id ) THEN v.pay_to_provider_state ELSE v.billing_provider_state END AS vendor_state,CASE WHEN notNull_notEmpty_udf(v.pay_to_provider_name,v.pay_to_provider_address1, v.pay_to_provider_city ,v.pay_to_provider_state ,v.pay_to_zip_code, v.pay_to_provider_tax_id ) THEN v.pay_to_zip_code ELSE v.billing_zip_code END AS vendor_zip_code, CASE WHEN notNull_notEmpty_udf(v.pay_to_provider_name,v.pay_to_provider_address1, v.pay_to_provider_city ,v.pay_to_provider_state ,v.pay_to_zip_code, v.pay_to_provider_tax_id ) THEN v.Pay_to_provider_NPI ELSE v.billing_provider_NPI END AS vendor_npi,CASE WHEN notNull_notEmpty_udf(v.pay_to_provider_name,v.pay_to_provider_address1, v.pay_to_provider_city ,v.pay_to_provider_state ,v.pay_to_zip_code, v.pay_to_provider_tax_id ) THEN v.pay_to_provider_state_license ELSE v.billing_provider_state_license END AS vendor_other_id,v.facility_other_id,v.vendor_tax_id, v.operating_provider_first_name, v.operating_provider_last_name, v.operating_provider_national_provider_id, v.operating_provider_other_id, v.attending_provider_first_name, v.attending_provider_last_name, v.attending_provider_national_provider_id, v.attending_provider_other_id FROM read_provider_vw v JOIN db_bill_header_vw h where h.bill_header_id=v.bill_header_id"}
{"order_seq_no":5,"form_type":"CMS1500","table_type":"BILL_DETAIL","df_read_table_name":"read_professional_treatment_vw","df_table_name":"professional_treatment_vw","db_table_name":"txm_bitx.professional_treatment","db_select_cols_list":"treatment_id,bill_id","load_config_table_list":"","db_filter_id_col_name":"file_header_id","db_read_sql_select":"SELECT b.bill_header_id, b.date_of_onset_similar_symptoms AS other_treatment_date, b.disability_begin_date AS date_unable_to_work_from, b.diability_end_date AS date_unable_to_work_to, b.from_service_bill_date AS from_service_date, b.thru_service_bill_date AS thru_service_date, b.outside_lab_charges, CASE WHEN s.priority = 'P' THEN s.total_estimated_amount_due ELSE b.total_charge_per_bill END AS total_charges, CASE WHEN s.priority = 'P' THEN s.total_prior_payment END AS amount_paid, b.accident_cause2 AS external_cause_of_injury_2, b.accident_cause3 AS external_cause_of_injury_3, b.accident_state AS external_cause_of_injury FROM txm_bitx_staging.jopari_bill_header_record_10 b LEFT JOIN txm_bitx_staging.jopari_subscriber_record_13 s ON b.bill_header_id = s.bill_header_id WHERE b.file_header_id = <INPUT_FILE_HEADER_ID> AND b.bill_form_type = 'PROF'","transform_sql_select":"SELECT h.bill_id, v.other_treatment_date, v.date_unable_to_work_from, v.date_unable_to_work_to, v.from_service_date, v.thru_service_date, v.outside_lab_charges, v.total_charges, v.amount_paid, v.external_cause_of_injury_2, v.external_cause_of_injury_3, v.external_cause_of_injury FROM read_professional_treatment_vw v JOIN db_bill_header_vw h ON h.bill_header_id = v.bill_header_id"}
{"order_seq_no":6,"form_type":"CMS1500","table_type":"LINE_DETAIL","df_read_table_name":"read_professional_treatment_line_vw","df_table_name":"professional_treatment_line_vw","db_table_name":"txm_bitx.professional_treatment_line","db_select_cols_list":"","load_config_table_list":"bitx_static_config.common_static_configuration,bitx_static_config.line_item_breakdown","db_filter_id_col_name":"","db_read_sql_select":"SELECT b.bill_header_id, d.line_number, d.bill_detail_record_id, d.service_from_date AS service_date_from, d.service_thru_date AS service_date_to, d.place_of_service_code, d.procedure_code, CASE WHEN d.hcpcs_modifier_code_1 = 69 THEN NULL ELSE d.hcpcs_modifier_code_1 END AS procedure_code_modifier_1, CASE WHEN d.hcpcs_modifier_code_2 = 69 THEN NULL ELSE d.hcpcs_modifier_code_2 END AS procedure_code_modifier_2, CASE WHEN d.hcpcs_modifier_code_3 = 69 THEN NULL ELSE d.hcpcs_modifier_code_3 END AS procedure_code_modifier_3, CASE WHEN d.hcpcs_modifier_code_4 = 69 THEN NULL ELSE d.hcpcs_modifier_code_4 END AS procedure_code_modifier_4, CASE WHEN d.diagnosis_pointer_1 IN ('0', '00') THEN 'A' ELSE d.diagnosis_pointer_1 END AS diagnosis_pointer_1, CASE WHEN d.diagnosis_pointer_2 IN ('0', '00') THEN '' ELSE d.diagnosis_pointer_2 END AS diagnosis_pointer_2, CASE WHEN d.diagnosis_pointer_3 IN ('0', '00') THEN '' ELSE d.diagnosis_pointer_3 END AS diagnosis_pointer_3, CASE WHEN d.diagnosis_pointer_4 IN ('0', '00') THEN '' ELSE d.diagnosis_pointer_4 END AS diagnosis_pointer_4, d.total_charge_per_line AS charges_for_services, CASE WHEN d.day_unit_qty < 1.0 THEN 1.0 ELSE d.day_unit_qty END AS units, d.prior_authorization, d.sales_tax FROM txm_bitx_staging.jopari_bill_header_record_10 b JOIN txm_bitx_staging.jopari_bill_detail_record_50 d ON b.bill_header_id = d.bill_header_id WHERE b.file_header_id = <INPUT_FILE_HEADER_ID> AND b.bill_form_type = 'PROF'","transform_sql_select":"SELECT t.treatment_id, h.bill_id, v.line_number, v.service_date_from, v.service_date_to, v.place_of_service_code, v.procedure_code, v.procedure_code_modifier_1, v.procedure_code_modifier_2, v.procedure_code_modifier_3, v.procedure_code_modifier_4, v.diagnosis_pointer_1, v.diagnosis_pointer_2, v.diagnosis_pointer_3, v.diagnosis_pointer_4, v.charges_for_services,CASE WHEN li.anesthesia_code <> '' THEN v.units * CAST(af.attribute_value AS INT) * CAST(li.anesthesia_code AS INT) ELSE v.units END AS units, v.prior_authorization, v.sales_tax FROM read_professional_treatment_line_vw v JOIN db_bill_header_vw h ON h.bill_header_id = v.bill_header_id JOIN db_professional_treatment_vw t ON t.bill_id = h.bill_id LEFT JOIN line_item_breakdown_vw li ON li.procedure_code <= v.procedure_code AND li.end_procedure_code >= v.procedure_code AND li.procedure_code_modifier <= IFNULL(v.procedure_code_modifier_1, '') AND li.end_procedure_code_modifier >= IFNULL(v.procedure_code_modifier_1, '') AND li.record_type = 'P' LEFT JOIN common_static_configuration_vw af ON af.attribute_name = 'Anesfac'"}
{"order_seq_no":7,"form_type":"CMS1500","table_type":"BILL_DETAIL","df_read_table_name":"read_billing_codes_vw","df_table_name":"billing_codes_vw","db_table_name":"txm_bitx.billing_codes","db_select_cols_list":"","load_config_table_list":"","db_filter_id_col_name":"","db_read_sql_select":"WITH RECURSIVE split_codes AS (SELECT b.bill_header_id, SUBSTRING(d.diagnostic_codes, 1, 12) AS part, SUBSTRING(d.diagnostic_codes, 13) AS rest, 1 AS part_number FROM txm_bitx_staging.jopari_bill_header_record_10 b JOIN txm_bitx_staging.jopari_diagnostic_codes_record_30 d ON b.bill_header_id = d.bill_header_id WHERE b.file_header_id = <INPUT_FILE_HEADER_ID> AND b.bill_form_type = 'PROF' AND LENGTH(d.diagnostic_codes) > 0 UNION ALL SELECT bill_header_id, SUBSTRING(rest, 1, 12) AS part, SUBSTRING(rest, 13) AS rest, part_number + 1 FROM split_codes WHERE LENGTH(rest) > 0) SELECT s.bill_header_id, s.part AS diagnostic_codes, s.part_number AS sequence_number FROM split_codes s","transform_sql_select":"SELECT t.bill_id, t.treatment_id, 'DIAGNOSTIC' AS code_type, v.sequence_number, CASE WHEN TRIM(SUBSTRING(v.diagnostic_codes, 1, 3)) IN ('ABK', 'ABF', 'ABJ', 'APR') THEN 'ICD10' WHEN TRIM(SUBSTRING(v.diagnostic_codes, 1, 3)) IN ('BK', 'BF', 'BJ', 'PR') THEN 'ICD9' ELSE NULL END AS diagnosis_code_qualifier_icd, TRIM(SUBSTRING(v.diagnostic_codes, 1, 3)) AS diagnosis_code_qualifier, SUBSTRING(v.diagnostic_codes, 4, 9) AS diagnosis_code FROM read_billing_codes_vw v JOIN db_bill_header_vw h ON h.bill_header_id = v.bill_header_id JOIN db_professional_treatment_vw t ON t.bill_id = h.bill_id"}
{"order_seq_no":8,"form_type":"CMS1500","table_type":"BILL_DETAIL","df_read_table_name": "read_billing_documents_vw","df_table_name": "billing_documents_vw","db_table_name": "txm_bitx.billing_documents","db_select_cols_list": "","load_config_table_list":"","db_filter_id_col_name": "","db_read_sql_select": "SELECT b.bill_header_id,a.attachment_record_number,a.report_type_code AS document_type_code,a.report_transmission_code AS document_transmission_code,a.attachment_control_number,a.attachment_description FROM txm_bitx_staging.jopari_bill_header_record_10 b JOIN txm_bitx_staging.jopari_attachments_record_40 a ON b.bill_header_id=a.bill_header_id where b.file_header_id=<INPUT_FILE_HEADER_ID> AND b.bill_form_type = 'PROF'","transform_sql_select": "SELECT h.bill_id ,v.attachment_record_number,v.document_type_code,v.document_transmission_code,v.attachment_control_number,v.attachment_description FROM read_billing_documents_vw v JOIN db_bill_header_vw h ON h.bill_header_id=v.bill_header_id "}
{"order_seq_no":9,"form_type":"CMS1500","table_type":"BILL_DETAIL","df_read_table_name":"read_bill_notes_vw","df_table_name":"bill_notes_vw","db_table_name":"txm_bitx.bill_notes","db_select_cols_list":"note_id,bill_id","load_config_table_list":"","db_filter_id_col_name":"file_header_id","db_read_sql_select":"SELECT b.bill_header_id, n.note_record_number, TRIM(n.note_text) AS note_text, n.note_type_code FROM txm_bitx_staging.jopari_bill_header_record_10 b JOIN txm_bitx_staging.jopari_bill_notes_record_41 n ON b.bill_header_id = n.bill_header_id WHERE b.file_header_id=<INPUT_FILE_HEADER_ID> AND b.bill_form_type = 'PROF' AND n.note_text IS NOT NULL AND TRIM(n.note_text) <> ''","transform_sql_select":"SELECT h.bill_id, v.note_record_number, v.note_text, SUBSTR(v.note_type_code, 1, 2) AS note_type_code FROM read_bill_notes_vw v JOIN db_bill_header_vw h ON h.bill_header_id = v.bill_header_id"}
{"order_seq_no":10,"form_type":"CMS1500","table_type":"BILL_DETAIL","df_read_table_name":"read_bill_notes_line_vw","df_table_name":"bill_notes_line_vw","db_table_name":"txm_bitx.bill_notes_line","db_select_cols_list":"line_id,bill_id","load_config_table_list":"","db_filter_id_col_name":"file_header_id","db_read_sql_select":"SELECT b.bill_header_id, l.line_num AS line_number, l.note_text AS line_text, l.note_type_code AS line_type_code, l.note_record_num AS line_record_number FROM txm_bitx_staging.jopari_bill_header_record_10 b JOIN txm_bitx_staging.jopari_line_level_notes_record_56 l ON b.bill_header_id=l.bill_header_id WHERE b.file_header_id=<INPUT_FILE_HEADER_ID> AND b.bill_form_type = 'PROF' AND l.note_text IS NOT NULL AND l.note_text <> ''","transform_sql_select":"SELECT h.bill_id, v.line_number, v.line_text, v.line_type_code, v.line_record_number FROM read_bill_notes_line_vw v JOIN db_bill_header_vw h ON h.bill_header_id = v.bill_header_id"}