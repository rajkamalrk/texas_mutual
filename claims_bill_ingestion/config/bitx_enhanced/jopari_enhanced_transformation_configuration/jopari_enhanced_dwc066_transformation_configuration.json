{ "order_seq_no": 1,"form_type": "DWC066","table_type": "BILL_HEADER","df_read_table_name": "read_bill_header_vw","df_table_name": "bill_header_vw","db_table_name": "txm_bitx.bill_header","db_select_cols_list": "bill_id,bill_header_id","load_config_table_list": "","db_filter_id_col_name": "file_header_id","db_read_sql_select": "SELECT DISTINCT 'jopari' AS trading_partner,b.bill_header_id,b.date_of_bill AS date_of_bill,b.billing_prov_unique_bill_id AS document_control_number,b.indexed_claim_num AS insurance_carrier_claim_number,b.file_header_id,s.treatment_authorization_num AS authorization_code,b.bill_form_type AS form_type,b.unique_bill_id,b.facility_code,b.bill_frequency_type_code,b.contract_type_code,CASE WHEN b.date_bill_received_by_payer IS NOT NULL THEN date_bill_received_by_payer ELSE CURRENT_DATE END AS date_bill_received_by_payer,b.bill_class_code,b.bill_submission_reason_code AS resubmission_code,b.original_reference_num AS original_reference_number,CASE WHEN b.indexed_claim_num <> '' AND b.indexed_claim_num IS NOT NULL THEN b.indexed_claim_num ELSE b.reported_claim_num END AS reported_claim_number,b.provider_signature_on_file_ind AS provider_signature_indicator FROM txm_bitx_staging.jopari_bill_header_record_10 b LEFT JOIN txm_bitx_staging.jopari_subscriber_record_13 s ON b.bill_header_id=s.bill_header_id WHERE b.file_header_id=<INPUT_FILE_HEADER_ID> AND b.bill_form_type = 'RX'","transform_sql_select":"SELECT * FROM read_bill_header_vw"}
{ "order_seq_no": 2,"form_type": "DWC066","table_type": "BILL_DETAIL","df_read_table_name": "read_patient_vw","df_table_name": "patient_vw","db_table_name": "txm_bitx.patient","db_select_cols_list": "bill_id","load_config_table_list":"","db_filter_id_col_name": "bill_id","db_read_sql_select": "SELECT b.bill_header_id,CASE WHEN b.patient_middle_name IS NOT NULL AND b.patient_middle_name<>'' THEN CONCAT(b.patient_last_name,',',b.patient_first_name,' ',LEFT(b.patient_middle_name,1)) ELSE CONCAT(b.patient_last_name,', ',b.patient_first_name) END AS patient_name ,b.patient_address1 AS patient_address_line_1,b.patient_address2 AS patient_address_line_2,b.patient_city,b.patient_state_code,b.patient_postal_code AS zip_code,CASE WHEN patient_phone_num<>'' THEN SUBSTRING(REGEXP_REPLACE(b.patient_phone_num,'[^0-9]',''),1,3) END AS patient_country_code,CASE WHEN patient_phone_num <>'' THEN SUBSTRING(REGEXP_REPLACE(b.patient_phone_num,'[^0-9]',''),4,7) END AS patient_phone_number,b.patient_SSN AS social_security_number,b.date_of_injury,b.patient_dob AS date_of_birth, CASE WHEN b.patient_marital_status_code='U' THEN '1' WHEN b.patient_marital_status_code='M' THEN '2' WHEN b.patient_marital_status_code='D' THEN '3' WHEN b.patient_marital_status_code='W' THEN '1' WHEN b.patient_marital_status_code='R' THEN '4' ELSE '6' END AS patient_marital_status_code,b.patient_medical_record_num AS patient_medical_record_number FROM txm_bitx_staging.jopari_bill_header_record_10 b WHERE b.file_header_id=<INPUT_FILE_HEADER_ID> AND b.bill_form_type = 'RX'","transform_sql_select": "SELECT h.bill_id,v.patient_name,v.patient_address_line_1,v.patient_address_line_2,v.patient_city,v.patient_state_code,v.zip_code,v.patient_country_code,v.patient_phone_number,v.social_security_number,v.date_of_injury,v.date_of_birth,v.patient_marital_status_code,v.patient_medical_record_number FROM read_patient_vw v JOIN db_bill_header_vw h ON h.bill_header_id=v.bill_header_id"}
{ "order_seq_no": 3,"form_type": "DWC066","table_type": "BILL_DETAIL","df_read_table_name": "read_subscriber_vw","df_table_name": "subscriber_vw","db_table_name": "txm_bitx.subscriber","db_select_cols_list": "bill_id","load_config_table_list":"","db_filter_id_col_name": "bill_id","db_read_sql_select": "SELECT b.bill_header_id,b.employer_name AS subscriber_name, CASE WHEN CHAR_LENGTH(TRIM(s.member_id)) = 9 AND TRIM(s.member_id) REGEXP '^[0-9]+$' THEN TRIM(member_id) ELSE NULL END AS insured_id_number FROM txm_bitx_staging.jopari_bill_header_record_10 b LEFT JOIN txm_bitx_staging.jopari_subscriber_record_13 s ON b.bill_header_id=s.bill_header_id WHERE b.file_header_id=<INPUT_FILE_HEADER_ID> AND b.bill_form_type = 'RX'","transform_sql_select": "SELECT h.bill_id,v.subscriber_name,v.insured_id_number FROM read_subscriber_vw v JOIN db_bill_header_vw h ON h.bill_header_id=v.bill_header_id"}
{ "order_seq_no": 4,"form_type": "DWC066","table_type": "BILL_DETAIL","df_read_table_name": "read_provider_vw","df_table_name": "provider_vw","db_table_name": "txm_bitx.provider","db_select_cols_list": "bill_id","load_config_table_list": "","db_filter_id_col_name":"bill_id","db_read_sql_select": "WITH provider_record_20 AS (SELECT p20.*, ROW_NUMBER() OVER(PARTITION BY tb.bill_header_id, p20.physician_code ORDER BY p20.provider_record_id) rno FROM txm_bitx_staging.jopari_bill_header_record_10 tb LEFT JOIN txm_bitx_staging.jopari_provider_record_20 p20 ON tb.bill_header_id = p20.bill_header_id WHERE tb.file_header_id = <INPUT_FILE_HEADER_ID> AND tb.bill_form_type = 'RX'), provider_record_60 AS (SELECT p60.*, ROW_NUMBER() OVER(PARTITION BY tb.bill_header_id, p60.physician_code ORDER BY p60.line_number, p60.line_level_physician_record_id) rno FROM txm_bitx_staging.jopari_bill_header_record_10 tb LEFT JOIN txm_bitx_staging.jopari_line_level_physician_record_60 p60 ON tb.bill_header_id = p60.bill_header_id WHERE tb.file_header_id = <INPUT_FILE_HEADER_ID> AND tb.bill_form_type = 'RX') SELECT DISTINCT b.bill_header_id, b.bill_form_type, CASE WHEN p60_ren.line_level_physician_record_id IS NOT NULL THEN '60_82' ELSE '20_82' END AS rendering_record_type_physician_code, CASE WHEN p60_ren.line_level_physician_record_id IS NOT NULL THEN p60_ren.provider_last_name ELSE p20_ren.last_name END AS rendering_provider_last_name,CASE WHEN p60_ren.line_level_physician_record_id IS NOT NULL THEN p60_ren.provider_first_name ELSE p20_ren.first_name END AS rendering_provider_first_name,CASE WHEN p60_ren.line_level_physician_record_id IS NOT NULL THEN p60_ren.provider_middle_name ELSE p20_ren.middle_name END AS rendering_provider_middle_name, CASE WHEN p60_ren.line_level_physician_record_id IS NOT NULL THEN p60_ren.provider_npi ELSE p20_ren.npi END AS rendering_provider_npi, CASE WHEN p60_ren.line_level_physician_record_id IS NOT NULL THEN p60_ren.provider_nabp ELSE p20_ren.nabp END AS rendering_provider_nabp, CASE WHEN p60_ren.line_level_physician_record_id IS NOT NULL THEN p60_ren.provider_dea_number ELSE p20_ren.dea_number END AS rendering_provider_dea_number, CASE WHEN p60_ren.line_level_physician_record_id IS NOT NULL THEN p60_ren.provider_taxonomy_code ELSE p20_ren.taxonomy_code END AS rendering_provider_taxonomy_code,CASE WHEN p20_ref.provider_record_id IS NOT NULL THEN '20_DN' ELSE '60_DK' END AS referring_record_type_physician_code,CASE WHEN p20_ref.provider_record_id IS NOT NULL THEN p20_ref.last_name ELSE p60_ref.provider_last_name END AS referring_provider_last_name, CASE WHEN p20_ref.provider_record_id IS NOT NULL THEN p20_ref.first_name ELSE p60_ref.provider_first_name END AS referring_provider_first_name,CASE WHEN p20_ref.provider_record_id IS NOT NULL THEN p20_ref.middle_name ELSE p60_ref.provider_middle_name END AS referring_provider_middle_name, CASE WHEN p20_ref.provider_record_id IS NOT NULL THEN p20_ref.state_license ELSE p60_ref.provider_state_license END AS referring_provider_state_license, CASE WHEN p20_ref.provider_record_id IS NOT NULL THEN p20_ref.npi ELSE p60_ref.provider_npi END AS referring_provider_npi, CASE WHEN p20_ref.provider_record_id IS NOT NULL THEN p20_ref.nabp ELSE p60_ref.provider_nabp END AS referring_provider_nabp, CASE WHEN p20_ref.provider_record_id IS NOT NULL THEN p20_ref.dea_number ELSE p60_ref.provider_dea_number END AS referring_provider_dea_number, CASE WHEN p20_ref.provider_record_id IS NOT NULL THEN p20_ref.taxonomy_code ELSE p60_ref.provider_taxonomy_code END AS referring_provider_taxonomy_code, p.service_facility_name AS facility_name, p.service_facility_address1 AS facility_address_1, p.service_facility_address2 AS facility_address_2, p.service_facility_city AS facility_city, p.service_facility_state AS facility_state, p.service_facility_zip_code AS facility_zip_code, p.service_facility_provider_NPI AS facility_npi, p.service_facility_provider_state_license AS facility_other_id, p.pay_to_provider_name, p.billing_provider_name, p.billing_provider_address1, p.pay_to_provider_address1, p.pay_to_provider_address2, p.billing_provider_address2, p.pay_to_provider_city, p.billing_provider_city, p.pay_to_provider_state, p.billing_provider_state, p.billing_zip_code, p.pay_to_zip_code, p.pay_to_provider_tax_id, p.billing_provider_tax_id, p.Pay_to_provider_NPI, p.billing_provider_NPI, p.pay_to_provider_state_license, p.billing_provider_state_license, p20_ope.first_name AS operating_provider_first_name, p20_ope.last_name AS operating_provider_last_name, p20_ope.npi AS operating_provider_national_provider_id, p20_ope.state_license AS operating_provider_other_id, p20_att.first_name AS attending_provider_first_name, p20_att.last_name AS attending_provider_last_name, p20_att.npi AS attending_provider_national_provider_id, p20_att.state_license AS attending_provider_other_id,CASE WHEN p60_ren.line_level_physician_record_id IS NOT NULL THEN p60_ren.provider_state_license ELSE p20_ren.state_license  END AS rendering_provider_other_id FROM txm_bitx_staging.jopari_bill_header_record_10 b JOIN txm_bitx_staging.jopari_bill_provider_record_12 p ON b.bill_header_id = p.bill_header_id LEFT JOIN provider_record_20 p20_ren ON b.bill_header_id = p20_ren.bill_header_id AND p20_ren.physician_code = '82' AND p20_ren.rno = 1 LEFT JOIN provider_record_60 p60_ren ON b.bill_header_id = p60_ren.bill_header_id AND p60_ren.physician_code = '82' AND p60_ren.rno = 1 LEFT JOIN provider_record_20 p20_ref ON b.bill_header_id = p20_ref.bill_header_id AND p20_ref.physician_code = 'DN' AND p20_ref.rno = 1 LEFT JOIN provider_record_60 p60_ref ON b.bill_header_id = p60_ref.bill_header_id AND p60_ref.physician_code = 'DK' AND p60_ref.rno = 1 LEFT JOIN provider_record_20 p20_ope ON b.bill_header_id = p20_ope.bill_header_id AND p20_ope.physician_code = '72' AND p20_ope.rno = 1 LEFT JOIN provider_record_20 p20_att ON b.bill_header_id = p20_att.bill_header_id AND p20_att.physician_code = '71' AND p20_att.rno = 1 WHERE b.file_header_id = <INPUT_FILE_HEADER_ID> AND b.bill_form_type = 'RX'","transform_sql_select":"SELECT h.bill_id,get_provider_name_udf(v.rendering_provider_last_name, v.rendering_provider_first_name, v.rendering_provider_middle_name, '') AS rendering_provider_name,v.rendering_record_type_physician_code, v.rendering_provider_npi, v.rendering_provider_dea_number,validate_NABP_udf(v.rendering_provider_nabp) AS rendering_provider_nabp,v.rendering_provider_taxonomy_code,get_provider_name_udf(v.referring_provider_last_name, v.referring_provider_first_name, v.referring_provider_middle_name, '') AS referring_provider_name,v.referring_record_type_physician_code,v.referring_provider_state_license, v.referring_provider_npi, v.referring_provider_dea_number,v.referring_provider_nabp,v.referring_provider_taxonomy_code,v.facility_name,v.facility_address_1,v.facility_address_2,v.facility_city,v.facility_state,v.facility_zip_code,v.facility_npi, CASE WHEN notNull_notEmpty_udf(v.pay_to_provider_name,v.pay_to_provider_address1, v.pay_to_provider_city ,v.pay_to_provider_state ,v.pay_to_zip_code, v.pay_to_provider_tax_id ) THEN '12_pay_to' ELSE '12_billing_to' END AS vendor_record_type_physician_code, CASE WHEN notNull_notEmpty_udf(v.pay_to_provider_name,v.pay_to_provider_address1, v.pay_to_provider_city ,v.pay_to_provider_state ,v.pay_to_zip_code, v.pay_to_provider_tax_id ) THEN v.pay_to_provider_name ELSE v.billing_provider_name END AS vendor_name,CASE WHEN notNull_notEmpty_udf(v.pay_to_provider_name,v.pay_to_provider_address1, v.pay_to_provider_city ,v.pay_to_provider_state ,v.pay_to_zip_code, v.pay_to_provider_tax_id ) THEN v.pay_to_provider_address1 ELSE v.billing_provider_address1 END AS vendor_address_1,CASE WHEN notNull_notEmpty_udf(v.pay_to_provider_name,v.pay_to_provider_address1, v.pay_to_provider_city ,v.pay_to_provider_state ,v.pay_to_zip_code, v.pay_to_provider_tax_id ) THEN v.pay_to_provider_address2 ELSE v.billing_provider_address2 END AS vendor_address_2,CASE WHEN notNull_notEmpty_udf(v.pay_to_provider_name,v.pay_to_provider_address1, v.pay_to_provider_city ,v.pay_to_provider_state ,v.pay_to_zip_code, v.pay_to_provider_tax_id ) THEN v.pay_to_provider_city ELSE v.billing_provider_city END AS vendor_city,CASE WHEN notNull_notEmpty_udf(v.pay_to_provider_name,v.pay_to_provider_address1, v.pay_to_provider_city ,v.pay_to_provider_state ,v.pay_to_zip_code, v.pay_to_provider_tax_id ) THEN v.pay_to_provider_state ELSE v.billing_provider_state END AS vendor_state,CASE WHEN notNull_notEmpty_udf(v.pay_to_provider_name,v.pay_to_provider_address1, v.pay_to_provider_city ,v.pay_to_provider_state ,v.pay_to_zip_code, v.pay_to_provider_tax_id ) THEN v.pay_to_zip_code ELSE v.billing_zip_code END AS vendor_zip_code,CASE WHEN notNull_notEmpty_udf(v.pay_to_provider_name,v.pay_to_provider_address1, v.pay_to_provider_city ,v.pay_to_provider_state, v.pay_to_zip_code, v.pay_to_provider_tax_id ) THEN v.Pay_to_provider_NPI ELSE v.billing_provider_NPI END AS vendor_npi,CASE WHEN notNull_notEmpty_udf(v.pay_to_provider_name,v.pay_to_provider_address1, v.pay_to_provider_city ,v.pay_to_provider_state ,v.pay_to_zip_code, v.pay_to_provider_tax_id ) THEN v.pay_to_provider_state_license ELSE v.billing_provider_state_license END AS vendor_other_id,v.facility_other_id,CASE WHEN notNull_notEmpty_udf(v.pay_to_provider_name,v.pay_to_provider_address1, v.pay_to_provider_city ,v.pay_to_provider_state ,v.pay_to_zip_code, v.pay_to_provider_tax_id ) THEN v.pay_to_provider_tax_id ELSE v.billing_provider_tax_id END AS vendor_tax_id, v.operating_provider_first_name, v.operating_provider_last_name, v.operating_provider_national_provider_id, v.operating_provider_other_id, v.attending_provider_first_name, v.attending_provider_last_name, v.attending_provider_national_provider_id, v.attending_provider_other_id , v.rendering_provider_other_id FROM read_provider_vw v JOIN db_bill_header_vw h WHERE h.bill_header_id=v.bill_header_id"}
{ "order_seq_no": 5,"form_type": "DWC066","table_type": "PHARMACY_LINE","df_read_table_name": "read_pharmacy_line_vw","df_table_name": "pharmacy_line_vw","db_table_name": "txm_bitx.pharmacy_line","db_select_cols_list": "","load_config_table_list":"","db_filter_id_col_name": "","db_read_sql_select": "SELECT b.bill_header_id, a.brand_indicator AS dispensed, a.dispense_as_written_code AS dispensed_as_written_code, a.prescription_date, a.ndc_code,d.line_number,d.service_from_date,d.service_thru_date,d.total_charge_per_line AS total_charge_per_bill,CASE WHEN d.diagnosis_pointer_1 = 0 OR d.diagnosis_pointer_1 IS NULL THEN 'A' ELSE d.diagnosis_pointer_1 END AS diagnosis_pointer_1,CASE WHEN d.diagnosis_pointer_2 = 0 THEN NULL ELSE d.diagnosis_pointer_2 END AS diagnosis_pointer_2, CASE WHEN d.diagnosis_pointer_3 = 0 THEN NULL ELSE d.diagnosis_pointer_3 END AS diagnosis_pointer_3, CASE WHEN d.diagnosis_pointer_4 = 0 THEN NULL ELSE d.diagnosis_pointer_4 END AS diagnosis_pointer_4, d.day_unit_qty AS quantity, a.days_supply, a.fill_count, c.total_prior_payment AS total_prior_payments, a.drug_name, a.prescription_number, c.treatment_authorization_num AS preauthorization_number, a.basis_of_cost_deter_code, a.usual_customary_charge, a.dispensing_fee FROM txm_bitx_staging.jopari_bill_header_record_10 b LEFT JOIN txm_bitx_staging.jopari_subscriber_record_13 c ON b.bill_header_id = c.bill_header_id LEFT JOIN txm_bitx_staging.jopari_bill_detail_record_50 d ON b.bill_header_id = d.bill_header_id LEFT JOIN txm_bitx_staging.jopari_bill_detail_additional_rx_data_51 a ON a.bill_header_id = b.bill_header_id AND d.line_number = a.line_number WHERE b.file_header_id=<INPUT_FILE_HEADER_ID> AND b.bill_form_type = 'RX'","transform_sql_select": "SELECT h.bill_id,v.line_number,v.dispensed,v.service_from_date,v.service_thru_date,v.diagnosis_pointer_1,v.diagnosis_pointer_2,v.diagnosis_pointer_3,v.diagnosis_pointer_4,v.dispensed_as_written_code,v.prescription_date,v.ndc_code, v.quantity,days_supply,v.fill_count,v.total_prior_payments,v.drug_name,v.prescription_number,v.total_charge_per_bill,v.preauthorization_number,v.basis_of_cost_deter_code,v.usual_customary_charge,v.dispensing_fee FROM read_pharmacy_line_vw v JOIN db_bill_header_vw h on h.bill_header_id=v.bill_header_id"}
{ "order_seq_no": 6,"form_type": "DWC066","table_type": "BILL_DETAIL","df_read_table_name": "read_billing_documents_vw","df_table_name": "billing_documents_vw","db_table_name": "txm_bitx.billing_documents","db_select_cols_list": "","load_config_table_list":"","db_filter_id_col_name": "","db_read_sql_select": "SELECT a.bill_header_id, a.attachment_record_number, a.report_type_code AS document_type_code, a.report_transmission_code AS document_transmission_code, a.attachment_control_number, a.attachment_description FROM txm_bitx_staging.jopari_bill_header_record_10 b JOIN txm_bitx_staging.jopari_attachments_record_40 a ON b.bill_header_id=a.bill_header_id WHERE b.file_header_id=<INPUT_FILE_HEADER_ID> AND b.bill_form_type = 'RX'","transform_sql_select": "SELECT h.bill_id,v.attachment_record_number,v.document_type_code,v.document_transmission_code,v.attachment_control_number,v.attachment_description FROM read_billing_documents_vw v JOIN db_bill_header_vw h ON h.bill_header_id=v.bill_header_id"}
{ "order_seq_no": 7,"form_type": "DWC066","table_type": "BILL_DETAIL","df_read_table_name": "read_billing_codes_vw","df_table_name": "billing_codes_vw","db_table_name": "txm_bitx.billing_codes","db_select_cols_list":"","load_config_table_list":"","db_filter_id_col_name": "","db_read_sql_select": "WITH RECURSIVE split_codes AS (SELECT b.bill_header_id, SUBSTRING(d.diagnostic_codes, 1, 12) AS part, SUBSTRING(d.diagnostic_codes, 13) AS rest, 1 AS part_number FROM txm_bitx_staging.jopari_bill_header_record_10 b JOIN txm_bitx_staging.jopari_diagnostic_codes_record_30 d ON b.bill_header_id = d.bill_header_id WHERE b.file_header_id = <INPUT_FILE_HEADER_ID> AND b.bill_form_type = 'RX' AND LENGTH(d.diagnostic_codes) > 0 UNION ALL SELECT bill_header_id, SUBSTRING(rest, 1, 12) AS part, SUBSTRING(rest, 13) AS rest, part_number + 1 FROM split_codes WHERE LENGTH(rest) > 0) SELECT s.bill_header_id AS bill_header_id, s.part AS diagnostic_codes, s.part_number AS sequence_number FROM split_codes s","transform_sql_select":"SELECT h.bill_id, 'DIAGNOSTIC' AS code_type, v.sequence_number, CASE WHEN TRIM(SUBSTRING(v.diagnostic_codes, 1, 3)) IN ('ABK', 'ABF', 'ABJ', 'APR') THEN 'ICD10' WHEN TRIM(SUBSTRING(v.diagnostic_codes, 1, 3)) IN ('BK', 'BF', 'BJ', 'PR') THEN 'ICD9' ELSE NULL END AS diagnosis_code_qualifier_icd, TRIM(SUBSTRING(v.diagnostic_codes, 1, 3)) AS diagnosis_code_qualifier, NULLIF(TRIM(SUBSTRING(v.diagnostic_codes, 4, 9)),'') AS diagnosis_code FROM read_billing_codes_vw v JOIN db_bill_header_vw h ON h.bill_header_id = v.bill_header_id"}