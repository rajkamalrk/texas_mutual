{"order_seq_no": 1,"form_type": "UB04","table_type": "BILL_HEADER","df_read_table_name": "read_bill_header_vw","df_table_name": "bill_header_vw","db_table_name": "txm_bitx.bill_header","db_select_cols_list": "bill_id,bill_header_id","load_config_table_list":"","db_filter_id_col_name": "file_header_id","db_read_sql_select": "SELECT DISTINCT 'jopari' AS trading_partner, b.bill_header_id, b.file_header_id, b.submitter_bill_id_num AS document_control_number, b.bill_form_type AS form_type, b.unique_bill_id, b.facility_code, b.bill_frequency_type_code, b.contract_type_code, CASE WHEN b.date_bill_received_by_payer IS NOT NULL THEN date_bill_received_by_payer ELSE CURRENT_DATE END AS date_bill_received_by_payer, b.bill_class_code, b.bill_submission_reason_code AS resubmission_code,  b.original_reference_num AS original_reference_number, CASE WHEN b.indexed_claim_num <> '' AND b.indexed_claim_num IS NOT NULL THEN b.indexed_claim_num ELSE b.reported_claim_num END AS reported_claim_number,b.provider_signature_on_file_ind AS provider_signature_indicator, b.date_of_bill AS date_of_bill FROM txm_bitx_staging.jopari_bill_header_record_10 b WHERE b.file_header_id=<INPUT_FILE_HEADER_ID> AND b.bill_form_type = 'INST'","transform_sql_select": "SELECT * FROM read_bill_header_vw"}
{"order_seq_no": 2,"form_type": "UB04","table_type": "BILL_DETAIL","df_read_table_name": "read_patient_vw","df_table_name": "patient_vw","db_table_name": "txm_bitx.patient","db_select_cols_list": "bill_id","load_config_table_list":"","db_filter_id_col_name": "bill_id","db_read_sql_select": "SELECT b.bill_header_id, CASE WHEN b.patient_middle_name IS NOT NULL AND b.patient_middle_name<>'' THEN CONCAT(b.patient_last_name,',',b.patient_first_name,' ',LEFT(b.patient_middle_name,1)) ELSE CONCAT(b.patient_last_name,', ',b.patient_first_name) END AS patient_name, b.patient_dob AS date_of_birth, b.patient_gender_code AS patient_gender, b.patient_address1 AS patient_address_line_1, b.patient_address2 AS patient_address_line_2, b.patient_city, b.patient_state_code, b.patient_postal_code AS zip_code, b.patient_country_code AS patient_country_code, CASE WHEN patient_phone_num <>'' THEN SUBSTRING(REGEXP_REPLACE(b.patient_phone_num,'[^0-9]',''),1,7) END AS patient_phone_number, s.patient_relationship_to_subscriber AS patient_relationship_to_insured, b.date_of_injury, CASE WHEN b.patient_marital_status_code='U' THEN '1' WHEN b.patient_marital_status_code='M' THEN '2' WHEN b.patient_marital_status_code='D' THEN '3' WHEN b.patient_marital_status_code='W' THEN '1' WHEN b.patient_marital_status_code='R' THEN '4' ELSE '6' END AS patient_marital_status_code, b.patient_medical_record_num AS patient_medical_record_number, b.patient_SSN AS social_security_number, b.patient_account_num AS patient_control_number FROM txm_bitx_staging.jopari_bill_header_record_10 b LEFT JOIN txm_bitx_staging.jopari_subscriber_record_13 s ON b.bill_header_id=s.bill_header_id WHERE b.file_header_id=<INPUT_FILE_HEADER_ID> AND b.bill_form_type = 'INST'","transform_sql_select": "SELECT h.bill_id,v.patient_name,v.date_of_birth,v.patient_gender,v.patient_address_line_1,v.patient_address_line_2,v.patient_city,v.patient_state_code,v.zip_code,v.patient_country_code,v.patient_phone_number,v.patient_relationship_to_insured,v.date_of_injury,v.patient_marital_status_code,v.patient_medical_record_number,v.social_security_number,v.patient_control_number FROM read_patient_vw v JOIN db_bill_header_vw h ON h.bill_header_id=v.bill_header_id"}
{"order_seq_no": 3,"form_type": "UB04","table_type": "BILL_DETAIL","df_read_table_name": "read_subscriber_vw","df_table_name": "subscriber_vw","db_table_name": "txm_bitx.subscriber","db_select_cols_list": "bill_id","load_config_table_list":"","db_filter_id_col_name": "bill_id","db_read_sql_select": "SELECT b.bill_header_id, CASE WHEN s.subscriber_middle_name IS NOT NULL AND s.subscriber_middle_name<>'' AND  s.subscriber_first_name IS NOT NULL AND s.subscriber_first_name<>'' THEN CONCAT(s.subscriber_last_name,',',s.subscriber_first_name,' ',LEFT(s.subscriber_middle_name,1)) WHEN s.subscriber_first_name IS NOT NULL AND s.subscriber_first_name<>''  THEN CONCAT(s.subscriber_last_name,', ',s.subscriber_first_name) ELSE s.subscriber_last_name END AS subscriber_name, CASE WHEN CHAR_LENGTH(TRIM(s.member_id)) = 9 AND TRIM(s.member_id) REGEXP '^[0-9]+$' THEN TRIM(member_id) ELSE NULL END AS insured_id_number, b.employer_name FROM txm_bitx_staging.jopari_bill_header_record_10 b LEFT JOIN txm_bitx_staging.jopari_subscriber_record_13 s ON b.bill_header_id=s.bill_header_id WHERE b.file_header_id=<INPUT_FILE_HEADER_ID> AND b.bill_form_type = 'INST'","transform_sql_select": "SELECT h.bill_id,v.subscriber_name,v.insured_id_number,v.employer_name FROM read_subscriber_vw v JOIN db_bill_header_vw h ON h.bill_header_id=v.bill_header_id"}
{"order_seq_no": 4,"form_type": "UB04","table_type": "BILL_DETAIL","df_read_table_name": "read_provider_vw","df_table_name": "provider_vw","db_table_name": "txm_bitx.provider","db_select_cols_list": "bill_id","load_config_table_list":"","db_filter_id_col_name": "bill_id","db_read_sql_select": "WITH provider_record_20 AS (SELECT p20.*, ROW_NUMBER() OVER(PARTITION BY tb.bill_header_id, p20.physician_code ORDER BY p20.provider_record_id) rno FROM txm_bitx_staging.jopari_bill_header_record_10 tb LEFT JOIN txm_bitx_staging.jopari_provider_record_20 p20 ON tb.bill_header_id = p20.bill_header_id WHERE tb.file_header_id = <INPUT_FILE_HEADER_ID> AND tb.bill_form_type = 'INST') SELECT DISTINCT b.bill_header_id, b.bill_form_type, '20_71' AS referring_record_type_physician_code, p20_71.last_name AS referring_provider_last_name, p20_71.first_name AS referring_provider_first_name, p20_71.middle_name AS referring_provider_middle_name, p20_71.state_license AS referring_provider_state_license, p20_71.npi AS referring_provider_npi, p20_71.nabp AS referring_provider_nabp, p20_71.dea_number AS referring_provider_dea_number, p20_71.taxonomy_code AS referring_provider_taxonomy_code, p.pay_to_provider_name, p.billing_provider_name,p.billing_provider_address1,p.pay_to_provider_address1,p.pay_to_provider_address2, p.billing_provider_address2, p.pay_to_provider_city,p.billing_provider_city,p.pay_to_provider_state,p.billing_provider_state,p.billing_zip_code,p.pay_to_zip_code,p.pay_to_provider_country AS vendor_country,p.Pay_to_provider_NPI,p.billing_provider_NPI,p.billing_provider_tax_id, p.pay_to_provider_tax_id, p.pay_to_provider_state_license,p.billing_provider_state_license,CASE WHEN p.service_facility_address1 IS NOT NULL THEN p.service_facility_name END AS facility_name,CASE WHEN p.service_facility_address1 IS NOT NULL THEN p.service_facility_address1 END AS facility_address_1,CASE WHEN p.service_facility_address1 IS NOT NULL THEN p.service_facility_address2 END AS facility_address_2,CASE WHEN p.service_facility_address1 IS NOT NULL THEN  p.service_facility_city END AS facility_city,CASE WHEN p.service_facility_address1 IS NOT NULL THEN p.service_facility_state END AS facility_state,CASE WHEN p.service_facility_address1 IS NOT NULL THEN p.service_facility_zip_code END AS facility_zip_code,CASE WHEN p.service_facility_address1 IS NOT NULL THEN p.service_facility_provider_NPI END AS facility_npi,CASE WHEN p.service_facility_address1 IS NOT NULL THEN p.service_facility_provider_state_license END AS facility_other_id, p20_ope.first_name AS operating_provider_first_name, p20_ope.last_name AS operating_provider_last_name, p20_ope.npi AS operating_provider_national_provider_id, p20_ope.state_license AS operating_provider_other_id, p20_71.first_name AS attending_provider_first_name, p20_71.last_name AS attending_provider_last_name, p20_71.npi AS attending_provider_national_provider_id, p20_71.state_license AS attending_provider_other_id FROM txm_bitx_staging.jopari_bill_header_record_10 b JOIN txm_bitx_staging.jopari_bill_provider_record_12 p ON b.bill_header_id = p.bill_header_id LEFT JOIN provider_record_20 p20_71 ON b.bill_header_id = p20_71.bill_header_id AND p20_71.physician_code = '71' AND p20_71.rno = 1 LEFT JOIN provider_record_20 p20_ope ON b.bill_header_id = p20_ope.bill_header_id AND p20_ope.physician_code = '72' AND p20_ope.rno = 1 WHERE b.file_header_id = <INPUT_FILE_HEADER_ID> AND b.bill_form_type = 'INST'","transform_sql_select": "SELECT h.bill_id, CASE WHEN notNull_notEmpty_udf(v.pay_to_provider_name,v.pay_to_provider_address1, v.pay_to_provider_city ,v.pay_to_provider_state ,v.pay_to_zip_code, v.pay_to_provider_tax_id ) THEN '12_pay_to' ELSE '12_billing_to' END AS rendering_record_type_physician_code, CASE WHEN notNull_notEmpty_udf(v.pay_to_provider_name,v.pay_to_provider_address1, v.pay_to_provider_city ,v.pay_to_provider_state ,v.pay_to_zip_code, v.pay_to_provider_tax_id ) THEN v.pay_to_provider_name ELSE v.billing_provider_name END AS rendering_provider_name,CASE WHEN notNull_notEmpty_udf(v.pay_to_provider_name,v.pay_to_provider_address1, v.pay_to_provider_city ,v.pay_to_provider_state,v.pay_to_zip_code, v.pay_to_provider_tax_id) THEN v.pay_to_provider_state_license ELSE v.billing_provider_state_license END AS rendering_provider_license, CASE WHEN notNull_notEmpty_udf(v.pay_to_provider_name,v.pay_to_provider_address1, v.pay_to_provider_city ,v.pay_to_provider_state ,v.pay_to_zip_code, v.pay_to_provider_tax_id ) THEN v.Pay_to_provider_NPI ELSE v.billing_provider_NPI END AS rendering_provider_npi,get_provider_name_udf(v.referring_provider_last_name, v.referring_provider_first_name, v.referring_provider_middle_name, '') AS referring_provider_name,v.referring_record_type_physician_code,v.referring_provider_state_license,v.referring_provider_npi,v.referring_provider_dea_number,v.referring_provider_nabp,v.referring_provider_taxonomy_code,CASE WHEN notNull_notEmpty_udf(v.pay_to_provider_name,v.pay_to_provider_address1, v.pay_to_provider_city ,v.pay_to_provider_state ,v.pay_to_zip_code, v.pay_to_provider_tax_id ) THEN '12_pay_to' ELSE '12_billing_to' END AS vendor_record_type_physician_code, CASE WHEN notNull_notEmpty_udf(v.pay_to_provider_name,v.pay_to_provider_address1, v.pay_to_provider_city ,v.pay_to_provider_state ,v.pay_to_zip_code, v.pay_to_provider_tax_id ) THEN v.pay_to_provider_name ELSE v.billing_provider_name END AS vendor_name,CASE WHEN notNull_notEmpty_udf(v.pay_to_provider_name,v.pay_to_provider_address1, v.pay_to_provider_city ,v.pay_to_provider_state , v.pay_to_zip_code, v.pay_to_provider_tax_id ) THEN v.pay_to_provider_address1 ELSE v.billing_provider_address1 END AS vendor_address_1,CASE WHEN notNull_notEmpty_udf(v.pay_to_provider_name,v.pay_to_provider_address1, v.pay_to_provider_city ,v.pay_to_provider_state ,v.pay_to_zip_code, v.pay_to_provider_tax_id ) THEN v.pay_to_provider_address2 ELSE v.billing_provider_address2 END AS vendor_address_2,CASE WHEN notNull_notEmpty_udf(v.pay_to_provider_name,v.pay_to_provider_address1, v.pay_to_provider_city ,v.pay_to_provider_state ,v.pay_to_zip_code, v.pay_to_provider_tax_id ) THEN v.pay_to_provider_city ELSE v.billing_provider_city END AS vendor_city,CASE WHEN notNull_notEmpty_udf(v.pay_to_provider_name,v.pay_to_provider_address1, v.pay_to_provider_city ,v.pay_to_provider_state ,v.pay_to_zip_code, v.pay_to_provider_tax_id ) THEN v.pay_to_provider_state ELSE v.billing_provider_state END AS vendor_state,CASE WHEN notNull_notEmpty_udf(v.pay_to_provider_name,v.pay_to_provider_address1, v.pay_to_provider_city ,v.pay_to_provider_state ,v.pay_to_zip_code, v.pay_to_provider_tax_id ) THEN v.pay_to_zip_code ELSE v.billing_zip_code END AS vendor_zip_code,CASE WHEN notNull_notEmpty_udf(v.pay_to_provider_name,v.pay_to_provider_address1, v.pay_to_provider_city ,v.pay_to_provider_state ,v.pay_to_zip_code, v.pay_to_provider_tax_id ) THEN v.Pay_to_provider_NPI ELSE v.billing_provider_NPI END AS vendor_npi,CASE WHEN notNull_notEmpty_udf(v.pay_to_provider_name,v.pay_to_provider_address1, v.pay_to_provider_city ,v.pay_to_provider_state,v.pay_to_zip_code, v.pay_to_provider_tax_id ) THEN v.Pay_to_provider_tax_id ELSE v.billing_provider_tax_id END AS vendor_tax_id,CASE WHEN notNull_notEmpty_udf(v.pay_to_provider_name,v.pay_to_provider_address1, v.pay_to_provider_city ,v.pay_to_provider_state,v.pay_to_zip_code, v.pay_to_provider_tax_id) THEN v.pay_to_provider_state_license ELSE v.billing_provider_state_license END AS vendor_other_id,v.vendor_country,v.pay_to_provider_state_license,v.facility_name,v.facility_address_1,v.facility_address_2,v.facility_state,v.facility_city,v.facility_zip_code,v.facility_npi,v.facility_other_id,v.operating_provider_first_name, v.operating_provider_last_name, v.operating_provider_national_provider_id, v.operating_provider_other_id, v.attending_provider_first_name, v.attending_provider_last_name, v.attending_provider_national_provider_id, v.attending_provider_other_id FROM read_provider_vw v JOIN db_bill_header_vw h where h.bill_header_id=v.bill_header_id"}
{"order_seq_no": 5,"form_type": "UB04","table_type": "BILL_DETAIL","df_read_table_name": "read_hospitalization_treatment_vw","df_table_name": "hospitalization_treatment_vw","db_table_name": "txm_bitx.hospitalization_treatment","db_select_cols_list": "hospitalization_treatment_id,bill_id","load_config_table_list":"","db_filter_id_col_name": "file_header_id","db_read_sql_select": "SELECT b.bill_header_id,b.bill_form_type AS type_of_bill,CASE WHEN b.from_service_bill_date IS NOT NULL THEN from_service_bill_date ELSE b.date_of_bill END AS from_service_bill_date,b.thru_service_bill_date,b.admission_date,a.admission_hour,a.admission_type_code AS admission_type,a.admission_source_code AS admission_source,a.discharge_hour,a.discharge_status_code AS patient_discharge_status,b.accident_state,b.date_of_onset_similar_symptoms AS date_onset_similiar_symptoms,b.payer_assigned_pay_code AS payer_identification_name,c.treatment_authorization_num AS treatment_authorization_number,a.drg_code AS pps_code,b.accident_cause1 AS external_cause_of_injury,b.accident_cause2 AS external_cause_of_injury_2,b.accident_cause3 AS external_cause_of_injury_3 FROM txm_bitx_staging.jopari_bill_header_record_10 b LEFT JOIN txm_bitx_staging.jopari_institutional_record_31 a ON b.bill_header_id=a.bill_header_id LEFT JOIN txm_bitx_staging.jopari_subscriber_record_13 c ON b.bill_header_id=c.bill_header_id WHERE b.file_header_id=<INPUT_FILE_HEADER_ID> AND b.bill_form_type = 'INST'","transform_sql_select": "SELECT h.bill_id,v.type_of_bill,v.from_service_bill_date,v.thru_service_bill_date,v.admission_date,v.admission_hour,v.admission_type,v.admission_source,v.discharge_hour,v.patient_discharge_status,v.accident_state,v.date_onset_similiar_symptoms,v.payer_identification_name,v.treatment_authorization_number,v.pps_code,v.external_cause_of_injury_2,v.external_cause_of_injury_3,v.external_cause_of_injury FROM read_hospitalization_treatment_vw v JOIN db_bill_header_vw h ON h.bill_header_id=v.bill_header_id"}
{"order_seq_no": 6,"form_type": "UB04","table_type": "LINE_DETAIL","df_read_table_name": "read_hospitalization_treatment_line_vw","df_table_name": "hospitalization_treatment_line_vw","db_table_name": "txm_bitx.hospitalization_treatment_line","db_select_cols_list": "","load_config_table_list":"bitx_static_config.common_static_configuration,bitx_static_config.line_item_breakdown","db_filter_id_col_name": "","db_read_sql_select": "SELECT b.bill_header_id,d.bill_detail_record_id,d.procedure_code,d.line_number,CASE WHEN d.hcpcs_modifier_code_1 = 69 THEN NULL ELSE d.hcpcs_modifier_code_1 END AS hcpcs_modifier_code_1,CASE WHEN d.hcpcs_modifier_code_2 = 69 THEN NULL ELSE d.hcpcs_modifier_code_2 END AS hcpcs_modifier_code_2,CASE WHEN d.hcpcs_modifier_code_3 = 69 THEN NULL ELSE d.hcpcs_modifier_code_3 END AS hcpcs_modifier_code_3,CASE WHEN d.hcpcs_modifier_code_4 = 69 THEN NULL ELSE d.hcpcs_modifier_code_4 END AS hcpcs_modifier_code_4,d.service_from_date,d.service_thru_date,d.total_charge_per_line AS charge_for_service,d.day_unit_qty,CASE WHEN d.revenue_code <> '' AND LENGTH(d.revenue_code) > 3 THEN SUBSTRING(d.revenue_code, LENGTH(d.revenue_code) - 2, 3) ELSE revenue_code END AS revenue_code FROM txm_bitx_staging.jopari_bill_header_record_10 b JOIN txm_bitx_staging.jopari_bill_detail_record_50 d ON b.bill_header_id=d.bill_header_id WHERE b.file_header_id=<INPUT_FILE_HEADER_ID> AND b.bill_form_type = 'INST'","transform_sql_select": "SELECT t.hospitalization_treatment_id,h.bill_id,v.procedure_code,v.line_number,v.hcpcs_modifier_code_1,v.hcpcs_modifier_code_2,v.hcpcs_modifier_code_3,v.hcpcs_modifier_code_4,v.service_from_date,v.service_thru_date,v.charge_for_service,v.revenue_code,CASE WHEN li.anesthesia_code <> '' THEN v.day_unit_qty * CAST(af.attribute_value AS INT) * CAST(li.anesthesia_code AS INT) ELSE v.day_unit_qty END AS units_of_service FROM read_hospitalization_treatment_line_vw v JOIN db_bill_header_vw h ON h.bill_header_id=v.bill_header_id JOIN db_hospitalization_treatment_vw t ON t.bill_id = h.bill_id LEFT JOIN line_item_breakdown_vw li ON li.procedure_code <= v.revenue_code AND li.end_procedure_code >= v.revenue_code AND li.record_type = 'R' LEFT JOIN common_static_configuration_vw af ON af.attribute_name = 'Anesfac'"}
{"order_seq_no": 7,"form_type":"UB04","table_type":"BILL_DETAIL","df_read_table_name":"read_billing_codes_vw","df_table_name":"billing_codes_vw","db_table_name":"txm_bitx.billing_codes","db_select_cols_list":"","load_config_table_list":"","db_filter_id_col_name":"","db_read_sql_select":"WITH RECURSIVE split_codes AS (SELECT b.bill_header_id, SUBSTRING(d.diagnostic_codes, 1, 12) AS part, SUBSTRING(d.diagnostic_codes, 13) AS rest, 1 AS part_number FROM txm_bitx_staging.jopari_bill_header_record_10 b JOIN txm_bitx_staging.jopari_diagnostic_codes_record_30 d ON b.bill_header_id = d.bill_header_id WHERE b.file_header_id = <INPUT_FILE_HEADER_ID> AND b.bill_form_type = 'INST' AND LENGTH(d.diagnostic_codes) > 0 UNION ALL SELECT bill_header_id, SUBSTRING(rest, 1, 12) AS part, SUBSTRING(rest, 13) AS rest, part_number + 1 FROM split_codes WHERE LENGTH(rest) > 0) SELECT s.bill_header_id, s.part AS diagnostic_codes, s.part_number AS sequence_number FROM split_codes s","transform_sql_select":"SELECT t.bill_id, t.hospitalization_treatment_id AS treatment_id, 'DIAGNOSTIC' AS code_type, v.sequence_number, CASE WHEN TRIM(SUBSTRING(v.diagnostic_codes, 1, 3)) IN ('ABK', 'ABF', 'ABJ', 'APR') THEN 'ICD10' WHEN TRIM(SUBSTRING(v.diagnostic_codes, 1, 3)) IN ('BK', 'BF', 'BJ', 'PR') THEN 'ICD9' ELSE NULL END AS diagnosis_code_qualifier_icd, TRIM(SUBSTRING(v.diagnostic_codes, 1, 3)) AS diagnosis_code_qualifier, NULLIF(TRIM(SUBSTRING(v.diagnostic_codes, 4, 9)),'') AS diagnosis_code FROM read_billing_codes_vw v JOIN db_bill_header_vw h ON h.bill_header_id = v.bill_header_id JOIN db_hospitalization_treatment_vw t ON t.bill_id = h.bill_id"}
{"order_seq_no": 8,"form_type":"UB04","table_type":"BILL_DETAIL","df_read_table_name":"read_billing_codes_vw","df_table_name":"billing_codes_vw","db_table_name":"txm_bitx.billing_codes","db_select_cols_list":"","load_config_table_list":"","db_filter_id_col_name":"","db_read_sql_select":"WITH RECURSIVE split_occurance_codes AS (SELECT b.bill_header_id, SUBSTRING(i.occurance_codes, 1, 10) AS part,SUBSTRING(i.occurance_codes, 11) AS rest,1 AS part_number FROM txm_bitx_staging.jopari_bill_header_record_10 b JOIN txm_bitx_staging.jopari_institutional_record_31 i ON b.bill_header_id = i.bill_header_id WHERE b.file_header_id = <INPUT_FILE_HEADER_ID> AND b.bill_form_type = 'INST' AND LENGTH(i.occurance_codes) > 0 UNION ALL SELECT bill_header_id,SUBSTRING(rest, 1, 10) AS part,SUBSTRING(rest, 11) AS rest,part_number + 1 FROM split_occurance_codes WHERE LENGTH(rest) > 0) SELECT s.bill_header_id, s.part AS occurance_codes, s.part_number AS sequence_number FROM split_occurance_codes s","transform_sql_select":"SELECT t.bill_id, t.hospitalization_treatment_id AS treatment_id, 'OCCURANCE' AS code_type, v.sequence_number,NULLIF(TRIM(SUBSTRING(v.occurance_codes,1,2)),'') AS occurance_code,TO_DATE(NULLIF(NULLIF(TRIM(SUBSTRING(v.occurance_codes,3,8)),'00000000'),''),'yyyyMMdd') AS occurance_date FROM read_billing_codes_vw v JOIN db_bill_header_vw h ON h.bill_header_id = v.bill_header_id JOIN db_hospitalization_treatment_vw t ON t.bill_id = h.bill_id"}
{"order_seq_no": 9,"form_type": "UB04","table_type": "BILL_DETAIL","df_read_table_name": "read_billing_codes_vw","df_table_name": "billing_codes_vw","db_table_name": "txm_bitx.billing_codes","db_select_cols_list": "","load_config_table_list":"","db_filter_id_col_name": "","db_read_sql_select": "WITH RECURSIVE split_span_codes AS (SELECT b.bill_header_id, SUBSTRING(i.occurance_span_codes, 1, 18) AS part,SUBSTRING(i.occurance_span_codes, 19) AS rest,1 AS part_number FROM txm_bitx_staging.jopari_bill_header_record_10 b JOIN txm_bitx_staging.jopari_institutional_record_31 i ON b.bill_header_id = i.bill_header_id WHERE b.file_header_id = <INPUT_FILE_HEADER_ID> AND b.bill_form_type = 'INST' AND LENGTH(i.occurance_span_codes) > 0 UNION ALL SELECT bill_header_id,SUBSTRING(rest, 1, 18) AS part,SUBSTRING(rest, 19) AS rest,part_number + 1 FROM split_span_codes WHERE LENGTH(rest) > 0) SELECT s.bill_header_id, s.part AS occurance_span_codes, s.part_number AS sequence_number FROM split_span_codes s","transform_sql_select":"SELECT t.bill_id,t.hospitalization_treatment_id AS treatment_id, 'SPAN' AS code_type, v.sequence_number, NULLIF(TRIM(SUBSTRING(v.occurance_span_codes,1,2)),'') AS occurance_span_code,TO_DATE(NULLIF(NULLIF(TRIM(SUBSTRING(v.occurance_span_codes,3,8)),'00000000'),''),'yyyyMMdd') AS occurance_span_from_date,TO_DATE(NULLIF(NULLIF(TRIM(SUBSTRING(v.occurance_span_codes,11,8)),'00000000'),''),'yyyyMMdd') AS occurance_span_thru_date FROM read_billing_codes_vw v JOIN db_bill_header_vw h ON h.bill_header_id = v.bill_header_id JOIN db_hospitalization_treatment_vw t ON t.bill_id = h.bill_id"}
{"order_seq_no": 10,"form_type": "UB04","table_type": "BILL_DETAIL","df_read_table_name": "read_billing_codes_vw","df_table_name": "billing_codes_vw","db_table_name": "txm_bitx.billing_codes","db_select_cols_list": "","load_config_table_list":"","db_filter_id_col_name": "","db_read_sql_select": "WITH RECURSIVE split_value_codes AS (SELECT b.bill_header_id, SUBSTRING(i.value_codes, 1, 12) AS part,SUBSTRING(i.value_codes, 13) AS rest,1 AS part_number FROM txm_bitx_staging.jopari_bill_header_record_10 b JOIN txm_bitx_staging.jopari_institutional_record_31 i ON b.bill_header_id = i.bill_header_id WHERE b.file_header_id = <INPUT_FILE_HEADER_ID> AND b.bill_form_type = 'INST' AND LENGTH(i.value_codes) > 0 UNION ALL SELECT bill_header_id,SUBSTRING(rest, 1, 12) AS part,SUBSTRING(rest, 13) AS rest,part_number + 1 FROM split_value_codes WHERE LENGTH(rest) > 0) SELECT s.bill_header_id AS bill_header_id, s.part AS value_codes, s.part_number AS sequence_number FROM split_value_codes s","transform_sql_select":"SELECT t.bill_id,t.hospitalization_treatment_id AS treatment_id, 'VALUE' AS code_type, v.sequence_number, NULLIF(TRIM(SUBSTRING(v.value_codes,1,2)),'') AS value_code,CAST(TRIM(SUBSTR(v.value_codes,3,8)) ||'.'||TRIM(SUBSTR(v.value_codes,11,2)) AS DECIMAL(10,2)) AS value_code_amount FROM read_billing_codes_vw v JOIN db_bill_header_vw h ON h.bill_header_id = v.bill_header_id JOIN db_hospitalization_treatment_vw t ON t.bill_id = h.bill_id"}
{"order_seq_no": 11,"form_type": "UB04","table_type": "BILL_DETAIL","df_read_table_name": "read_billing_codes_vw","df_table_name": "billing_codes_vw","db_table_name": "txm_bitx.billing_codes","db_select_cols_list": "","load_config_table_list":"","db_filter_id_col_name": "","db_read_sql_select": "WITH RECURSIVE split_condition_codes AS (SELECT b.bill_header_id, SUBSTRING(i.condition_codes, 1, 2) AS part,SUBSTRING(i.condition_codes, 3) AS rest,1 AS part_number FROM txm_bitx_staging.jopari_bill_header_record_10 b JOIN txm_bitx_staging.jopari_institutional_record_31 i ON b.bill_header_id = i.bill_header_id WHERE b.file_header_id = <INPUT_FILE_HEADER_ID> AND b.bill_form_type = 'INST' AND LENGTH(i.condition_codes) > 0 UNION ALL SELECT bill_header_id,SUBSTRING(rest, 1, 2) AS part,SUBSTRING(rest, 3) AS rest,part_number + 1 FROM split_condition_codes WHERE LENGTH(rest) > 0) SELECT s.bill_header_id AS bill_header_id, s.part AS condition_codes, s.part_number AS sequence_number FROM split_condition_codes s","transform_sql_select":"SELECT t.bill_id,t.hospitalization_treatment_id AS treatment_id, 'CONDITION' AS code_type, v.sequence_number, NULLIF(TRIM(v.condition_codes),'') AS condition_codes FROM read_billing_codes_vw v JOIN db_bill_header_vw h ON h.bill_header_id = v.bill_header_id JOIN db_hospitalization_treatment_vw t ON t.bill_id = h.bill_id"}
{"order_seq_no": 12,"form_type": "UB04","table_type": "BILL_DETAIL","df_read_table_name": "read_billing_codes_vw","df_table_name": "billing_codes_vw","db_table_name": "txm_bitx.billing_codes","db_select_cols_list": "","load_config_table_list":"","db_filter_id_col_name": "","db_read_sql_select": "WITH RECURSIVE split_procedure_codes AS (SELECT b.bill_header_id, SUBSTRING(i.procedure_codes, 1, 17) AS part,SUBSTRING(i.procedure_codes, 18) AS rest,1 AS part_number FROM txm_bitx_staging.jopari_bill_header_record_10 b JOIN txm_bitx_staging.jopari_institutional_record_31 i ON b.bill_header_id = i.bill_header_id WHERE b.file_header_id = <INPUT_FILE_HEADER_ID> AND b.bill_form_type = 'INST' AND LENGTH(i.procedure_codes) > 0 UNION ALL SELECT bill_header_id,SUBSTRING(rest, 1, 17) AS part,SUBSTRING(rest, 18) AS rest,part_number + 1 FROM split_procedure_codes WHERE LENGTH(rest) > 0) SELECT s.bill_header_id AS bill_header_id, s.part AS procedure_codes, s.part_number AS sequence_number FROM split_procedure_codes s","transform_sql_select":"SELECT t.bill_id,t.hospitalization_treatment_id AS treatment_id, 'PROCEDURE' AS code_type, v.sequence_number, CASE WHEN NULLIF(TRIM(SUBSTRING(v.procedure_codes, 1, 3)),'') IN ('BBQ', 'BBR') THEN 'ICD10' WHEN NULLIF(TRIM(SUBSTRING(v.procedure_codes, 1, 3)),'') IN ('BQ', 'BR') THEN 'ICD9' ELSE NULL END AS procedure_code_qualifier_icd, TRIM(SUBSTRING(v.procedure_codes, 1, 3)) AS procedure_code_qualifier,NULLIF(TRIM(SUBSTRING(v.procedure_codes,4,6)),'') AS procedure_code,TO_DATE(NULLIF(NULLIF(TRIM(SUBSTRING(v.procedure_codes,10,8)),'00000000'),''),'yyyyMMdd') AS procedure_date FROM read_billing_codes_vw v JOIN db_bill_header_vw h ON h.bill_header_id = v.bill_header_id JOIN db_hospitalization_treatment_vw t ON t.bill_id = h.bill_id"}
{"order_seq_no": 12,"form_type": "UB04","table_type": "BILL_DETAIL","df_read_table_name": "read_billing_codes_vw","df_table_name": "billing_codes_vw","db_table_name": "txm_bitx.billing_codes","db_select_cols_list": "","load_config_table_list":"","db_filter_id_col_name": "","db_read_sql_select": "WITH RECURSIVE split_icd10_procedure_codes AS (SELECT b.bill_header_id, SUBSTRING(i.icd10_procedure_codes, 1, 19) AS part,SUBSTRING(i.icd10_procedure_codes, 20) AS rest,1 AS part_number FROM txm_bitx_staging.jopari_bill_header_record_10 b JOIN txm_bitx_staging.jopari_institutional_record_31 i ON b.bill_header_id = i.bill_header_id WHERE b.file_header_id = <INPUT_FILE_HEADER_ID> AND b.bill_form_type = 'INST' AND LENGTH(i.icd10_procedure_codes) > 0 UNION ALL SELECT bill_header_id,SUBSTRING(rest, 1, 19) AS part,SUBSTRING(rest, 20) AS rest,part_number + 1 FROM split_icd10_procedure_codes WHERE LENGTH(rest) > 0) SELECT s.bill_header_id AS bill_header_id, s.part AS icd10_procedure_codes, s.part_number AS sequence_number FROM split_icd10_procedure_codes s","transform_sql_select":"SELECT t.bill_id,t.hospitalization_treatment_id AS treatment_id, 'PROCEDURE' AS code_type, v.sequence_number, CASE WHEN NULLIF(TRIM(SUBSTRING(v.icd10_procedure_codes, 1, 3)),'') IN ('BBQ', 'BBR') THEN 'ICD10' WHEN NULLIF(TRIM(SUBSTRING(v.icd10_procedure_codes, 1, 3)),'') IN ('BQ', 'BR') THEN 'ICD9' ELSE NULL END AS procedure_code_qualifier_icd, TRIM(SUBSTRING(v.icd10_procedure_codes, 1, 3)) AS procedure_code_qualifier,NULLIF(TRIM(SUBSTRING(v.icd10_procedure_codes,4,8)),'') AS procedure_code,TO_DATE(NULLIF(NULLIF(TRIM(SUBSTRING(v.icd10_procedure_codes,12,8)),'00000000'),''),'yyyyMMdd') AS procedure_date FROM read_billing_codes_vw v JOIN db_bill_header_vw h ON h.bill_header_id = v.bill_header_id JOIN db_hospitalization_treatment_vw t ON t.bill_id = h.bill_id"}
{"order_seq_no": 13,"form_type": "UB04","table_type": "BILL_DETAIL","df_read_table_name": "read_plan_details_vw","df_table_name": "plan_details_vw","db_table_name": "txm_bitx.plan_details","db_select_cols_list": "","load_config_table_list":"","db_filter_id_col_name": "","db_read_sql_select": "SELECT b.bill_header_id,a.release_of_info_code AS release_of_info_certification,b.assignment_of_benefits_ind AS assignment_of_benefits_certification,a.total_prior_payment AS prior_payments,a.total_estimated_amount_due AS estimated_amount_due FROM txm_bitx_staging.jopari_bill_header_record_10 b LEFT JOIN txm_bitx_staging.jopari_subscriber_record_13 a ON b.bill_header_id=a.bill_header_id WHERE b.file_header_id=<INPUT_FILE_HEADER_ID> AND b.bill_form_type = 'INST'","transform_sql_select": "SELECT h.bill_id,v.release_of_info_certification,v.assignment_of_benefits_certification,v.prior_payments,v.estimated_amount_due FROM read_plan_details_vw v JOIN db_bill_header_vw h ON h.bill_header_id=v.bill_header_id "}
{"order_seq_no": 14,"form_type": "UB04","table_type": "BILL_DETAIL","df_read_table_name": "read_billing_documents_vw","df_table_name": "billing_documents_vw","db_table_name": "txm_bitx.billing_documents","db_select_cols_list": "","load_config_table_list":"","db_filter_id_col_name": "","db_read_sql_select": "SELECT a.bill_header_id,a.attachment_record_number,a.report_type_code AS document_type_code,a.report_transmission_code AS document_transmission_code,a.attachment_control_number,a.attachment_description FROM txm_bitx_staging.jopari_bill_header_record_10 b JOIN txm_bitx_staging.jopari_attachments_record_40 a ON b.bill_header_id=a.bill_header_id WHERE b.file_header_id=<INPUT_FILE_HEADER_ID> AND b.bill_form_type = 'INST'","transform_sql_select": "SELECT h.bill_id,v.attachment_record_number,v.document_type_code,v.document_transmission_code,v.attachment_control_number,v.attachment_description FROM read_billing_documents_vw v JOIN db_bill_header_vw h ON h.bill_header_id=v.bill_header_id "}