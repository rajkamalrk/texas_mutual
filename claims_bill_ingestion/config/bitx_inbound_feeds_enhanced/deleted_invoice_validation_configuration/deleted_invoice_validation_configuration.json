{"order_seq_no": 1,"error_desc": "Header Record Missing","df_table_name": "validation_1_vw","load_config_table_list":"","db_validate_sql_select": "SELECT h.batch_id,h.header_id,CAST(NULL AS UNSIGNED INTEGER) AS detail_id, CAST(NULL AS UNSIGNED INTEGER) AS invoice_number, CASE WHEN COUNT(h.header_id) > 0 THEN 'PASS' ELSE 'FAIL' END AS validation_result,'' AS field_name_1, '' AS field_value_1, '' AS field_name_2, '' AS field_value_2 FROM txm_deleted_invoice_staging.delete_file_header h WHERE h.header_id = <INPUT_HEADER_ID>"}
{"order_seq_no": 2,"error_desc": "Trailer Record Missing","df_table_name": "validation_2_vw","load_config_table_list":"","db_validate_sql_select": "SELECT h.batch_id,h.header_id, CAST(NULL AS UNSIGNED INTEGER) AS detail_id, CAST(NULL AS UNSIGNED INTEGER) AS invoice_number, CASE WHEN t.header_id IS NOT NULL AND t.header_id <> '' THEN 'PASS' ELSE 'FAIL' END AS validation_result,'' AS field_name_1, '' AS field_value_1, '' AS field_name_2, '' AS field_value_2 FROM txm_deleted_invoice_staging.delete_file_header h LEFT JOIN txm_deleted_invoice_staging.delete_file_trailer t on h.header_id = t.header_id WHERE h.header_id = <INPUT_HEADER_ID>"}
{"order_seq_no": 3,"error_desc": "Batch Out of Balance","df_table_name": "validation_3_vw","load_config_table_list":"","db_validate_sql_select": "SELECT h.batch_id, h.header_id, CAST(NULL AS UNSIGNED INTEGER) AS detail_id, CAST(NULL AS UNSIGNED INTEGER) AS invoice_number, CASE WHEN COUNT(d.header_id) = t.invoice_count THEN 'PASS' ELSE 'FAIL' END AS validation_result,'delete_file_trailer.invoice_count' AS field_name_1, t.invoice_count AS field_value_1, '' AS field_name_2, '' AS field_value_2 FROM txm_deleted_invoice_staging.delete_file_header h LEFT JOIN txm_deleted_invoice_staging.delete_invoice_detail d ON h.header_id = d.header_id LEFT JOIN txm_deleted_invoice_staging.delete_file_trailer t ON h.header_id = t.header_id where h.header_id = <INPUT_HEADER_ID>"}
{"order_seq_no": 4,"error_desc": "Invoice Number Invalid","df_table_name": "validation_4_vw","load_config_table_list":"","db_validate_sql_select": "SELECT h.batch_id, h.header_id, d.detail_id, d.invoice_number, CASE WHEN d.invoice_number = i.txm_invoice_number THEN 'PASS' ELSE 'FAIL' END AS validation_result,'delete_invoice_detail.invoice_number' AS field_name_1, d.invoice_number AS field_value_1, '' AS field_name_2,'' AS field_value_2 FROM txm_deleted_invoice_staging.delete_file_header h JOIN txm_deleted_invoice_staging.delete_invoice_detail d ON h.header_id = d.header_id LEFT JOIN txm_bitx.invoice_status i ON d.invoice_number = i.txm_invoice_number where h.header_id = <INPUT_HEADER_ID>"}
{"order_seq_no": 5,"error_desc": "Invalid Invoice Status","df_table_name": "validation_5_vw","load_config_table_list":"","db_validate_sql_select": "SELECT h.batch_id, h.header_id, d.detail_id, d.invoice_number, CASE WHEN d.invoice_number = i.txm_invoice_number AND i.status_type = 'ADJUDICATION' AND i.status = 'SUBMITTED' THEN 'PASS' ELSE 'FAIL' END AS validation_result,'txm_bitx.invoice_status.status_type' AS field_name_1, i.status_type AS field_value_1, 'txm_bitx.invoice_status.status' AS field_name_2, i.status AS field_value_2 FROM txm_deleted_invoice_staging.delete_file_header h JOIN txm_deleted_invoice_staging.delete_invoice_detail d ON h.header_id = d.header_id LEFT JOIN txm_bitx.invoice_status i on d.invoice_number = i.txm_invoice_number where h.header_id = <INPUT_HEADER_ID>"}