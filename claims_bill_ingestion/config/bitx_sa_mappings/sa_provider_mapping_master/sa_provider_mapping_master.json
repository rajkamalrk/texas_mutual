{"datacatalog_schema_name":"bill_ingestion_sa_mappings","datacatalog_provider_mapping_table_name":"sa_mapping_provider_config","df_table_name":"provider_vw","db_read_sql_select":"SELECT SUBSTRING(CAST(COALESCE(mp.provider_number,'') AS char(30)),1,30) AS provider_number ,COALESCE(SUBSTRING(UPPER(provider_type_code),1,2),'') as provider_type_code ,SUBSTRING(COALESCE(UPPER(vendor_name),''),1,50) AS vendor_name ,SUBSTRING(COALESCE(UPPER(rendering_provider_name),''),1,50) AS rendering_provider_name ,SUBSTRING(CAST(COALESCE(UPPER(vendor_tax_id),'') AS char(9)),1,9) AS vendor_tax_id ,SUBSTRING(COALESCE(UPPER(rendering_provider_license),''),1,10) AS rendering_provider_license ,SUBSTRING(COALESCE(UPPER(vendor_address1),''),1,30) AS vendor_address1 ,SUBSTRING(COALESCE(UPPER(vendor_address2),''),1,30) AS vendor_address2 ,SUBSTRING(COALESCE(UPPER(vendor_city),''),1,30) AS  vendor_city ,SUBSTRING(COALESCE(UPPER(vendor_state),''),1,2) AS vendor_state ,SUBSTRING(COALESCE(REPLACE(UPPER(vendor_zip_code),'-',''),''),1,10) AS vendor_zip_code ,CASE WHEN vendor_phone =0 THEN '' ELSE SUBSTRING(CAST(COALESCE(UPPER(vendor_phone),'') AS char(20)),1,20)  END AS vendor_phone ,SUBSTRING(COALESCE(UPPER(facility_name),''),1,30) AS facility_name ,SUBSTRING(COALESCE(UPPER(facility_address_1),''),1,30) AS facility_address_1 ,SUBSTRING(COALESCE(UPPER(facility_address_2),''),1,30) AS facility_address_2 ,SUBSTRING(COALESCE(UPPER(facility_city),''),1,30) AS facility_city ,SUBSTRING(COALESCE(UPPER(facility_state),''),1,2) AS facility_state ,SUBSTRING(COALESCE(REPLACE(UPPER(facility_zip_code),'-',''),''),1,10) AS facility_zip_code ,COALESCE(SUBSTRING(IF(TRIM(Provider_Type_Code)='RX',UPPER(rendering_provider_nabp),''),1,10),'') AS ncpdid ,COALESCE(SUBSTRING(IF(TRIM(Provider_Type_Code) IN ('HP','HH'),COALESCE(UPPER(rendering_provider_license),'NO NUMBER'),''),1,10),'') AS   medicare ,COALESCE(SUBSTRING(IF(TRIM(provider_type_code) NOT IN ('HP','HH','RX'),UPPER(rendering_provider_license),''),1,30),'') AS mediexaminer ,SUBSTRING(COALESCE(UPPER(facility_npi),''),1,10) AS facility_npi ,SUBSTRING(COALESCE(UPPER(rendering_provider_npi),''),1,10) AS rendering_provider_npi ,CASE WHEN TRIM(UPPER(udf_data_value)) IN ('Y',1) THEN 'Y' WHEN TRIM(UPPER(udf_data_value)) IN ('N',0) THEN 'N' ELSE '' END AS udf_data_value ,SUBSTRING(COALESCE(UPPER(update_user),''),1,2) AS Mod_User_ID ,CASE WHEN TRIM(UPPER(vendor_status)) IS NULL OR TRIM(UPPER(vendor_status))  = '' OR TRIM(UPPER(vendor_status)) = 'ACTIVE'  THEN 'A'  ELSE 'I' END AS Provider_Status_Code FROM txm_bitx_provider.provider mp LEFT OUTER JOIN (SELECT * FROM (SELECT  provider_number ,rendering_provider_nabp ,ROW_NUMBER() OVER (PARTITION BY provider_number ORDER BY update_timestamp DESC) AS rw FROM txm_bitx.provider )q WHERE q.rw=1 ) ep on ep.provider_number= mp.provider_number WHERE UPPER(delivered_to_sa) IN ('NEW','UPDATED') AND (TRIM(UPPER(vendor_status)) IS NULL OR TRIM(UPPER(vendor_status))  = '' OR TRIM(UPPER(vendor_status)) = 'ACTIVE')","s3_file_prefix":"data/smart_advisor/outbound/provider_files/","outbound_file_name":"SAPROVIDER_<date_format>.ASC","FEIN":"593143128"}